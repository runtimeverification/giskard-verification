<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>local.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.16.0+0.16.2. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> Arith Bool List Lia.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Giskard <span class="kn">Require Import</span> structures.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> ListNotations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Implicit Arguments</span>.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Local state operations, properties, and transitions</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Local state transitions capture message sending, receiving and processing
behaviors of individual nodes. Local state transitions can be defined as a
quaternary relation on:
<ul class="doclist">
<li> pre-state, 

</li>
<li> incoming message, 

</li>
<li> post-state, and

</li>
<li> outgoing message(s).

</li>
</ul>
<div class="paragraph"> </div>

Valid Giskard local state transitions can be defined as a predicate on these relations. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab2"></a><h2 class="section">Local state operations</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The following section defines operations that transform the pre-state
to post-state in local state transitions. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Received messages are stored in the in buffer. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">received</span> (<span class="nv">s</span> : NState) (<span class="nv">m</span> : message) : <span class="kt">Prop</span> :=
  In m (in_messages s).</span></span></pre><div class="doc">
Sent messages are stored in the out buffer, as history.  
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">sent</span> (<span class="nv">s</span> : NState) (<span class="nv">m</span> : message) : <span class="kt">Prop</span> :=
  In m (out_messages s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">record</span> (<span class="nv">s</span> : NState) (<span class="nv">m</span> : message) : NState :=
 mkNState (node_view s) (node_id s)
  (in_messages s) (counting_messages s)  (m :: out_messages s) (<span class="kp">timeout</span> s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">record_plural</span> (<span class="nv">s</span> : NState) (<span class="nv">lm</span> : list message) : NState :=
 mkNState (node_view s) (node_id s)
  (in_messages s) (counting_messages s)  (lm ++ out_messages s) (<span class="kp">timeout</span> s).</span></span></pre><div class="doc">
Broadcast messages are stored in the in buffer, awaiting processing. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">add</span> (<span class="nv">s</span> : NState) (<span class="nv">m</span> : message) : NState :=
 mkNState (node_view s) (node_id s)
  (m :: in_messages s) (counting_messages s)  (out_messages s) (<span class="kp">timeout</span> s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">add_plural</span> (<span class="nv">s</span> : NState) (<span class="nv">lm</span> : list message) : NState :=
 mkNState (node_view s) (node_id s)
  (lm ++ in_messages s) (counting_messages s) (out_messages s)  (<span class="kp">timeout</span> s).</span></span></pre><div class="doc">
Invalid messages are removed from the in buffer, and thus unable to be processed. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">discard</span> (<span class="nv">s</span> : NState) (<span class="nv">m</span> : message) : NState :=
 mkNState (node_view s) (node_id s)
  (remove message_eq_dec m (in_messages s)) (counting_messages s) (out_messages s)  (<span class="kp">timeout</span> s).</span></span></pre><div class="doc">
Processed messages are removed from the in buffer and added to the counting buffer. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) : NState :=
 mkNState (node_view s) (node_id s)
  (remove message_eq_dec msg (in_messages s)) (msg :: counting_messages s) (out_messages s) (<span class="kp">timeout</span> s).</span></span></pre><div class="doc">
During a normal or abnormal view change, the view is incremented,
and the in message buffer and timeout flag reset. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">increment_view</span> (<span class="nv">s</span> : NState) : NState :=
  mkNState (S (node_view s)) (node_id s) [] (counting_messages s) (out_messages s) false.</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">Local state properties</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The following section defines properties that constitute pre- and post- conditions
for local state transitions. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
A message has a valid view with respect to a local state when it is equal to the
local state's current view. Nodes only process "non-expired" messages sent in its current view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">view_valid</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) : <span class="kt">Prop</span> :=
  node_view s = get_view msg.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">view_validb</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) : bool :=
  Nat.eqb (node_view s) (get_view msg).</span></span></pre><div class="doc">
<a id="lab4"></a><h3 class="section">Byzantine behavior</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The primary form of Byzantine behavior Giskard considers is double voting:
sending two PrepareVote messages for two different blocks of the same height within the same view.
We call two messages equivocating if they evidence double voting behavior of their sender. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equivocating_messages</span> (<span class="nv">s</span> : NState) (<span class="nv">msg1</span> <span class="nv">msg2</span> : message) : <span class="kt">Prop</span> :=
  In msg1 (out_messages s) /\
  In msg2 (out_messages s) /\
  get_view msg1 = get_view msg2 /\
  get_message_type msg1 = PrepareVote /\
  get_message_type msg2 = PrepareVote /\
  get_block msg1 &lt;&gt; get_block msg2 /\
  b_height (get_block msg1) = b_height (get_block msg2).</span></span></pre><div class="doc">
Duplicate block checking for either:
<ul class="doclist">
<li> a PrepareVote message in the processed message buffer for a different block of the same height, or

</li>
<li> a PrepareVote or PrepareQC message in the sent message buffer for a different block of the same height. 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">exists_same_height_block_old</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) : <span class="kt">Prop</span> :=
  <span class="c">(* Either PrepareBlock has been processed, but no vote has been cast *)</span> 
  (<span class="kr">exists</span> <span class="nv">msg</span>, In msg (counting_messages s) /\
          get_message_type msg = PrepareBlock /\ 
          b_height b = b_height (get_block msg) /\
          b &lt;&gt; get_block msg)
  <span class="c">(* Or a PrepareVote or PrepareQC has been sent *)</span> 
  \/
  (<span class="kr">exists</span> <span class="nv">msg</span>, In msg (out_messages s) /\
          (get_message_type msg = PrepareVote \/
           get_message_type msg = PrepareQC) /\ 
          b_height b = b_height (get_block msg) /\
          b &lt;&gt; get_block msg).</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">exists_same_height_block</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) : <span class="kt">Prop</span> :=
  <span class="kr">exists</span> <span class="nv">msg</span>, In msg (out_messages s) /\
         get_message_type msg = PrepareVote /\
         b_height b = b_height (get_block msg) /\
         b &lt;&gt; get_block msg.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">exists_same_height_PrepareBlock</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) : <span class="kt">Prop</span> :=
  <span class="kr">exists</span> <span class="nv">msg</span>, In msg (counting_messages s) /\
         get_message_type msg = PrepareBlock /\
         b_height b = b_height (get_block msg) /\
         b &lt;&gt; get_block msg.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">same_height_block_msg</span> (<span class="nv">b</span> : block) (<span class="nv">msg</span> : message) :=
 get_message_type msg = PrepareVote /\
 b_height b = b_height (get_block msg) /\
 b &lt;&gt; get_block msg.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk0"><span class="kn">Definition</span> <span class="nf">same_height_block_msg_dec</span> (<span class="nv">b</span> : block) (<span class="nv">msg</span> : message) :
  { same_height_block_msg b msg }+{ ~ same_height_block_msg b msg }.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk2"><span class="nb">destruct</span> (message_type_eq_dec (get_message_type msg) PrepareVote).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>get_message_type msg &lt;&gt; PrepareVote</span></span></span><br></div><label class="goal-separator" for="local-v-chk3"><hr></label><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk5"><span class="nb">destruct</span> (Nat.eq_dec (b_height b) (b_height (get_block msg))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b_height b &lt;&gt; b_height (get_block msg)</span></span></span><br></div><label class="goal-separator" for="local-v-chk6"><hr></label><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk7">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk8"><span class="nb">destruct</span> (block_eq_dec b (get_block msg)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>b = get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block msg</span></span></span><br></div><label class="goal-separator" for="local-v-chk9"><hr></label><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>b = get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>b = get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ same_height_block_msg b msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkc"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>b = get_block msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>same_height_block_msg b msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkd"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>b = get_block msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg) /\
b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chke"><span class="nb">destruct</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>e1</var><span class="hyp-type"><b>: </b><span>b = get_block msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk10"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">same_height_block_msg b msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk11"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height b = b_height (get_block msg) /\
b &lt;&gt; get_block msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk12"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>e0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b &lt;&gt; get_block msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk13">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b_height b &lt;&gt; b_height (get_block msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk14"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b_height b &lt;&gt; b_height (get_block msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ same_height_block_msg b msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk15"><span class="nb">unfold</span> same_height_block_msg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b_height b &lt;&gt; b_height (get_block msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~
(get_message_type msg = PrepareVote /\
 b_height b = b_height (get_block msg) /\
 b &lt;&gt; get_block msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk16"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b_height b &lt;&gt; b_height (get_block msg)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote /\
b_height b = b_height (get_block msg) /\
b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk17"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b_height b &lt;&gt; b_height (get_block msg)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg) /\
b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk18"><span class="nb">destruct</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>b_height b &lt;&gt; b_height (get_block msg)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk19">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>get_message_type msg &lt;&gt; PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{same_height_block_msg b msg} +
{~ same_height_block_msg b msg}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>get_message_type msg &lt;&gt; PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ same_height_block_msg b msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1b"><span class="nb">unfold</span> same_height_block_msg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>get_message_type msg &lt;&gt; PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~
(get_message_type msg = PrepareVote /\
 b_height b = b_height (get_block msg) /\
 b &lt;&gt; get_block msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1c"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>get_message_type msg &lt;&gt; PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~
(get_message_type msg = PrepareVote /\
 b_height b = b_height (get_block msg) /\
 b &lt;&gt; get_block msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1d"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>get_message_type msg &lt;&gt; PrepareVote</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote /\
b_height b = b_height (get_block msg) /\
b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1e"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>get_message_type msg &lt;&gt; PrepareVote</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block msg) /\
b &lt;&gt; get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Program Definition</span> <span class="nf">exists_same_height_block_dec</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) :
 { exists_same_height_block s b }+{~ exists_same_height_block s b} :=
<span class="kr">match</span> Exists_dec (same_height_block_msg b) (out_messages s) (same_height_block_msg_dec b) <span class="kr">with</span>
| <span class="nb">left</span> H_dec =&gt; <span class="nb">left</span> _
| <span class="nb">right</span> H_dec =&gt; <span class="nb">right</span> _
<span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1f"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_dec</var><span class="hyp-type"><b>: </b><span>Exists (same_height_block_msg b)
  (out_messages s)</span></span></span><br><span><var>Heq_anonymous</var><span class="hyp-type"><b>: </b><span><span class="nb">left</span> H_dec =
Exists_dec (same_height_block_msg b)
  (out_messages s)
  (same_height_block_msg_dec b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk20"><span class="nb">clear</span> Heq_anonymous.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_dec</var><span class="hyp-type"><b>: </b><span>Exists (same_height_block_msg b)
  (out_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk21"><span class="nb">apply</span> Exists_exists <span class="kr">in</span> H_dec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_dec</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">x</span> : message,
  In x (out_messages s) /\
  same_height_block_msg b x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk22"><span class="nb">destruct</span> H_dec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s) /\ same_height_block_msg b x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk23"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>same_height_block_msg b x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk24"><span class="nb">destruct</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk25"><span class="nb">destruct</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk26"><span class="kr">exists</span> <span class="nv">x</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In x (out_messages s) /\
get_message_type x = PrepareVote /\
b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk27"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type x = PrepareVote /\
b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk28"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk29"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b &lt;&gt; get_block x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk2a"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_dec</var><span class="hyp-type"><b>: </b><span>~
Exists (same_height_block_msg b)
  (out_messages s)</span></span></span><br><span><var>Heq_anonymous</var><span class="hyp-type"><b>: </b><span><span class="nb">right</span> H_dec =
Exists_dec (same_height_block_msg b)
  (out_messages s)
  (same_height_block_msg_dec b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk2b"><span class="nb">clear</span> Heq_anonymous.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_dec</var><span class="hyp-type"><b>: </b><span>~
Exists (same_height_block_msg b)
  (out_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ exists_same_height_block s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk2c"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_dec</var><span class="hyp-type"><b>: </b><span>~
Exists (same_height_block_msg b)
  (out_messages s)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>exists_same_height_block s b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk2d"><span class="bp">contradict</span> H_dec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>exists_same_height_block s b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Exists (same_height_block_msg b) (out_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk2e"><span class="nb">apply</span> Exists_exists.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>exists_same_height_block s b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">x</span> : message,
  In x (out_messages s) /\ same_height_block_msg b x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk2f"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s) /\
get_message_type x = PrepareVote /\
b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">x</span> : message,
  In x (out_messages s) /\ same_height_block_msg b x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk30"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote /\
b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">x</span> : message,
  In x (out_messages s) /\ same_height_block_msg b x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk31"><span class="nb">destruct</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">x</span> : message,
  In x (out_messages s) /\ same_height_block_msg b x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk32"><span class="nb">destruct</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">x</span> : message,
  In x (out_messages s) /\ same_height_block_msg b x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk33"><span class="kr">exists</span> <span class="nv">x</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In x (out_messages s) /\ same_height_block_msg b x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk34"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">same_height_block_msg b x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk35"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height b = b_height (get_block x) /\
b &lt;&gt; get_block x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk36"><span class="nb">split</span>; [<span class="bp">assumption</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In x (out_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type x = PrepareVote</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>b_height b = b_height (get_block x)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b &lt;&gt; get_block x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b &lt;&gt; get_block x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">exists_same_height_blockb</span> : NState -&gt; block -&gt; bool :=
 <span class="kr">fun</span> <span class="nv">s</span> <span class="nv">b</span> =&gt; <span class="kr">if</span> exists_same_height_block_dec s b <span class="kr">then</span> true <span class="kr">else</span> false.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk37"><span class="kn">Lemma</span> <span class="nf">exists_same_height_block_correct</span> : <span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block),
 exists_same_height_block s b &lt;-&gt; exists_same_height_blockb s b = true.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block),
exists_same_height_block s b &lt;-&gt;
exists_same_height_blockb s b = true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk38"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block),
exists_same_height_block s b &lt;-&gt;
exists_same_height_blockb s b = true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="nb">split</span>; <span class="nb">unfold</span> exists_same_height_blockb;
  <span class="nb">destruct</span> (exists_same_height_block_dec _ _); <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab5"></a><h3 class="section">Prepare stage definitions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Blocks in Giskard go through three stages: Prepare, Precommit and Commit.
The local definitions of these three stages are: 
<ul class="doclist">
<li> a block is in prepare stage in some local state s iff it has received quorum PrepareVote messages
  or a PrepareQC message in the current view or some previous view, and

</li>
<li> a block is in precommit stage in some local state s iff its child block is in prepare stage in s, and

</li>
<li> a block is in commit stage in some local state s iff its child block is in precommit stage in s. 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
We can parameterize the definition of a block being in prepare stage by some view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Processed PrepareVote messages in some view about some block: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">processed_PrepareVote_in_view_about_block</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) (<span class="nv">b</span> : block) : list message :=
  filter (<span class="kr">fun</span> <span class="nv">msg</span> =&gt; message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
                  block_eqb (get_block msg) b &amp;&amp;
                  Nat.eqb (get_view msg) view)
         (counting_messages s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">vote_quorum_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) (<span class="nv">b</span> : block) : <span class="kt">Prop</span> :=
  quorum (processed_PrepareVote_in_view_about_block s view b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">PrepareQC_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) (<span class="nv">b</span> : block) : <span class="kt">Prop</span> :=
  <span class="kr">exists</span> <span class="nv">msg</span> : message,
    In msg (counting_messages s) /\ 
    get_view msg = view /\
    get_block msg = b /\
    get_message_type msg = PrepareQC.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">prepare_stage_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) (<span class="nv">b</span> : block) : <span class="kt">Prop</span> :=
  vote_quorum_in_view s view b
  \/
  PrepareQC_in_view s view b.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">prepare_stage_in_viewb</span>  (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) (<span class="nv">b</span> : block) : bool :=
  quorumb (processed_PrepareVote_in_view_about_block s view b) 
  ||
  existsb (<span class="kr">fun</span> <span class="nv">msg</span> =&gt; message_type_eqb (get_message_type msg) PrepareQC
                                    &amp;&amp; Nat.eqb (get_view msg) view
                                    &amp;&amp; block_eqb (get_block msg) b)
  (counting_messages s).</span></span></pre><div class="doc">
We use this parameterized definition to define the general version of a block being
in prepare stage: A block has reached prepare stage in some state iff it has reached prepare
stage in some view that is less than or equal to the current view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">prepare_stage</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) :=
  <span class="kr">exists</span> <span class="nv">v&#39;</span>, v&#39; &lt;= node_view s /\ prepare_stage_in_view s v&#39; b.</span></span></pre><div class="doc">
<a id="lab6"></a><h3 class="section">View change definitions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Participating nodes in Giskard vote in units of time called views. Each view has the same
fixed set of participating nodes, which consists oof one block proposer for the view, and
validators. Participating nodes take turns to be the block proposer, and the identity of
the block proposer for any given view is known to all participating nodes. A view generally
proceeds as follows: at the beginning of the view, the block proposer proposes a fixed
number of blocks, which validators vote on. If all blocks receive quorum votes, the nodes
increment their local view and wait for new block proposals in the new view. Otherwise,
a timeout occurs, and nodes exchange messages to communicate their acknowledgement of the
timeout and determine the parent block for the first block of the new view. The end of a
view for a participating node is marked by either: 
<ul class="doclist">
<li> the last block proposed by the block proposer reaching prepare stage in its local state, or 

</li>
<li> the receipt of a ViewChangeQC message following a timeout.

</li>
</ul>
<div class="paragraph"> </div>

We call the former a normal view change, and the latter an abnormal view change.
Because we assume that all local clocks are synchronized, in the case of an abnormal
view change, all nodes timeout at once. However, because nodes process messages at
different speeds, blocks reach prepare stage at different speeds, and consequently,
in the case of a normal view change, nodes are not guaranteed to increment their
local view at the same time. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
In the case of an abnormal view change, the timeout flag is simultaneously flipped
for all participating nodes, and each sends a ViewChange message containing their
local highest block at prepare stage. Nodes then enter a liminal stage in which only
three kinds of messages can be processed: PrepareQC, ViewChange and ViewChangeQC. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Nodes will ignore all block proposals and block votes during this stage. Upon
receiving quorum ViewChange messages, validator nodes increment their view and wait
for new blocks to be proposed. The new block proposer aggregates the max height
block from its received ViewChange messages, and uses it to produce new blocks
for the new view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The following section contains definitions required for abnormal view changes. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Quorum ViewChange messages in some view: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">processed_ViewChange_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) : list message :=
  filter (<span class="kr">fun</span> <span class="nv">msg</span> =&gt; message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
                  Nat.eqb (get_view msg) view)
         (counting_messages s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk39"><span class="kn">Lemma</span> <span class="nf">processed_ViewChange_in_view_correct</span> :
  <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">view</span> <span class="nv">msg</span>,
    In msg (processed_ViewChange_in_view s view) -&gt;
    In msg (counting_messages s) /\ 
    get_message_type msg = ViewChange /\
    get_view msg = view.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) (<span class="nv">msg</span> : message),
In msg (processed_ViewChange_in_view s view) -&gt;
In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk3a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) (<span class="nv">msg</span> : message),
In msg (processed_ViewChange_in_view s view) -&gt;
In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk3b"><span class="nb">intros</span> s view msg H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (processed_ViewChange_in_view s view)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk3c"><span class="nb">apply</span> filter_In <span class="kr">in</span> H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s) /\
message_type_eqb ViewChange
  (get_message_type msg) &amp;&amp;
(get_view msg =? view) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk3d"><span class="nb">destruct</span> H_in <span class="kr">as</span> [H_in H_typeview].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H_typeview</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange
  (get_message_type msg) &amp;&amp;
(get_view msg =? view) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk3e"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_typeview.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H_typeview</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange
  (get_message_type msg) = true /\
(get_view msg =? view) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk3f"><span class="nb">destruct</span> H_typeview <span class="kr">as</span> [H_type H_view].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange
  (get_message_type msg) = true</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>(get_view msg =? view) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk40"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange
  (get_message_type msg) = true</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>(get_view msg =? view) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = ViewChange</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk41" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange
  (get_message_type msg) = true</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>(get_view msg =? view) = true</span></span></span><br></div><label class="goal-separator" for="local-v-chk41"><hr></label><div class="goal-conclusion">get_view msg = view</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk42"><span class="nb">symmetry</span>; <span class="bp">now</span> <span class="nb">apply</span> message_type_eqb_correct.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange
  (get_message_type msg) = true</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>(get_view msg =? view) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg = view</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk43"><span class="nb">apply</span> Nat.eqb_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>view</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange
  (get_message_type msg) = true</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>(get_view msg =? view) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(get_view msg =? view) = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">view_change_quorum_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) : <span class="kt">Prop</span> :=
  quorum (processed_ViewChange_in_view s view).</span></span></pre><div class="doc">
Maximum height block from all processed ViewChange messages in view: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">highest_ViewChange_block_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) : block :=
  fold_right higher_block
             GenesisBlock
             (map (get_block) (processed_ViewChange_in_view s view)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">highest_ViewChange_block_height_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) : nat :=
  b_height (highest_ViewChange_block_in_view s view).</span><span class="alectryon-wsp"> </span></span></pre><div class="doc">
The last block of each view is identifiable to each participating node:  
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">last_block</span> (<span class="nv">b</span> : block) : <span class="kt">Prop</span> :=
  b_last b = true.</span></span></pre><div class="doc">
Because not every view is guaranteed to have a block in prepare stage,
the definition of <code>highest_prepare_block_in_view</code> must be able to recursively
search for the highest prepare block in all past views: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">highest_prepare_block_in_view</span> (<span class="nv">s</span> : NState) (<span class="nv">view</span> : nat) : block :=
  <span class="kr">match</span> view <span class="kr">with</span>
    | <span class="mi">0</span> =&gt; GenesisBlock
    | S view&#39; =&gt;
      fold_right higher_block
       (highest_prepare_block_in_view s view&#39;)
       (map get_block
         (filter (<span class="kr">fun</span> <span class="nv">msg</span> =&gt; prepare_stage_in_viewb s view (get_block msg))
          (counting_messages s)))
    <span class="kr">end</span>.</span></span></pre><div class="doc">
The following definition constructs the ViewChange message to be
sent by each participating node upon a timeout. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">highest_prepare_block_message</span> (<span class="nv">s</span> : NState) : message :=
 mkMessage PrepareQC (node_view s) (node_id s)
  (highest_prepare_block_in_view s (node_view s)) GenesisBlock.</span></span></pre><div class="doc">
<a id="lab7"></a><h2 class="section">Message construction</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
In Giskard, some message types "carry" other messages: 
<ul class="doclist">
<li> PrepareBlock messages for the first block in a view carry the PrepareQC
  message of its parent block, PrepareBlock messages for non-first blocks
  carry the PrepareQC of the parent block of the first block, and

</li>
<li> PrepareVote messages carry the PrepareQC message of its parent block, and

</li>
<li> ViewChange messages carry the PrepareQC message of the highest local
  prepare stage block. 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
We do not model this at the type level (i.e., by having inductive message
type definitions), but rather simulate this behavior using pre- and post-conditions
in our local transitions. For example, a node only processes a PrepareBlock message
in the in message buffer if the PrepareQC message that is "piggybacked" onto has also
been received, and the transition effectively processes both of these messages in one step. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
PrepareBlocks are computed from either: 
<ul class="doclist">
<li> the final PrepareVote/PrepareQC message of the previous round, or 

</li>
<li> the ViewChangeQC from the previous round. 

</li>
</ul>
<div class="paragraph"> </div>

The messages in both of these cases contain the parent block for the newly proposed blocks.
Note that because blocks are proposed in sequence, only the first PrepareBlock message carries
the parent block's PrepareQC message - the remaining blocks cannot do so because their parent
blocks have not reached prepare stage yet, and therefore their PrepareQC messages cannot exist.
Therefore, all PrepareBlock messages in a view carry the same PrepareQC message: that of
the first block's parent. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Note that although all PrepareBlock messages are produced and sent together in one
single transition, this does not mean that:
<ul class="doclist">
<li> they are processed at the same time, and

</li>
<li> we falsely enforce the discipline that the second proposed block contains the first
  block's PrepareQC when in fact it has not reached PrepareQC. 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">make_PrepareBlocks</span> (<span class="nv">s</span> : NState) (<span class="nv">previous_msg</span> : message) : list message :=
  [(mkMessage PrepareBlock 
    (node_view s)
    (node_id s) 
    (generate_new_block (get_block previous_msg)) <span class="c">(* New block produced *)</span> 
    (get_block previous_msg) <span class="c">(* PrepareQC of highest block from previous round *)</span>
   )
   ;
   (mkMessage PrepareBlock
    (node_view s)
    (node_id s)
    (generate_new_block
      (generate_new_block (get_block previous_msg))) <span class="c">(* New block produced *)</span> 
    (get_block previous_msg) <span class="c">(* PrepareQC of highest block from previous round *)</span>
   )
   ;
   (mkMessage PrepareBlock 
    (node_view s)
    (node_id s)
    <span class="c">(* In particular, here we produce a block that is labeled as last block for the view *)</span>
    (generate_last_block
      (generate_new_block
         (generate_new_block (get_block previous_msg)))) <span class="c">(* New block produced *)</span> 
    (get_block previous_msg)
   )]. <span class="c">(* PrepareQC of highest block from previous round *)</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk44"><span class="kn">Lemma</span> <span class="nf">make_PrepareBlocks_message_type</span> :
  <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">msg0</span> <span class="nv">msg</span>, 
  In msg (make_PrepareBlocks s msg0) -&gt;
  get_message_type msg = PrepareBlock.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg0</span> <span class="nv">msg</span> : message),
In msg (make_PrepareBlocks s msg0) -&gt;
get_message_type msg = PrepareBlock</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk45"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg0</span> <span class="nv">msg</span> : message),
In msg (make_PrepareBlocks s msg0) -&gt;
get_message_type msg = PrepareBlock</div></blockquote></div></div></small><span class="alectryon-wsp">         
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk46"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (make_PrepareBlocks s msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareBlock</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk47"><span class="nb">unfold</span> make_PrepareBlocks <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg
  [{|
     get_message_type := PrepareBlock;
     get_view := node_view s;
     get_sender := node_id s;
     get_block :=
       generate_new_block (get_block msg0);
     get_piggyback_block := get_block msg0
   |};
   {|
     get_message_type := PrepareBlock;
     get_view := node_view s;
     get_sender := node_id s;
     get_block :=
       generate_new_block
         (generate_new_block (get_block msg0));
     get_piggyback_block := get_block msg0
   |};
   {|
     get_message_type := PrepareBlock;
     get_view := node_view s;
     get_sender := node_id s;
     get_block :=
       generate_last_block
         (generate_new_block
            (generate_new_block (get_block msg0)));
     get_piggyback_block := get_block msg0
   |}]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareBlock</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">simpl</span> <span class="kr">in</span> H;
    <span class="nb">destruct</span> H <span class="kr">as</span> [H | [H | [H | H]]];
    <span class="nb">subst</span>; <span class="kp">try</span> <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
A <code>PrepareVote</code> carries the <code>PrepareQC</code> of its parent, and can only be sent
after parent block reaches prepare stage, which means one of its inputs must be
either a <code>PrepareVote</code> or <code>PrepareQC</code>. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<code>PrepareVote</code>s are also computed from <code>PrepareBlock</code> messages,
which means another one of its inputs must be a <code>PrepareBlock</code> message. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">make_PrepareVote</span> (<span class="nv">s</span> : NState) (<span class="nv">quorum_msg</span> <span class="nv">prepareblock_msg</span> : message) : message :=
  mkMessage PrepareVote <span class="c">(* message type *)</span>
  (node_view s) <span class="c">(* view number *)</span>
  (node_id s) <span class="c">(* node id *)</span> 
  (get_block prepareblock_msg) <span class="c">(* block to vote for *)</span> 
  (get_block quorum_msg).</span></span></pre><div class="doc">
Nodes create <code>PrepareVote</code> messages upon receiving <code>PrepareBlock</code> messages
for each block, and "wait" to send it until the parent block reaches prepare stage.
This is modeled by constructing <code>PrepareVote</code> messages on-demand given that:
<ul class="doclist">
<li> the parent block has just reached prepare stage, and

</li>
<li> a <code>PrepareBlock</code> message exists for the child block.

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Constructing pending PrepareVote messages for child messages with existing PrepareBlocks. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pending_PrepareVote</span> (<span class="nv">s</span> : NState) (<span class="nv">quorum_msg</span> : message) : list message :=
  map (<span class="kr">fun</span> <span class="nv">prepare_block_msg</span> =&gt; make_PrepareVote s quorum_msg prepare_block_msg)
      (filter (<span class="kr">fun</span> <span class="nv">msg</span> =&gt; Nat.eqb (get_view msg) (get_view quorum_msg) &amp;&amp;
                       negb (exists_same_height_blockb s (get_block msg)) &amp;&amp;
                       parent_ofb (get_block msg) (get_block quorum_msg) &amp;&amp;
                       message_type_eqb (get_message_type msg) PrepareBlock)
              (counting_messages s)).</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk48"><span class="kn">Lemma</span> <span class="nf">pending_PrepareVote_correct</span> :
  <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">msg0</span> <span class="nv">msg</span>,
    In msg (pending_PrepareVote s msg0) -&gt;
    get_message_type msg = PrepareVote /\
    get_sender msg = node_id s /\
    get_view msg = node_view s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg0</span> <span class="nv">msg</span> : message),
In msg (pending_PrepareVote s msg0) -&gt;
get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk49"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg0</span> <span class="nv">msg</span> : message),
In msg (pending_PrepareVote s msg0) -&gt;
get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk4a"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote s msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk4b"><span class="nb">unfold</span> pending_PrepareVote <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg
  (map
     (<span class="kr">fun</span> <span class="nv">prepare_block_msg</span> : message =&gt;
      make_PrepareVote s msg0 prepare_block_msg)
     (filter
        (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
         (get_view msg =? get_view msg0) &amp;&amp;
         negb
           (exists_same_height_blockb s
              (get_block msg)) &amp;&amp;
         parent_ofb (get_block msg)
           (get_block msg0) &amp;&amp;
         message_type_eqb 
           (get_message_type msg) PrepareBlock)
        (counting_messages s)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk4c"><span class="nb">rewrite</span> in_map_iff <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">x</span> : message,
  make_PrepareVote s msg0 x = msg /\
  In x
    (filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        (get_view msg =? get_view msg0) &amp;&amp;
        negb
          (exists_same_height_blockb s
             (get_block msg)) &amp;&amp;
        parent_ofb (get_block msg)
          (get_block msg0) &amp;&amp;
        message_type_eqb 
          (get_message_type msg) PrepareBlock)
       (counting_messages s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk4d"><span class="nb">destruct</span> H <span class="kr">as</span> [msg&#39; [H_type&#39; H]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg, msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote s msg0 msg&#39; = msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg&#39;
  (filter
     (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
      (get_view msg =? get_view msg0) &amp;&amp;
      negb
        (exists_same_height_blockb s
           (get_block msg)) &amp;&amp;
      parent_ofb (get_block msg) (get_block msg0) &amp;&amp;
      message_type_eqb (get_message_type msg)
        PrepareBlock) (counting_messages s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk4e"><span class="nb">apply</span> filter_In <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg, msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote s msg0 msg&#39; = msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages s) /\
(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb s (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;) (get_block msg0) &amp;&amp;
message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk4f"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg, msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote s msg0 msg&#39; = msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb s (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;) (get_block msg0) &amp;&amp;
message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk50"><span class="kp">repeat</span> (<span class="nb">apply</span> andb_prop <span class="kr">in</span> H0;
          <span class="nb">destruct</span> H0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg, msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote s msg0 msg&#39; = msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>negb
  (exists_same_height_blockb s (get_block msg&#39;)) =
true</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk51"><span class="nb">rewrite</span> Nat.eqb_eq <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg, msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote s msg0 msg&#39; = msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>negb
  (exists_same_height_blockb s (get_block msg&#39;)) =
true</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk52"><span class="nb">rewrite</span> message_type_eqb_correct <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg, msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote s msg0 msg&#39; = msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>negb
  (exists_same_height_blockb s (get_block msg&#39;)) =
true</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = PrepareVote /\
get_sender msg = node_id s /\
get_view msg = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk53"><span class="nb">rewrite</span> &lt;- H_type&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg0, msg, msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote s msg0 msg&#39; = msg</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>negb
  (exists_same_height_blockb s (get_block msg&#39;)) =
true</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type (make_PrepareVote s msg0 msg&#39;) =
PrepareVote /\
get_sender (make_PrepareVote s msg0 msg&#39;) = node_id s /\
get_view (make_PrepareVote s msg0 msg&#39;) = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">unfold</span> make_PrepareVote; <span class="kp">repeat</span> <span class="nb">split</span>; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
PrepareQC messages carry nothing, and can only be sent after a quorum number of PrepareVotes,
which means its only input is a PrepareVote containing the relevant block. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">make_PrepareQC</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) : message :=
  mkMessage PrepareQC 
  (node_view s)
  (node_id s)
  (get_block msg)
  GenesisBlock.</span><span class="alectryon-wsp"> </span></span></pre><div class="doc">
ViewChange messages carry the <code>PrepareQC</code> message of the highest block to
reach prepare stage, and since they are triggered by timeouts, no input
message is required: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">make_ViewChange</span> (<span class="nv">s</span> : NState) : message :=
  mkMessage ViewChange
  (node_view s)
  (node_id s)
  (highest_prepare_block_in_view s (node_view s))
  GenesisBlock.</span></span></pre><div class="doc">
Upon receiving quorum <code>ViewChange</code> messages, the block proposer for the new
view aggregates the max height block from all the <code>ViewChange</code> messages and
sends a <code>ViewChangeQC</code> containing this block, alongside a <code>PrepareQC</code> message
evidencing its prepare stage. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">make_ViewChangeQC</span> (<span class="nv">s</span> : NState) (<span class="nv">highest_msg</span> : message) : message :=
  mkMessage ViewChangeQC
  (node_view s)
  (node_id s) 
  (get_block highest_msg)
  GenesisBlock.</span></span></pre><div class="doc">
<a id="lab8"></a><h2 class="section">Local state transitions</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Nodes are responsible for processing messages and updating their local state;
broadcasting outgoing messages is handled by the network. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
In the following section, Giskard local state transitions are organized
according to the type of message being processed. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab9"></a><h3 class="section">Message type-agnostic actions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Block proposal-related definitions: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">GenesisBlock_message</span> (<span class="nv">s</span> : NState) : message :=
  mkMessage ViewChangeQC
  <span class="mi">0</span>
  (node_id s)
  GenesisBlock
  GenesisBlock.</span><span class="alectryon-wsp">    
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">propose_block_init</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = record_plural s (make_PrepareBlocks s (GenesisBlock_message s)) /\
  lm = (make_PrepareBlocks s (GenesisBlock_message s)) /\ 
  s = NState_init (node_id s) /\
  honest_node (node_id s) /\ 
  is_block_proposer (node_id s) <span class="mi">0</span> /\
  <span class="kp">timeout</span> s = false.</span></span></pre><div class="doc">
When the timeout happens, nodes enter a liminal phase where they are only allowed
to process the following kinds of messages: 
<ul class="doclist">
<li> ViewChange from other nodes

</li>
<li> ViewChangeQC 

</li>
<li> PrepareQC 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Upon timeout, nodes send a ViewChange message containing the highest block to reach
Prepare stage in its current view, and the PrepareQC message attesting to that block's Prepare stage. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* It does not increment the view yet *)</span> 
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_timeout</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) :=
  s&#39; = record_plural s [make_ViewChange s; highest_prepare_block_message s] /\
  lm = [make_ViewChange s; highest_prepare_block_message s] /\
  honest_node (node_id s) /\ 
  <span class="kp">timeout</span> s = true.</span><span class="alectryon-wsp">   </span></span></pre><div class="doc">
An expired message - discard and do not process. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">discard_view_invalid</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = discard s msg /\
  lm = [] /\
  received s msg /\ 
  honest_node (node_id s) /\ 
  ~ view_valid s msg.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="c">(* At this point it doesn&#39;t matter whether timeout has occurred or not *)</span></span></pre><div class="doc">
<a id="lab10"></a><h3 class="section">PrepareBlock message-related actions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
If a same height block has been seen - discard the message: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareBlock_duplicate</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = discard s msg /\
  lm = [] /\
  received s msg /\ 
  honest_node (node_id s) /\ 
  get_message_type msg = PrepareBlock /\ 
  view_valid s msg /\
  <span class="kp">timeout</span> s = false /\ 
  exists_same_height_PrepareBlock s (get_block msg).</span></span></pre><div class="doc">
Parent block has not reached Prepare - "add its PrepareVote to pending buffer" by simply
processing the PrepareBlock message and waiting for parent block to reach quorum: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareBlock_pending_vote</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = process s msg /\
  lm = [] /\
  received s msg /\
  honest_node (node_id s) /\ 
  get_message_type msg = PrepareBlock /\ 
  view_valid s msg /\
  <span class="c">(* PrepareBlocks cannot be processed during timeout *)</span> 
  <span class="kp">timeout</span> s = false /\ 
  ~ exists_same_height_PrepareBlock s (get_block msg) /\
  <span class="c">(* Parent block has not reached Prepare *)</span>
  ~ prepare_stage s (parent_of (get_block msg)).</span><span class="alectryon-wsp"> </span></span></pre><div class="doc">
Parent block has reached QC - send PrepareVote for the block in that message and record in out buffer: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareBlock_vote</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = <span class="c">(* Record outgoing PrepareVote messages *)</span>
       record_plural
         (process s msg)
         (pending_PrepareVote s msg) /\
  lm = (pending_PrepareVote s msg) /\
  received s msg /\
  honest_node (node_id s) /\ 
  get_message_type msg = PrepareBlock /\ 
  view_valid s msg /\
  <span class="c">(* PrepareBlocks cannot be processed during timeout *)</span> 
  <span class="kp">timeout</span> s = false /\ 
  prepare_stage s (parent_of (get_block msg)).</span><span class="alectryon-wsp"> </span></span></pre><div class="doc">
<a id="lab11"></a><h3 class="section">PrepareVote message-related actions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Block has not reached prepare stage - wait to send PrepareVote messages for child: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareVote_wait</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = process s msg /\
  lm = [] /\
  received s msg /\
  honest_node (node_id s) /\ 
  get_message_type msg = PrepareVote /\ 
  view_valid s msg /\
  <span class="c">(* PrepareVotes cannot be processed during timeout *)</span> 
  <span class="kp">timeout</span> s = false /\ 
  ~ prepare_stage (process s msg) (get_block msg).</span><span class="alectryon-wsp"> </span></span></pre><div class="doc">
Block is about to reach QC - send PrepareVote messages for child block if it exists and send PrepareQC: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* vote_quorum means quorum PrepareVote messages *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareVote_vote</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = process
         (record_plural
            s
            ((make_PrepareQC s msg) :: pending_PrepareVote s msg))
         msg /\
  lm = (make_PrepareQC s msg) :: pending_PrepareVote s msg /\
  honest_node (node_id s) /\ 
  received s msg /\
  get_message_type msg = PrepareVote /\
  view_valid s msg /\
  <span class="c">(* PrepareVotes cannot be processed during timeout *)</span> 
  <span class="kp">timeout</span> s = false /\
  ~ exists_same_height_block s (get_block msg) /\
  vote_quorum_in_view (process s msg) (get_view msg) (get_block msg).</span><span class="alectryon-wsp"> </span></span></pre><div class="doc">
<a id="lab12"></a><h3 class="section">PrepareQC message-related actions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
PrepareQC messages are considered equivalent to a quorum of PrepareVote messages. 
PrepareQC messages can be processed after timeout, so we do not require that timeout
has not occurred. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The PrepareQC message suffices to directly quorum a block, even if it has not received
enough PrepareVote messages, 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Last block in view for to-be block proposer undergoing normal view change process:
<ul class="doclist">
<li> increment view, and

</li>
<li> propose block at height <code>(S n)</code>. 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareQC_last_block_new_proposer</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  <span class="c">(* Increment the view; propose next block *)</span> 
  s&#39; = record_plural
         <span class="c">(* New state *)</span>
         (increment_view (process s msg))
         <span class="c">(* All to-propose blocks *)</span>
         <span class="c">(* The block generating function starts at the input block height plus one *)</span>
         (make_PrepareBlocks (increment_view (process s msg)) msg) /\ 
  lm = <span class="c">(* Send all block proposals for the new view *)</span>
  make_PrepareBlocks (increment_view (process s msg)) msg /\ 
  received s msg /\ 
  honest_node (node_id s) /\ 
  get_message_type msg = PrepareQC /\ 
  view_valid s msg /\
  <span class="c">(* Here we don&#39;t need for timeout to be false because apparently we can still</span>
<span class="c">    process PrepareQC messages in the timeout period *)</span>
  last_block (get_block msg) /\
  is_block_proposer (node_id s) (S (node_view s)).</span></span></pre><div class="doc">
Last block in the view for to-be validator - increment view: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="c">(* No child blocks can exist, so we don&#39;t need to send anything *)</span> 
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareQC_last_block</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = increment_view (process s msg) /\ 
  lm = [] /\
  received s msg /\ 
  honest_node (node_id s) /\ 
  get_message_type msg = PrepareQC /\ 
  view_valid s msg /\
  <span class="c">(* Here we don&#39;t need for timeout to be false because apparently</span>
<span class="c">     we can still process PrepareQC messages in the timeout period *)</span>
  last_block (get_block msg) /\
  ~ is_block_proposer (node_id s) (S (node_view s)).</span></span></pre><div class="doc">
Not-the-last block in the view - send PrepareVote messages for child block and wait: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareQC_non_last_block</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = process (record_plural s (pending_PrepareVote s msg)) msg /\
  lm = pending_PrepareVote s msg /\
  received s msg /\ 
  honest_node (node_id s) /\ 
  get_message_type msg = PrepareQC /\ 
  view_valid s msg /\
  <span class="kp">timeout</span> s = false /\ 
  ~ last_block (get_block msg).</span></span></pre><div class="doc">
<a id="lab13"></a><h3 class="section">ViewChange message-related actions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
ViewChange messages can be processed after timeout, so we do not require that timeout has not occurred. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Process ViewChange at quorum for to-be block proposer:
<ul class="doclist">
<li> send highest PrepareQC message,

</li>
<li> send ViewChangeQC message,

</li>
<li> increment view, and

</li>
<li> propose new block according to highest block in all quorum ViewChange messages. 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">higher_message</span> (<span class="nv">msg1</span> <span class="nv">msg2</span> : message) : message :=
  <span class="kr">if</span> (block_eqb (get_block msg1) (higher_block (get_block msg1) (get_block msg2)))
  <span class="kr">then</span> msg1
  <span class="kr">else</span> msg2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">highest_message_in_list</span> (<span class="nv">n</span> : node) (<span class="nv">t</span> : message_type) (<span class="nv">lm</span> : list message) : message := 
  fold_right higher_message
             (mkMessage t
                        <span class="mi">0</span>
                        n
                        GenesisBlock
                        GenesisBlock)
             lm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk54"><span class="kn">Lemma</span> <span class="nf">about_highest_message_in_list</span> :
  <span class="kr">forall</span> <span class="nv">n</span> <span class="nv">t</span> <span class="nv">lm</span> <span class="nv">msg</span>,
    In msg lm -&gt;
    b_height (get_block msg) &lt;= b_height (get_block (highest_message_in_list n t lm)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">t</span> : message_type)
  (<span class="nv">lm</span> : list message) (<span class="nv">msg</span> : message),
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk55"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">t</span> : message_type)
  (<span class="nv">lm</span> : list message) (<span class="nv">msg</span> : message),
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk56"><span class="nb">induction</span> lm; <span class="nb">intros</span>; [<span class="nb">inversion</span> H|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (a :: lm)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t (a :: lm)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk57"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a = msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t (a :: lm)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk58" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br></div><label class="goal-separator" for="local-v-chk58"><hr></label><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t (a :: lm)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk59">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a = msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t (a :: lm)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk5a"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a = msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (higher_message a
        (highest_message_in_list n t lm)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk5b"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (higher_message msg
        (highest_message_in_list n t lm)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk5c"><span class="nb">unfold</span> higher_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (<span class="kr">if</span>
       block_eqb (get_block msg)
         (higher_block (get_block msg)
            (get_block
               (highest_message_in_list n t lm)))
      <span class="kr">then</span> msg
      <span class="kr">else</span> highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk5d"><span class="nb">case_eq</span> (block_eqb (get_block msg) (higher_block (get_block msg) (get_block (highest_message_in_list n t lm)))); <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block msg)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk5e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><label class="goal-separator" for="local-v-chk5e"><hr></label><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk5f">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto with</span> arith.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk60">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk61"><span class="nb">unfold</span> higher_block <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (<span class="kr">if</span>
    b_height (get_block msg) &lt;?
    b_height
      (get_block (highest_message_in_list n t lm))
   <span class="kr">then</span> get_block (highest_message_in_list n t lm)
   <span class="kr">else</span> get_block msg) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk62"><span class="nb">revert</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block msg)
  (<span class="kr">if</span>
    b_height (get_block msg) &lt;?
    b_height
      (get_block (highest_message_in_list n t lm))
   <span class="kr">then</span> get_block (highest_message_in_list n t lm)
   <span class="kr">else</span> get_block msg) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk63"><span class="nb">case_eq</span> (b_height (get_block msg) &lt;? b_height (get_block (highest_message_in_list n t lm))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block msg) &lt;?
 b_height (get_block (highest_message_in_list n t lm))) =
true -&gt;
block_eqb (get_block msg)
  (get_block (highest_message_in_list n t lm)) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk64" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><label class="goal-separator" for="local-v-chk64"><hr></label><div class="goal-conclusion">(b_height (get_block msg) &lt;?
 b_height (get_block (highest_message_in_list n t lm))) =
false -&gt;
block_eqb (get_block msg) (get_block msg) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk65">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block msg) &lt;?
 b_height (get_block (highest_message_in_list n t lm))) =
true -&gt;
block_eqb (get_block msg)
  (get_block (highest_message_in_list n t lm)) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk66"><span class="nb">intros</span> Hlt Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>(b_height (get_block msg) &lt;?
 b_height
   (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (get_block (highest_message_in_list n t lm)) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk67"><span class="nb">apply</span> Nat.ltb_lt <span class="kr">in</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (get_block (highest_message_in_list n t lm)) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto with</span> arith.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk68">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block msg) &lt;?
 b_height (get_block (highest_message_in_list n t lm))) =
false -&gt;
block_eqb (get_block msg) (get_block msg) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk69"><span class="nb">intros</span> Hle.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>(b_height (get_block msg) &lt;?
 b_height
   (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block msg) (get_block msg) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk6a"><span class="nb">case</span> (block_eq_dec (get_block msg) (get_block msg)); [|<span class="bp">congruence</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>(b_height (get_block msg) &lt;?
 b_height
   (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_block msg = get_block msg -&gt;
block_eqb (get_block msg) (get_block msg) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk6b"><span class="nb">intro</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>(b_height (get_block msg) &lt;?
 b_height
   (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>get_block msg = get_block msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block msg) (get_block msg) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk6c"><span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>Hle</var><span class="hyp-type"><b>: </b><span>(b_height (get_block msg) &lt;?
 b_height
   (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg) (get_block msg) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block msg) (get_block msg) = false -&gt;
b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk6d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t (a :: lm)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk6e"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (higher_message a
        (highest_message_in_list n t lm)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk6f"><span class="nb">unfold</span> higher_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (<span class="kr">if</span>
       block_eqb (get_block a)
         (higher_block (get_block a)
            (get_block
               (highest_message_in_list n t lm)))
      <span class="kr">then</span> a
      <span class="kr">else</span> highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk70"><span class="nb">case_eq</span> (block_eqb (get_block msg) (higher_block (get_block msg) (get_block (highest_message_in_list n t lm)))); <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (<span class="kr">if</span>
       block_eqb (get_block a)
         (higher_block (get_block a)
            (get_block
               (highest_message_in_list n t lm)))
      <span class="kr">then</span> a
      <span class="kr">else</span> highest_message_in_list n t lm))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk71" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><label class="goal-separator" for="local-v-chk71"><hr></label><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (<span class="kr">if</span>
       block_eqb (get_block a)
         (higher_block (get_block a)
            (get_block
               (highest_message_in_list n t lm)))
      <span class="kr">then</span> a
      <span class="kr">else</span> highest_message_in_list n t lm))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk72">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (<span class="kr">if</span>
       block_eqb (get_block a)
         (higher_block (get_block a)
            (get_block
               (highest_message_in_list n t lm)))
      <span class="kr">then</span> a
      <span class="kr">else</span> highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk73"><span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (<span class="kr">if</span>
       block_eqb (get_block a)
         (higher_block (get_block a)
            (get_block
               (highest_message_in_list n t lm)))
      <span class="kr">then</span> a
      <span class="kr">else</span> highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk74"><span class="nb">case_eq</span> (block_eqb (get_block a) (higher_block (get_block a) (get_block (highest_message_in_list n t lm)))); <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><label class="goal-separator" for="local-v-chk75"><hr></label><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk76">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk77"><span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk78"><span class="nb">apply</span> IHlm <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk79"><span class="nb">assert</span> (b_height (get_block (highest_message_in_list n t lm)) &lt;= b_height (get_block a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk7a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</span></span></span><br></div><label class="goal-separator" for="local-v-chk7a"><hr></label><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk7b">--</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk7c"><span class="nb">rewrite</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk7d"><span class="nb">unfold</span> higher_block.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block (highest_message_in_list n t lm))
   <span class="kr">then</span> get_block (highest_message_in_list n t lm)
   <span class="kr">else</span> get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk7e"><span class="nb">case_eq</span> (b_height (get_block a) &lt;? b_height (get_block (highest_message_in_list n t lm))); [<span class="bp">lia</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;?
 b_height (get_block (highest_message_in_list n t lm))) =
false -&gt;
b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk7f"><span class="nb">intro</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>(b_height (get_block a) &lt;?
 b_height
   (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk80"><span class="nb">apply</span> Nat.ltb_ge <span class="kr">in</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk81">--</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk82">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk83"><span class="nb">apply</span> IHlm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg =
higher_block (get_block msg)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg lm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk84">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height
  (get_block
     (<span class="kr">if</span>
       block_eqb (get_block a)
         (higher_block (get_block a)
            (get_block
               (highest_message_in_list n t lm)))
      <span class="kr">then</span> a
      <span class="kr">else</span> highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk85"><span class="nb">case_eq</span> (block_eqb (get_block a) (higher_block (get_block a) (get_block (highest_message_in_list n t lm)))); <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk86" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><label class="goal-separator" for="local-v-chk86"><hr></label><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk87">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk88"><span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk89"><span class="nb">apply</span> IHlm <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk8a"><span class="nb">assert</span> (b_height (get_block (highest_message_in_list n t lm)) &lt;= b_height (get_block a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk8b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</span></span></span><br></div><label class="goal-separator" for="local-v-chk8b"><hr></label><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk8c">--</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk8d"><span class="nb">rewrite</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk8e"><span class="nb">unfold</span> higher_block.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block (highest_message_in_list n t lm))
   <span class="kr">then</span> get_block (highest_message_in_list n t lm)
   <span class="kr">else</span> get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk8f"><span class="nb">case_eq</span> ((b_height (get_block a) &lt;? b_height (get_block (highest_message_in_list n t lm)))); [<span class="bp">lia</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;?
 b_height (get_block (highest_message_in_list n t lm))) =
false -&gt;
b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk90"><span class="nb">intro</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>(b_height (get_block a) &lt;?
 b_height
   (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk91"><span class="nb">apply</span> Nat.ltb_ge <span class="kr">in</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk92">--</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_block a =
higher_block (get_block a)
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block (highest_message_in_list n t lm)) &lt;=
b_height (get_block a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk93">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg) &lt;=
b_height (get_block (highest_message_in_list n t lm))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk94"><span class="nb">apply</span> IHlm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>message_type</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHlm</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg lm -&gt;
b_height (get_block msg) &lt;=
b_height
  (get_block (highest_message_in_list n t lm))</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg)
  (higher_block (get_block msg)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block (highest_message_in_list n t lm))) =
false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg lm</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">highest_ViewChange_message</span> (<span class="nv">s</span> : NState) : message :=
  highest_message_in_list (node_id s) ViewChange (processed_ViewChange_in_view s (node_view s)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk95"><span class="kn">Lemma</span> <span class="nf">highest_ViewChange_message_type_eq_ViewChange</span> :
  <span class="kr">forall</span> <span class="nv">s</span>, get_message_type (highest_ViewChange_message s) = ViewChange.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">s</span> : NState,
get_message_type (highest_ViewChange_message s) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk96"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">s</span> : NState,
get_message_type (highest_ViewChange_message s) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk97"><span class="nb">intro</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type (highest_ViewChange_message s) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk98"><span class="nb">unfold</span> highest_ViewChange_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk99"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">msg</span>, In msg (processed_ViewChange_in_view s (node_view s)) -&gt; get_message_type msg = ViewChange).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (processed_ViewChange_in_view s (node_view s)) -&gt;
get_message_type msg = ViewChange</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk9a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><label class="goal-separator" for="local-v-chk9a"><hr></label><div class="goal-conclusion">get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk9b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg
  (processed_ViewChange_in_view s (node_view s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = ViewChange</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk9c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><label class="goal-separator" for="local-v-chk9c"><hr></label><div class="goal-conclusion">get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk9d"><span class="nb">apply</span> processed_ViewChange_in_view_correct <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s) /\
get_message_type msg = ViewChange /\
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = ViewChange</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk9e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><label class="goal-separator" for="local-v-chk9e"><hr></label><div class="goal-conclusion">get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk9f"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange /\
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = ViewChange</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chka0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><label class="goal-separator" for="local-v-chka0"><hr></label><div class="goal-conclusion">get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka1"><span class="nb">destruct</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = ViewChange</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chka2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><label class="goal-separator" for="local-v-chka2"><hr></label><div class="goal-conclusion">get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka3"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka4"><span class="nb">revert</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (processed_ViewChange_in_view s (node_view s)) -&gt;
 get_message_type msg = ViewChange) -&gt;
get_message_type
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka5"><span class="nb">generalize</span> (processed_ViewChange_in_view s (node_view s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : list message,
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type
  (highest_message_in_list (node_id s) ViewChange l) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka6"><span class="nb">generalize</span> (node_id s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">l</span> : list message),
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type
  (highest_message_in_list n ViewChange l) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka7"><span class="nb">induction</span> l; [<span class="bp">reflexivity</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (a :: l) -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type
  (highest_message_in_list n ViewChange (a :: l)) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka8"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 a = msg \/ In msg l -&gt;
 get_message_type msg = ViewChange) -&gt;
get_message_type
  (higher_message a
     (highest_message_in_list n ViewChange l)) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chka9"><span class="nb">intro</span> Ht.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type
  (higher_message a
     (highest_message_in_list n ViewChange l)) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkaa"><span class="nb">unfold</span> higher_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type
  (<span class="kr">if</span>
    block_eqb (get_block a)
      (higher_block (get_block a)
         (get_block
            (highest_message_in_list n ViewChange l)))
   <span class="kr">then</span> a
   <span class="kr">else</span> highest_message_in_list n ViewChange l) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkab"><span class="nb">destruct</span> (block_eqb (get_block a) (higher_block (get_block a) (get_block (highest_message_in_list n ViewChange l)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type a = ViewChange</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkac" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><label class="goal-separator" for="local-v-chkac"><hr></label><div class="goal-conclusion">get_message_type
  (highest_message_in_list n ViewChange l) =
ViewChange</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkad">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type a = ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Ht; <span class="nb">left</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkae">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type
  (highest_message_in_list n ViewChange l) =
ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkaf"><span class="nb">apply</span> IHl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg l -&gt; get_message_type msg = ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb0"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message, In msg l -&gt; get_message_type msg = ViewChange) -&gt;
get_message_type (highest_message_in_list n ViewChange l) = ViewChange</span></span></span><br><span><var>Ht</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
get_message_type msg = ViewChange</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type msg = ViewChange</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Ht; <span class="nb">right</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb1"><span class="kn">Lemma</span> <span class="nf">get_view_highest_ViewChange_message_node_view</span> :
  <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">msg</span>, get_message_type msg = ViewChange -&gt;
   get_view msg = node_view s -&gt;
   In msg (counting_messages s) -&gt;
   get_view (highest_ViewChange_message s) = node_view s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message),
get_message_type msg = ViewChange -&gt;
get_view msg = node_view s -&gt;
In msg (counting_messages s) -&gt;
get_view (highest_ViewChange_message s) = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message),
get_message_type msg = ViewChange -&gt;
get_view msg = node_view s -&gt;
In msg (counting_messages s) -&gt;
get_view (highest_ViewChange_message s) = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb3"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view (highest_ViewChange_message s) = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb4"><span class="nb">unfold</span> highest_ViewChange_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb5"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">msg</span>, In msg (processed_ViewChange_in_view s (node_view s)) -&gt; get_view msg = (node_view s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkb6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkb6"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb7"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0
  (processed_ViewChange_in_view s (node_view s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg0 = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkb8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkb8"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkb9"><span class="nb">apply</span> processed_ViewChange_in_view_correct <span class="kr">in</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s) /\
get_message_type msg0 = ViewChange /\
get_view msg0 = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg0 = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkba"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkbb"><span class="nb">destruct</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>get_message_type msg0 = ViewChange /\
get_view msg0 = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg0 = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkbc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkbc"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkbd"><span class="nb">destruct</span> H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>get_message_type msg0 = ViewChange</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>get_view msg0 = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg0 = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkbe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkbe"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkbf"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkc0"><span class="nb">assert</span> (processed_ViewChange_in_view s (node_view s) &lt;&gt; []).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">processed_ViewChange_in_view s (node_view s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkc1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkc1"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkc2"><span class="nb">clear</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">processed_ViewChange_in_view s (node_view s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkc3"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkc4"><span class="nb">unfold</span> processed_ViewChange_in_view.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkc5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkc5"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkc6"><span class="nb">apply</span> In_split <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : list message,
  counting_messages s = l1 ++ msg :: l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkc7"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkc8"><span class="nb">destruct</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">l2</span> : list message,
  counting_messages s = x ++ msg :: l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkc9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkc9"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkca"><span class="nb">destruct</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>counting_messages s = x ++ msg :: x0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkcb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkcb"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkcc"><span class="nb">rewrite</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>counting_messages s = x ++ msg :: x0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s)) 
  (x ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkcd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkcd"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkce"><span class="nb">clear</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s)) 
  (x ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkcf"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkd0"><span class="nb">induction</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s)) 
  ([] ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkd1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chkd1"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chkd2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkd2"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkd3"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (get_view msg =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkd4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chkd4"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chkd5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkd5"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkd6"><span class="nb">rewrite</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkd7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chkd7"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chkd8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkd8"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkd9"><span class="nb">apply</span> eq_sym <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ViewChange = get_message_type msg</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkda" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chkda"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chkdb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkdb"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkdc"><span class="nb">apply</span> message_type_eqb_correct <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkdd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chkdd"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chkde" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkde"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkdf"><span class="nb">rewrite</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> true &amp;&amp; (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chke0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chke0"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chke1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chke1"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chke2"><span class="nb">rewrite</span> Nat.eqb_refl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> true &amp;&amp; true
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chke3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chke3"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chke4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chke4"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chke5"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg
:: filter
     (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
      message_type_eqb ViewChange
        (get_message_type msg) &amp;&amp;
      (get_view msg =? node_view s)) x0 &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chke6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chke6"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chke7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chke7"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chke8"><span class="nb">auto with</span> datatypes.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chke9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chke9"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkea"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type a) &amp;&amp;
  (get_view a =? node_view s)
 <span class="kr">then</span>
  a
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s))
       (x ++ msg :: x0)
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) 
    (x ++ msg :: x0)) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkeb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chkeb"><hr></label><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkec"><span class="nb">case</span> (message_type_eqb ViewChange (get_message_type a) &amp;&amp; (get_view a =? node_view s)); <span class="nb">auto with</span> datatypes.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chked"><span class="nb">clear</span> H1 H0 H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkee"><span class="nb">revert</span> H2 H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (processed_ViewChange_in_view s (node_view s)) -&gt;
 get_view msg = node_view s) -&gt;
processed_ViewChange_in_view s (node_view s) &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s))) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkef"><span class="nb">generalize</span> (processed_ViewChange_in_view s (node_view s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : list message,
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list (node_id s) ViewChange l) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf0"><span class="nb">generalize</span> (node_id s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">l</span> : list message),
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view (highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf1"><span class="nb">induction</span> l; [<span class="bp">congruence</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (a :: l) -&gt; get_view msg = node_view s) -&gt;
a :: l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange (a :: l)) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf2"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 a = msg \/ In msg l -&gt; get_view msg = node_view s) -&gt;
a :: l &lt;&gt; [] -&gt;
get_view
  (higher_message a
     (highest_message_in_list n ViewChange l)) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf3"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a :: l &lt;&gt; []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (higher_message a
     (highest_message_in_list n ViewChange l)) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf4"><span class="nb">clear</span> H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (higher_message a
     (highest_message_in_list n ViewChange l)) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf5"><span class="nb">unfold</span> higher_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (<span class="kr">if</span>
    block_eqb (get_block a)
      (higher_block (get_block a)
         (get_block
            (highest_message_in_list n ViewChange l)))
   <span class="kr">then</span> a
   <span class="kr">else</span> highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf6"><span class="nb">case_eq</span> (block_eqb (get_block a) (higher_block (get_block a) (get_block (highest_message_in_list n ViewChange l)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true -&gt; get_view a = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkf7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkf7"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
get_view (highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkf8"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view a = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkf9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkf9"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
get_view (highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkfa"><span class="nb">apply</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a \/ In a l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkfb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkfb"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
get_view (highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkfc"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chkfd"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
get_view (highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkfe"><span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
get_view (highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chkff"><span class="nb">unfold</span> higher_block.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; get_view msg = node_view s) -&gt;
l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange l) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt; get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange l))
   <span class="kr">then</span>
    get_block (highest_message_in_list n ViewChange l)
   <span class="kr">else</span> get_block a) = false -&gt;
get_view (highest_message_in_list n ViewChange l) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk100"><span class="nb">destruct</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange []))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange [])
   <span class="kr">else</span> get_block a) = false -&gt;
get_view (highest_message_in_list n ViewChange []) =
node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk101" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (m :: l) -&gt; get_view msg = node_view s) -&gt;
m :: l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange (m :: l)) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg (m :: l) -&gt;
get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chk101"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange
            (m :: l)))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange (m :: l))
   <span class="kr">else</span> get_block a) = false -&gt;
get_view
  (highest_message_in_list n ViewChange (m :: l)) =
node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk102">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange []))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange [])
   <span class="kr">else</span> get_block a) = false -&gt;
get_view (highest_message_in_list n ViewChange []) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk103"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span> b_height (get_block a) &lt;? b_height GenesisBlock
   <span class="kr">then</span> GenesisBlock
   <span class="kr">else</span> get_block a) = false -&gt; 
<span class="mi">0</span> = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk104"><span class="nb">case_eq</span> (b_height (get_block a) &lt;? b_height GenesisBlock).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
true -&gt;
block_eqb (get_block a) GenesisBlock = false -&gt;
<span class="mi">0</span> = node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk105" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><label class="goal-separator" for="local-v-chk105"><hr></label><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
false -&gt;
block_eqb (get_block a) (get_block a) = false -&gt;
<span class="mi">0</span> = node_view s</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk106">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
true -&gt;
block_eqb (get_block a) GenesisBlock = false -&gt;
<span class="mi">0</span> = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk107"><span class="nb">rewrite</span> Nat.ltb_lt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block a) &lt; b_height GenesisBlock -&gt;
block_eqb (get_block a) GenesisBlock = false -&gt;
<span class="mi">0</span> = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk108"><span class="nb">intro</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>b_height (get_block a) &lt; b_height GenesisBlock</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a) GenesisBlock = false -&gt;
<span class="mi">0</span> = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk109"><span class="bp">contradict</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ b_height (get_block a) &lt; b_height GenesisBlock</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk10a"><span class="nb">apply</span> Nat.ltb_nlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk10b"><span class="nb">apply</span> Nat.ltb_ge.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height GenesisBlock &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> GenesisBlock_height.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk10c">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
false -&gt;
block_eqb (get_block a) (get_block a) = false -&gt;
<span class="mi">0</span> = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk10d"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(b_height (get_block a) &lt;? b_height GenesisBlock) =
false</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a) (get_block a) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk10e"><span class="nb">case</span> (block_eq_dec (get_block a) (get_block a)); [|<span class="bp">congruence</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; get_view msg = node_view s) -&gt;
[] &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange []) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(b_height (get_block a) &lt;? b_height GenesisBlock) =
false</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a) (get_block a) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_block a = get_block a -&gt; <span class="mi">0</span> = node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> e; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk10f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (m :: l) -&gt; get_view msg = node_view s) -&gt;
m :: l &lt;&gt; [] -&gt;
get_view
  (highest_message_in_list n ViewChange (m :: l)) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg (m :: l) -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange
            (m :: l)))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange (m :: l))
   <span class="kr">else</span> get_block a) = false -&gt;
get_view
  (highest_message_in_list n ViewChange (m :: l)) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk110"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 m = msg \/ In msg l -&gt;
 get_view msg = node_view s) -&gt;
m :: l &lt;&gt; [] -&gt;
get_view
  (higher_message m
     (highest_message_in_list n ViewChange l)) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ m = msg \/ In msg l -&gt;
get_view msg = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (higher_message m
            (highest_message_in_list n ViewChange l)))
   <span class="kr">then</span>
    get_block
      (higher_message m
         (highest_message_in_list n ViewChange l))
   <span class="kr">else</span> get_block a) = false -&gt;
get_view
  (higher_message m
     (highest_message_in_list n ViewChange l)) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk111"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 m = msg \/ In msg l -&gt;
 get_view msg = node_view s) -&gt;
m :: l &lt;&gt; [] -&gt;
get_view
  (higher_message m
     (highest_message_in_list n ViewChange l)) =
node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ m = msg \/ In msg l -&gt;
get_view msg = node_view s</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (higher_message m
            (highest_message_in_list n ViewChange
               l)))
   <span class="kr">then</span>
    get_block
      (higher_message m
         (highest_message_in_list n ViewChange l))
   <span class="kr">else</span> get_block a) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view
  (higher_message m
     (highest_message_in_list n ViewChange l)) =
node_view s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl; <span class="nb">auto with</span> datatypes.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk112"><span class="kn">Lemma</span> <span class="nf">get_view_highest_ViewChange_message_in_counting_messages</span> :
  <span class="kr">forall</span> <span class="nv">s</span> <span class="nv">msg</span>, get_message_type msg = ViewChange -&gt;
   get_view msg = node_view s -&gt;
   In msg (counting_messages s) -&gt;
   In (highest_ViewChange_message s) (counting_messages s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message),
get_message_type msg = ViewChange -&gt;
get_view msg = node_view s -&gt;
In msg (counting_messages s) -&gt;
In (highest_ViewChange_message s)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk113"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message),
get_message_type msg = ViewChange -&gt;
get_view msg = node_view s -&gt;
In msg (counting_messages s) -&gt;
In (highest_ViewChange_message s)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk114"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In (highest_ViewChange_message s)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk115"><span class="nb">unfold</span> highest_ViewChange_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk116"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">msg</span>, In msg (processed_ViewChange_in_view s (node_view s)) -&gt; In msg (counting_messages s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk117" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk117"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk118"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0
  (processed_ViewChange_in_view s (node_view s))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk119" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk119"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk11a"><span class="nb">apply</span> processed_ViewChange_in_view_correct <span class="kr">in</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s) /\
get_message_type msg0 = ViewChange /\
get_view msg0 = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk11b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk11b"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk11c"><span class="nb">destruct</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>get_message_type msg0 = ViewChange /\
get_view msg0 = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk11d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk11d"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk11e"><span class="nb">destruct</span> H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>get_message_type msg0 = ViewChange</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>get_view msg0 = node_view s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk11f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk11f"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk120"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk121"><span class="nb">assert</span> (processed_ViewChange_in_view s (node_view s) &lt;&gt; []).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">processed_ViewChange_in_view s (node_view s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk122" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk122"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk123"><span class="nb">clear</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">processed_ViewChange_in_view s (node_view s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk124" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk124"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk125"><span class="nb">unfold</span> processed_ViewChange_in_view.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk126" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk126"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk127"><span class="nb">apply</span> In_split <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : list message,
  counting_messages s = l1 ++ msg :: l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk128" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk128"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk129"><span class="nb">destruct</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">l2</span> : list message,
  counting_messages s = x ++ msg :: l2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk12a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk12a"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk12b"><span class="nb">destruct</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>counting_messages s = x ++ msg :: x0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (counting_messages s) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk12c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk12c"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk12d"><span class="nb">rewrite</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>counting_messages s = x ++ msg :: x0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s)) 
  (x ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk12e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk12e"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk12f"><span class="nb">clear</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s)) 
  (x ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk130" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk130"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk131"><span class="nb">induction</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s)) 
  ([] ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk132" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk132"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk133" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk133"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk134"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (get_view msg =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk135" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk135"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk136" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk136"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk137"><span class="nb">rewrite</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk138" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk138"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk139" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk139"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk13a"><span class="nb">apply</span> eq_sym <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ViewChange = get_message_type msg</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk13b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk13b"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk13c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk13c"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk13d"><span class="nb">apply</span> message_type_eqb_correct <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
  (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk13e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk13e"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk13f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk13f"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk140"><span class="nb">rewrite</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> true &amp;&amp; (node_view s =? node_view s)
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk141" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk141"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk142" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk142"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk143"><span class="nb">rewrite</span> Nat.eqb_refl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> true &amp;&amp; true
 <span class="kr">then</span>
  msg
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s)) x0
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk144" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk144"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk145" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk145"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk146"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>message_type_eqb ViewChange (get_message_type msg) =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg
:: filter
     (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
      message_type_eqb ViewChange
        (get_message_type msg) &amp;&amp;
      (get_view msg =? node_view s)) x0 &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk147" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><label class="goal-separator" for="local-v-chk147"><hr></label><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk148" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk148"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk149"><span class="nb">auto with</span> datatypes.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  ((a :: x) ++ msg :: x0) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk14a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk14a"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk14b"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>x, x0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>filter
  (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
   message_type_eqb ViewChange
     (get_message_type msg) &amp;&amp;
   (get_view msg =? node_view s))
  (x ++ msg :: x0) &lt;&gt; []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span>
  message_type_eqb ViewChange (get_message_type a) &amp;&amp;
  (get_view a =? node_view s)
 <span class="kr">then</span>
  a
  :: filter
       (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
        message_type_eqb ViewChange
          (get_message_type msg) &amp;&amp;
        (get_view msg =? node_view s))
       (x ++ msg :: x0)
 <span class="kr">else</span>
  filter
    (<span class="kr">fun</span> <span class="nv">msg</span> : message =&gt;
     message_type_eqb ViewChange
       (get_message_type msg) &amp;&amp;
     (get_view msg =? node_view s)) 
    (x ++ msg :: x0)) &lt;&gt; []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk14c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><label class="goal-separator" for="local-v-chk14c"><hr></label><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk14d"><span class="nb">case</span> (message_type_eqb ViewChange (get_message_type a) &amp;&amp; (get_view a =? node_view s)); <span class="nb">auto with</span> datatypes.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>get_message_type msg = ViewChange</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk14e"><span class="nb">clear</span> H H0 H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_ViewChange_in_view s (node_view s)) -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>processed_ViewChange_in_view s (node_view s) &lt;&gt;
[]</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk14f"><span class="nb">revert</span> H2 H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (processed_ViewChange_in_view s (node_view s)) -&gt;
 In msg (counting_messages s)) -&gt;
processed_ViewChange_in_view s (node_view s) &lt;&gt; [] -&gt;
In
  (highest_message_in_list 
     (node_id s) ViewChange
     (processed_ViewChange_in_view s (node_view s)))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk150"><span class="nb">generalize</span> (processed_ViewChange_in_view s (node_view s)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">l</span> : list message,
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list (node_id s) ViewChange l)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk151"><span class="nb">generalize</span> (node_id s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">l</span> : list message),
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk152"><span class="nb">induction</span> l; [<span class="bp">congruence</span>|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (a :: l) -&gt; In msg (counting_messages s)) -&gt;
a :: l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange (a :: l))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk153"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 a = msg \/ In msg l -&gt; In msg (counting_messages s)) -&gt;
a :: l &lt;&gt; [] -&gt;
In
  (higher_message a
     (highest_message_in_list n ViewChange l))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk154"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>a :: l &lt;&gt; []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (higher_message a
     (highest_message_in_list n ViewChange l))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk155"><span class="nb">clear</span> H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (higher_message a
     (highest_message_in_list n ViewChange l))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk156"><span class="nb">unfold</span> higher_message.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (<span class="kr">if</span>
    block_eqb (get_block a)
      (higher_block (get_block a)
         (get_block
            (highest_message_in_list n ViewChange l)))
   <span class="kr">then</span> a
   <span class="kr">else</span> highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk157"><span class="nb">case_eq</span> (block_eqb (get_block a) (higher_block (get_block a) (get_block (highest_message_in_list n ViewChange l)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true -&gt; In a (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk158" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk158"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk159"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In a (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk15a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk15a"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk15b"><span class="nb">apply</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a \/ In a l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk15c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk15c"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk15d"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk15e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk15e"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk15f"><span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (higher_block (get_block a)
     (get_block
        (highest_message_in_list n ViewChange l))) =
false -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk160"><span class="nb">unfold</span> higher_block.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg l -&gt; In msg (counting_messages s)) -&gt;
l &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange l))
   <span class="kr">then</span>
    get_block (highest_message_in_list n ViewChange l)
   <span class="kr">else</span> get_block a) = false -&gt;
In (highest_message_in_list n ViewChange l)
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk161"><span class="nb">destruct</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange []))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange [])
   <span class="kr">else</span> get_block a) = false -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk162" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (m :: l) -&gt; In msg (counting_messages s)) -&gt;
m :: l &lt;&gt; [] -&gt;
In
  (highest_message_in_list n ViewChange (m :: l))
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg (m :: l) -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk162"><hr></label><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange
            (m :: l)))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange (m :: l))
   <span class="kr">else</span> get_block a) = false -&gt;
In (highest_message_in_list n ViewChange (m :: l))
  (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk163">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange []))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange [])
   <span class="kr">else</span> get_block a) = false -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk164"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span> b_height (get_block a) &lt;? b_height GenesisBlock
   <span class="kr">then</span> GenesisBlock
   <span class="kr">else</span> get_block a) = false -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk165"><span class="nb">case_eq</span> (b_height (get_block a) &lt;? b_height GenesisBlock).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
true -&gt;
block_eqb (get_block a) GenesisBlock = false -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk166" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><label class="goal-separator" for="local-v-chk166"><hr></label><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
false -&gt;
block_eqb (get_block a) (get_block a) = false -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk167">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
true -&gt;
block_eqb (get_block a) GenesisBlock = false -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk168"><span class="nb">rewrite</span> Nat.ltb_lt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block a) &lt; b_height GenesisBlock -&gt;
block_eqb (get_block a) GenesisBlock = false -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk169"><span class="nb">intro</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>b_height (get_block a) &lt; b_height GenesisBlock</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a) GenesisBlock = false -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk16a"><span class="bp">contradict</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ b_height (get_block a) &lt; b_height GenesisBlock</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk16b"><span class="nb">apply</span> Nat.ltb_nlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk16c"><span class="nb">apply</span> Nat.ltb_ge.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height GenesisBlock &lt;= b_height (get_block a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> GenesisBlock_height.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk16d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(b_height (get_block a) &lt;? b_height GenesisBlock) =
false -&gt;
block_eqb (get_block a) (get_block a) = false -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk16e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(b_height (get_block a) &lt;? b_height GenesisBlock) =
false</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a) (get_block a) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk16f"><span class="nb">case</span> (block_eq_dec (get_block a) (get_block a)); [|<span class="bp">congruence</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg [] -&gt; In msg (counting_messages s)) -&gt;
[] &lt;&gt; [] -&gt;
In (highest_message_in_list n ViewChange [])
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg [] -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(b_height (get_block a) &lt;? b_height GenesisBlock) =
false</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a) (get_block a) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_block a = get_block a -&gt;
In
  {|
    get_message_type := ViewChange;
    get_view := <span class="mi">0</span>;
    get_sender := n;
    get_block := GenesisBlock;
    get_piggyback_block := GenesisBlock
  |} (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> e; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk170">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (m :: l) -&gt; In msg (counting_messages s)) -&gt;
m :: l &lt;&gt; [] -&gt;
In
  (highest_message_in_list n ViewChange (m :: l))
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ In msg (m :: l) -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (highest_message_in_list n ViewChange
            (m :: l)))
   <span class="kr">then</span>
    get_block
      (highest_message_in_list n ViewChange (m :: l))
   <span class="kr">else</span> get_block a) = false -&gt;
In (highest_message_in_list n ViewChange (m :: l))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk171"><span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 m = msg \/ In msg l -&gt;
 In msg (counting_messages s)) -&gt;
m :: l &lt;&gt; [] -&gt;
In
  (higher_message m
     (highest_message_in_list n ViewChange l))
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ m = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (higher_message m
            (highest_message_in_list n ViewChange l)))
   <span class="kr">then</span>
    get_block
      (higher_message m
         (highest_message_in_list n ViewChange l))
   <span class="kr">else</span> get_block a) = false -&gt;
In
  (higher_message m
     (highest_message_in_list n ViewChange l))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk172"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>a, m</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>IHl</var><span class="hyp-type"><b>: </b><span>(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 m = msg \/ In msg l -&gt;
 In msg (counting_messages s)) -&gt;
m :: l &lt;&gt; [] -&gt;
In
  (higher_message m
     (highest_message_in_list n ViewChange l))
  (counting_messages s)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
a = msg \/ m = msg \/ In msg l -&gt;
In msg (counting_messages s)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block a)
  (<span class="kr">if</span>
    b_height (get_block a) &lt;?
    b_height
      (get_block
         (higher_message m
            (highest_message_in_list n ViewChange
               l)))
   <span class="kr">then</span>
    get_block
      (higher_message m
         (highest_message_in_list n ViewChange l))
   <span class="kr">else</span> get_block a) = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  (higher_message m
     (highest_message_in_list n ViewChange l))
  (counting_messages s)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHl; <span class="nb">auto with</span> datatypes.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_ViewChange_quorum_new_proposer</span>
 (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = <span class="c">(* Record new blocks after incrementing view *)</span>
  record_plural (increment_view (process (process s msg)
   (mkMessage PrepareQC (get_view msg) (get_sender msg)
    (get_block (highest_ViewChange_message (process s msg))) GenesisBlock)))
    <span class="c">(* The input has to include the current ViewChange message, just in</span>
<span class="c">       case that is the one which contains the highest block *)</span>
      (<span class="c">(* PrepareQC of highest block *)</span>
        (mkMessage PrepareQC (node_view s) (node_id s)
          (get_block (highest_ViewChange_message (process s msg))) GenesisBlock) :: 
       <span class="c">(* ViewChangeQC containing highest block *)</span>
       (make_ViewChangeQC s (highest_ViewChange_message (process s msg))) ::
       <span class="c">(* New block proposals *)</span>
       (make_PrepareBlocks (increment_view s) (highest_ViewChange_message (process s msg)))) /\
  lm = <span class="c">(* Send ViewChangeQC message before incrementing view to ensure the others can process it *)</span>
  (mkMessage PrepareQC (node_view s) (node_id s)
    (get_block (highest_ViewChange_message (process s msg))) GenesisBlock) ::
  (make_ViewChangeQC s (highest_ViewChange_message (process s msg))) ::
  <span class="c">(* Send PrepareBlock messages *)</span> 
  (make_PrepareBlocks (increment_view s) (highest_ViewChange_message (process s msg))) /\
  received s msg /\
  <span class="c">(* This condition is necessary given ViewChange sending behavior *)</span> 
  received s (mkMessage PrepareQC (get_view msg) (get_sender msg)
   (get_block (highest_ViewChange_message (process s msg))) GenesisBlock) /\ 
  honest_node (node_id s) /\ 
  get_message_type msg = ViewChange /\
  view_valid s msg /\
  <span class="c">(* ViewChange messages can be processed during timeout *)</span>
  <span class="c">(* It is important that the parameter here is (process s msg) and not simply s *)</span>
  view_change_quorum_in_view (process s msg) (node_view s) /\
  is_block_proposer (node_id s) (S (node_view s)).</span></span></pre><div class="doc">
Process ViewChange before quorum - keep and wait for QC: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_ViewChange_pre_quorum</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = process s msg /\
  lm = [] /\
  received s msg /\ 
  honest_node (node_id s) /\ 
  get_message_type msg = ViewChange /\ 
  view_valid s msg /\
  ~ view_change_quorum_in_view (process s msg) (node_view s).</span></span></pre><div class="doc">
<a id="lab14"></a><h3 class="section">ViewChangeQC message-related actions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Process highest PrepareQC message, process ViewChangeQC, then increment view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Critically, this is where we enforce that the PrepareQC of the max height block
is processed before view change occurs, otherwise nodes can get stuck during view change. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_ViewChangeQC_single</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = increment_view (process (process s
    (mkMessage PrepareQC (node_view s) (get_sender msg) (get_block msg) GenesisBlock)) msg) /\
  lm = [] /\
  received s msg /\
  received s (mkMessage PrepareQC (node_view s) (get_sender msg) (get_block msg) GenesisBlock) /\
  honest_node (node_id s) /\ 
  get_message_type msg = ViewChangeQC /\ 
  view_valid s msg.</span></span></pre><div class="doc">
<a id="lab15"></a><h3 class="section">Timeout</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
When timeout is triggered, send ViewChange with the highest prepare stage block.
Given the new definition of prepare stage, this block might not be from the current view at all. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">flip_timeout</span> (<span class="nv">s</span> : NState) : NState :=
  mkNState (node_view s) (node_id s) (in_messages s) (counting_messages s) (out_messages s)  true.</span></span></pre><div class="doc">
<a id="lab16"></a><h3 class="section">Malicious node actions</h3>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Malicious nodes can ignore messages: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">malicious_ignore</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = discard s msg /\
  lm = [] /\
  received s msg /\
  ~ honest_node (node_id s).</span></span></pre><div class="doc">
Malicious nodes can double vote for two blocks of the same height: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">process_PrepareBlock_malicious_vote</span> (<span class="nv">s</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">s&#39;</span> : NState) (<span class="nv">lm</span> : list message) : <span class="kt">Prop</span> :=
  s&#39; = record_plural (process s msg) (pending_PrepareVote s msg) /\
  lm = pending_PrepareVote s msg /\
  received s msg /\
  ~ honest_node (node_id s) /\ 
  get_message_type msg = PrepareBlock /\ 
  view_valid s msg /\
  exists_same_height_block s (get_block msg).</span></span></pre><div class="doc">
<a id="lab17"></a><h2 class="section">Protocol transition type definitions</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Valid Giskard transitions can be defined as a finite set/type of relations on pre-state,
post-state, processed message and outgoing message(s), constrained by protocol rules. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">NState_transition_type</span> :=
| propose_block_init_type
| discard_view_invalid_type 
| process_PrepareBlock_duplicate_type
| process_PrepareBlock_pending_vote_type 
| process_PrepareBlock_vote_type
| process_PrepareVote_vote_type
| process_PrepareVote_wait_type
| process_PrepareQC_last_block_new_proposer_type
| process_PrepareQC_last_block_type
| process_PrepareQC_non_last_block_type
| process_ViewChange_quorum_new_proposer_type
| process_ViewChange_pre_quorum_type
| process_ViewChangeQC_single_type
| process_PrepareBlock_malicious_vote_type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">get_transition</span> (<span class="nv">t</span> : NState_transition_type) : (NState -&gt; message -&gt; NState -&gt; list message -&gt; <span class="kt">Prop</span>) :=
  <span class="kr">match</span> t <span class="kr">with</span>
  | propose_block_init_type =&gt; propose_block_init
  | discard_view_invalid_type =&gt; discard_view_invalid
  | process_PrepareBlock_duplicate_type =&gt; process_PrepareBlock_duplicate
  | process_PrepareBlock_pending_vote_type =&gt; process_PrepareBlock_pending_vote
  | process_PrepareBlock_vote_type =&gt; process_PrepareBlock_pending_vote
  | process_PrepareQC_last_block_new_proposer_type =&gt; process_PrepareQC_last_block_new_proposer
  | process_PrepareQC_last_block_type =&gt; process_PrepareQC_last_block
  | process_PrepareQC_non_last_block_type =&gt; process_PrepareQC_non_last_block
  | process_PrepareVote_vote_type =&gt; process_PrepareVote_vote
  | process_PrepareVote_wait_type =&gt; process_PrepareVote_wait
  | process_ViewChange_quorum_new_proposer_type =&gt; process_ViewChange_quorum_new_proposer
  | process_ViewChange_pre_quorum_type =&gt; process_ViewChange_pre_quorum
  | process_ViewChangeQC_single_type =&gt; process_ViewChangeQC_single
  | process_PrepareBlock_malicious_vote_type =&gt; process_PrepareBlock_malicious_vote
  <span class="kr">end</span>.</span></span></pre><div class="doc">
<a id="lab18"></a><h2 class="section">Facts about local state transitions</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk173"><span class="kn">Lemma</span> <span class="nf">out_messages_local_monotonic</span> :
  <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
    (get_transition t) s1 msg s2 lm -&gt;
    <span class="kr">forall</span> (<span class="nv">msg0</span> : message),
      In msg0 (out_messages s1) -&gt;
      In msg0 (out_messages s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
get_transition t s1 msg s2 lm -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 (out_messages s1) -&gt; In msg0 (out_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk174"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
get_transition t s1 msg s2 lm -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 (out_messages s1) -&gt; In msg0 (out_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp">     
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk175"><span class="nb">intros</span> s1 s2 msg lm t H_step msg0 H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition t s1 msg s2 lm</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg0 (out_messages s1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (out_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk176"><span class="nb">assert</span> (H_step_copy := H_step).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition t s1 msg s2 lm</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg0 (out_messages s1)</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition t s1 msg s2 lm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (out_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> t; <span class="nb">simpl</span> <span class="kr">in</span> H_step;
    <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_subst _];
    <span class="kp">try</span> (<span class="nb">subst</span>; <span class="bp">assumption</span>);
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_subst; <span class="nb">simpl</span>; <span class="nb">rewrite</span> in_app_iff; <span class="kp">repeat</span> <span class="nb">right</span>; <span class="bp">assumption</span>); 
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_subst <span class="kr">in</span> *; <span class="nb">simpl</span>; <span class="nb">right</span>;
         <span class="nb">assert</span> (H : In msg0 (pending_messages_about_block s1 (get_block msg)) \/ In msg0 (out_messages s1)) <span class="bp">by</span> <span class="bp">tauto</span>;
          <span class="nb">apply</span> in_app_iff <span class="kr">in</span> H; <span class="bp">assumption</span>);
    <span class="kp">try</span> (<span class="nb">destruct</span> H_step_copy <span class="kr">as</span> [_ [_ [_ [H_init _]]]]; 
         <span class="nb">rewrite</span> H_init <span class="kr">in</span> H_in; <span class="nb">inversion</span> H_in);
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_subst; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="nb">rewrite</span> in_app_iff; <span class="kp">repeat</span> <span class="nb">right</span>; 
         <span class="bp">assumption</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk177"><span class="kn">Lemma</span> <span class="nf">counting_messages_same_view_monotonic</span> :
  <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
    (get_transition t) s1 msg s2 lm -&gt;
    node_view s1 = node_view s2 -&gt; 
    <span class="kr">forall</span> (<span class="nv">msg0</span> : message),
      In msg0 (counting_messages s1) -&gt;
      In msg0 (counting_messages s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
get_transition t s1 msg s2 lm -&gt;
node_view s1 = node_view s2 -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 (counting_messages s1) -&gt;
In msg0 (counting_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk178"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
get_transition t s1 msg s2 lm -&gt;
node_view s1 = node_view s2 -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 (counting_messages s1) -&gt;
In msg0 (counting_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp">     
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk179"><span class="nb">intros</span> s1 s2 msg lm t H_step H_view msg0 H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition t s1 msg s2 lm</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>node_view s1 = node_view s2</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (counting_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> t; <span class="nb">simpl</span> <span class="kr">in</span> H_step;
    <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_subst _];
    <span class="nb">simpl</span> <span class="kr">in</span> H_subst; 
    <span class="kp">try</span> (<span class="nb">subst</span>; <span class="bp">assumption</span>); 
    <span class="kp">try</span> <span class="nb">rewrite</span> H_subst <span class="kr">in</span> *; <span class="nb">simpl</span>;
      <span class="kp">try</span> (<span class="nb">simpl</span> <span class="kr">in</span> H_view; <span class="bp">lia</span>);
      <span class="kp">try</span> (<span class="nb">right</span>; <span class="nb">assert</span> (In msg0 (pending_messages_about_block s1 (get_block msg)) \/ In msg0 (out_messages s1)) <span class="bp">by</span> <span class="bp">tauto</span>;
           <span class="nb">apply</span> in_app_iff <span class="kr">in</span> H; <span class="bp">assumption</span>);
      <span class="kp">try</span> <span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk17a"><span class="kn">Lemma</span> <span class="nf">counting_messages_local_monotonic</span> :
  <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
    (get_transition t) s1 msg s2 lm -&gt;
    <span class="kr">forall</span> (<span class="nv">msg0</span> : message),
      In msg0 (counting_messages s1) -&gt;
      In msg0 (counting_messages s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
get_transition t s1 msg s2 lm -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 (counting_messages s1) -&gt;
In msg0 (counting_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk17b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">t</span> : NState_transition_type),
get_transition t s1 msg s2 lm -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 (counting_messages s1) -&gt;
In msg0 (counting_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp">     
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk17c"><span class="nb">intros</span> s1 s2 msg lm t H_step msg0 H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition t s1 msg s2 lm</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (counting_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk17d"><span class="nb">assert</span> (H_step_copy := H_step).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition t s1 msg s2 lm</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg0 (counting_messages s1)</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition t s1 msg s2 lm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (counting_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> t; <span class="nb">simpl</span> <span class="kr">in</span> H_step;
    <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_subst _];
    <span class="kp">try</span> (<span class="nb">subst</span>; <span class="bp">assumption</span>);
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_subst; <span class="nb">simpl</span>; <span class="nb">rewrite</span> in_app_iff; <span class="kp">repeat</span> <span class="nb">right</span>; <span class="bp">assumption</span>); 
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_subst <span class="kr">in</span> *; <span class="nb">simpl</span>; <span class="nb">right</span>;
         <span class="nb">assert</span> (H : In msg0 (pending_messages_about_block s1 (get_block msg)) \/ In msg0 (out_messages s1)) <span class="bp">by</span> <span class="bp">tauto</span>;
         <span class="nb">apply</span> in_app_iff <span class="kr">in</span> H; <span class="bp">assumption</span>);
    <span class="kp">try</span> (<span class="nb">destruct</span> H_step_copy <span class="kr">as</span> [_ [_ [_ [H_init _]]]]; 
         <span class="nb">rewrite</span> H_init <span class="kr">in</span> H_in; <span class="nb">inversion</span> H_in);
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_subst; <span class="nb">simpl</span>; <span class="kp">try</span> <span class="nb">rewrite</span> in_app_iff; <span class="kp">repeat</span> <span class="nb">right</span>; 
         <span class="bp">assumption</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk17e"><span class="kn">Lemma</span> <span class="nf">about_local_out_messages</span> :
  <span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message) (<span class="nv">lm</span> : list message) (<span class="nv">p</span> : NState_transition_type),
    get_transition p s1 msg s2 lm -&gt;
    <span class="kr">forall</span> (<span class="nv">msg0</span> : message),
      In msg0 lm -&gt;
      In msg0 (out_messages s2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">p</span> : NState_transition_type),
get_transition p s1 msg s2 lm -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 lm -&gt; In msg0 (out_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk17f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s1</span> <span class="nv">s2</span> : NState) (<span class="nv">msg</span> : message)
  (<span class="nv">lm</span> : list message) (<span class="nv">p</span> : NState_transition_type),
get_transition p s1 msg s2 lm -&gt;
<span class="kr">forall</span> <span class="nv">msg0</span> : message,
In msg0 lm -&gt; In msg0 (out_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk180"><span class="nb">intros</span> s1 s2 msg lm p H_step msg0 H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s1, s2</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p s1 msg s2 lm</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg0 lm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg0 (out_messages s2)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> p;
    <span class="nb">assert</span> (H_step_copy := H_step);
    <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_update [H_out _]];
    <span class="nb">rewrite</span> H_out <span class="kr">in</span> H_in;
    <span class="c">(* In cases where lm = [] *)</span> 
    <span class="kp">try</span> (<span class="bp">now</span> <span class="nb">apply</span> in_nil <span class="kr">in</span> H_in);
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_update; <span class="nb">simpl</span>;
         <span class="nb">rewrite</span> in_app_iff; <span class="bp">tauto</span>);
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_update; <span class="nb">simpl</span>;
         <span class="nb">inversion</span> H_in; <span class="nb">subst</span>; <span class="kp">try</span> <span class="bp">tauto</span>;
         <span class="nb">right</span>; <span class="nb">apply</span> in_app_iff; <span class="bp">tauto</span>);
    <span class="kp">try</span> (<span class="nb">rewrite</span> H_update; 
         <span class="nb">simpl</span> <span class="kr">in</span> *;
         <span class="nb">destruct</span> H_in <span class="kr">as</span> [H_in | [H_in | [H_in | H_in]]];
         <span class="bp">tauto</span>).</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk181"><span class="kn">Lemma</span> <span class="nf">not_prepare_stage</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block),
    ~ prepare_stage s b -&gt;
    ~ vote_quorum_in_view s (node_view s) b /\
    <span class="kr">forall</span> (<span class="nv">msg</span> : message),
      In msg (counting_messages s) -&gt;
      get_block msg = b -&gt;
      get_view msg = (node_view s) -&gt; 
      get_message_type msg = PrepareQC -&gt;
      <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block),
~ prepare_stage s b -&gt;
~ vote_quorum_in_view s (node_view s) b /\
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (counting_messages s) -&gt;
 get_block msg = b -&gt;
 get_view msg = node_view s -&gt;
 get_message_type msg = PrepareQC -&gt; <span class="kt">False</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk182"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block),
~ prepare_stage s b -&gt;
~ vote_quorum_in_view s (node_view s) b /\
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (counting_messages s) -&gt;
 get_block msg = b -&gt;
 get_view msg = node_view s -&gt;
 get_message_type msg = PrepareQC -&gt; <span class="kt">False</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk183"><span class="nb">intros</span> s b H_not.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ vote_quorum_in_view s (node_view s) b /\
(<span class="kr">forall</span> <span class="nv">msg</span> : message,
 In msg (counting_messages s) -&gt;
 get_block msg = b -&gt;
 get_view msg = node_view s -&gt;
 get_message_type msg = PrepareQC -&gt; <span class="kt">False</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk184"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ vote_quorum_in_view s (node_view s) b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk185" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk185"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk186"><span class="nb">intros</span> H_not2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>H_not2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view s (node_view s) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk187" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk187"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk188"><span class="nb">apply</span> H_not.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>H_not2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view s (node_view s) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage s b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk189" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk189"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk18a"><span class="kr">exists</span> (<span class="nv">node_view</span> <span class="nv">s</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>H_not2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view s (node_view s) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">node_view s &lt;= node_view s /\
prepare_stage_in_view s (node_view s) b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk18b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk18b"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk18c"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>H_not2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view s (node_view s) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">node_view s &lt;= node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk18d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>H_not2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view s (node_view s) b</span></span></span><br></div><label class="goal-separator" for="local-v-chk18d"><hr></label><div class="goal-conclusion">prepare_stage_in_view s (node_view s) b</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk18e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk18e"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk18f"><span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>H_not2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view s (node_view s) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage_in_view s (node_view s) b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk190" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk190"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk191"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>H_not2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view s (node_view s) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view s (node_view s) b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk192" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk192"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk193"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (counting_messages s) -&gt;
get_block msg = b -&gt;
get_view msg = node_view s -&gt;
get_message_type msg = PrepareQC -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk194"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg = b</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk195"><span class="nb">apply</span> H_not.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg = b</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage s b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk196"><span class="kr">exists</span> (<span class="nv">node_view</span> <span class="nv">s</span>); <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">lia</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg = b</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage_in_view s (node_view s) b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk197"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg = b</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PrepareQC_in_view s (node_view s) b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk198"><span class="kr">exists</span> <span class="nv">msg</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>H_not</var><span class="hyp-type"><b>: </b><span>~ prepare_stage s b</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages s)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>get_block msg = b</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>get_view msg = node_view s</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (counting_messages s) /\
get_view msg = node_view s /\
get_block msg = b /\ get_message_type msg = PrepareQC</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk199"><span class="kn">Lemma</span> <span class="nf">prepare_stage_record_agnostic</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">msg</span> : message),
    prepare_stage (record s msg) b -&gt; 
    prepare_stage s b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">msg</span> : message),
prepare_stage (record s msg) b -&gt; prepare_stage s b</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk19a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">msg</span> : message),
prepare_stage (record s msg) b -&gt; prepare_stage s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk19b"><span class="nb">intros</span> s b msg H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (record s msg) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk19c"><span class="nb">destruct</span> H <span class="kr">as</span> [v&#39; [H_past H_prepare]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (record s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage s b</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk19d"><span class="kr">exists</span> <span class="nv">v&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (record s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v&#39; &lt;= node_view s /\ prepare_stage_in_view s v&#39; b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk19e"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (record s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v&#39; &lt;= node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk19f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (record s msg) v&#39; b</span></span></span><br></div><label class="goal-separator" for="local-v-chk19f"><hr></label><div class="goal-conclusion">prepare_stage_in_view s v&#39; b</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a0"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (record s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage_in_view s v&#39; b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a1"><span class="kn">Lemma</span> <span class="nf">prepare_stage_record_plural_agnostic</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">lm</span> : list message),
    prepare_stage (record_plural s lm) b &lt;-&gt; 
    prepare_stage s b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">lm</span> : list message),
prepare_stage (record_plural s lm) b &lt;-&gt;
prepare_stage s b</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">lm</span> : list message),
prepare_stage (record_plural s lm) b &lt;-&gt;
prepare_stage s b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a3"><span class="nb">intros</span> s b msg; <span class="nb">split</span>; <span class="nb">intro</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (record_plural s msg) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage s b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1a4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1a4"><hr></label><div class="goal-conclusion">prepare_stage (record_plural s msg) b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a5"><span class="nb">destruct</span> H <span class="kr">as</span> [v&#39; [H_past H_prepare]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record_plural s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (record_plural s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage s b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1a6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1a6"><hr></label><div class="goal-conclusion">prepare_stage (record_plural s msg) b</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a7"><span class="kr">exists</span> <span class="nv">v&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record_plural s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (record_plural s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v&#39; &lt;= node_view s /\ prepare_stage_in_view s v&#39; b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1a8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1a8"><hr></label><div class="goal-conclusion">prepare_stage (record_plural s msg) b</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1a9"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record_plural s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (record_plural s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v&#39; &lt;= node_view s</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1aa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record_plural s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (record_plural s msg) v&#39; b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1aa"><hr></label><div class="goal-conclusion">prepare_stage_in_view s v&#39; b</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk1ab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1ab"><hr></label><div class="goal-conclusion">prepare_stage (record_plural s msg) b</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1ac"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;= node_view (record_plural s msg)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (record_plural s msg) v&#39; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage_in_view s v&#39; b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1ad" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage s b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1ad"><hr></label><div class="goal-conclusion">prepare_stage (record_plural s msg) b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1ae"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage s b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage (record_plural s msg) b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1af"><span class="kn">Lemma</span> <span class="nf">prepare_stage_process_record_plural_agnostic</span> :
  <span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">lm</span> : list message) (<span class="nv">msg</span> : message),
    prepare_stage (process (record_plural s lm) msg) b &lt;-&gt; 
    prepare_stage (process s msg) b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">lm</span> : list message)
  (<span class="nv">msg</span> : message),
prepare_stage (process (record_plural s lm) msg) b &lt;-&gt;
prepare_stage (process s msg) b</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1b0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">s</span> : NState) (<span class="nv">b</span> : block) (<span class="nv">lm</span> : list message)
  (<span class="nv">msg</span> : message),
prepare_stage (process (record_plural s lm) msg) b &lt;-&gt;
prepare_stage (process s msg) b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1b1"><span class="nb">intros</span> s b msg; <span class="nb">split</span>; <span class="nb">intro</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (process (record_plural s msg) msg0)
  b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage (process s msg0) b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1b2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (process s msg0) b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1b2"><hr></label><div class="goal-conclusion">prepare_stage (process (record_plural s msg) msg0) b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1b3"><span class="nb">destruct</span> H <span class="kr">as</span> [v&#39; [H_past H_prepare]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;=
node_view
  (process (record_plural s msg) msg0)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (process (record_plural s msg) msg0) v&#39;
  b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage (process s msg0) b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1b4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (process s msg0) b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1b4"><hr></label><div class="goal-conclusion">prepare_stage (process (record_plural s msg) msg0) b</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1b5"><span class="kr">exists</span> <span class="nv">v&#39;</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;=
node_view
  (process (record_plural s msg) msg0)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (process (record_plural s msg) msg0) v&#39;
  b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v&#39; &lt;= node_view (process s msg0) /\
prepare_stage_in_view (process s msg0) v&#39; b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1b6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (process s msg0) b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1b6"><hr></label><div class="goal-conclusion">prepare_stage (process (record_plural s msg) msg0) b</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1b7"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;=
node_view
  (process (record_plural s msg) msg0)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (process (record_plural s msg) msg0) v&#39;
  b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v&#39; &lt;= node_view (process s msg0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1b8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;=
node_view
  (process (record_plural s msg) msg0)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (process (record_plural s msg) msg0) v&#39;
  b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1b8"><hr></label><div class="goal-conclusion">prepare_stage_in_view (process s msg0) v&#39; b</div></blockquote><input class="alectryon-extra-goal-toggle" id="local-v-chk1b9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (process s msg0) b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1b9"><hr></label><div class="goal-conclusion">prepare_stage (process (record_plural s msg) msg0) b</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1ba"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>v'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_past</var><span class="hyp-type"><b>: </b><span>v&#39; &lt;=
node_view
  (process (record_plural s msg) msg0)</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view
  (process (record_plural s msg) msg0) v&#39;
  b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage_in_view (process s msg0) v&#39; b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="local-v-chk1bb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (process s msg0) b</span></span></span><br></div><label class="goal-separator" for="local-v-chk1bb"><hr></label><div class="goal-conclusion">prepare_stage (process (record_plural s msg) msg0) b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="local-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="local-v-chk1bc"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>s</var><span class="hyp-type"><b>: </b><span>NState</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>prepare_stage (process s msg0) b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage (process (record_plural s msg) msg0) b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>