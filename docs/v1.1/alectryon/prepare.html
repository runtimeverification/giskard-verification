<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>prepare.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link href="pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.16.0+0.16.2. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Coq <span class="kn">Require Import</span> Arith Bool List.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Giskard <span class="kn">Require Import</span> lib structures local <span class="kn">global</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> ListNotations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Implicit Arguments</span>.</span></span></pre><div class="doc">
<a id="lab1"></a><h1 class="section">Safety property one: Prepare stage height injectivity</h1>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
<a id="lab2"></a><h2 class="section">Prepare stage height injectivity definition</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Recall that a block is in prepare stage in some local state iff it has
received quorum PrepareVote messages or a PrepareQC message in the current
view or some previous view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The first safety property states that no two same height blocks can be
at prepare stage in the same view, i.e., prepare stage block height is injective
in the same view. The first safety property differs from the following two in that
it contains an additional premise restricting the view during which the two blocks
reached prepare stage. This is important because it is possible for multiple blocks
at the same height to reach prepare stage across different views in the case of
abnormal view changes. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
In any global state i in a valid protocol trace tr that begins with the initial
state and respects the protocol transition rules, if there are two participating
nodes n and m, and two blocks b1 b2, such that b1 and b2 have the same height,
and both reach prepare stage for n and m's local state respectively in some view p,
but are not equal, then we can prove a contradiction. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">prepare_stage_same_view_height_injective_statement</span> :=
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">n</span> <span class="nv">m</span> : node) (<span class="nv">b1</span> <span class="nv">b2</span> : block) (<span class="nv">p</span> : nat),
      In n participants -&gt;
      In m participants -&gt;
      b1 &lt;&gt; b2 -&gt;
      prepare_stage_in_view (fst (tr i) n) p b1 -&gt; 
      prepare_stage_in_view (fst (tr i) m) p b2 -&gt;      
      b_height b1 = b_height b2 -&gt;
      <span class="kt">False</span>.</span></span></pre><div class="doc">
<a id="lab3"></a><h2 class="section">Reducing the proof</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Intuitively, the proof of this property follows directly from the definition of
non-Byzantine/honest voting behavior: honest nodes cannot vote for two conflicting
blocks during the same view. If two conflicting blocks reach prepare stage in the
same view, then two quorums of at least 2/3 validators voted for each block.
By the pigeonhole principle, there must exist a set of at least 1/3 validators who
voted for both conflicting blocks and are therefore Byzantine/dishonest. By assumption,
there are no more than 1/3 Byzantine/dishonest blocks. Therefore, we reach a contradiction. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
The formal proof proceeds by identifying a series of conditions that can both prove
that there exist more than 1/3 dishonest nodes (bottom-up) and be proven from the
node-local premises (top-down), and leverages the global broadcast message buffer,
which can be viewed as a ghost variable. Starting with the bottom-up direciton, we
first identify the most obvious sufficient condition for a node to be dishonest:
a node n is dishonest if there exist two equivocating messages in its own local
out-message buffer. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Local evidence of malice. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equivocating_in_state</span> (<span class="nv">s</span> : NState) : <span class="kt">Prop</span> :=
  <span class="kr">exists</span> (<span class="nv">msg1</span> <span class="nv">msg2</span> : message),
    In msg1 (out_messages s) /\
    In msg2 (out_messages s) /\
    get_view msg1 = get_view msg2 /\
    get_message_type msg1 = PrepareVote /\
    get_message_type msg2 = PrepareVote /\
    get_block msg1 &lt;&gt; get_block msg2 /\
    b_height (get_block msg1) = b_height (get_block msg2).</span></span></pre><div class="doc">
However, it turns out that this obvious definition of local evidence of malice is
not the weakest precondition for a node being dishonest: there is a sufficient condition
yet for local evidence of malice. Giskard's transition rules forbid nodes from processing
PrepareBlock messages for conflicting blocks. This in turn prevents nodes from sending
PrepareVote messages for conflicting blocks at the get-go: nodes can only send a PrepareVote
message for a block if they have received the corresponding PrepareBlock message for that
block. Therefore, a malicious node can be detected by the presence of two conflicting
PrepareBlock messages in its processed message buffer. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
If a node has sent a PrepareVote message for some block, then it must have
processed a PrepareBlock message for that block in the same view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk0"><span class="kn">Lemma</span> <span class="nf">sent_PrepareVote_means_received_PrepareBlock</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
      In n participants -&gt;
      In msg (out_messages (fst (tr i) n)) -&gt;
      get_message_type msg = PrepareVote -&gt; 
      <span class="kr">exists</span> (<span class="nv">msg&#39;</span> : message),
        In msg&#39; (counting_messages (fst (tr i) n)) /\
        get_message_type msg&#39; = PrepareBlock /\
        get_block msg&#39;= get_block msg /\
        get_view msg&#39; = get_view msg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
In n participants -&gt;
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
In n participants -&gt;
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">         
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk2"><span class="nb">intros</span> tr H_prot n i msg H_part H_sent H_type.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk3"><span class="nb">generalize dependent</span> msg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk4"><span class="nb">induction</span> i <span class="kr">as</span> [|i IH_prot]; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr <span class="mi">0</span>) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk5"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr <span class="mi">0</span>) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> H_prot <span class="kr">as</span> [H_init _];
      <span class="nb">rewrite</span> H_init <span class="kr">in</span> H_sent;
      <span class="nb">inversion</span> H_sent.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk8"><span class="nb">destruct</span> (In_dec message_eq_dec msg (out_messages (fst (tr i) n))) <span class="kr">as</span> [H_old | H_new].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk9"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkb">spec IH_prot msg H_old H_type.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkc"><span class="nb">destruct</span> IH_prot <span class="kr">as</span> [msg&#39; IH_prot].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; = get_block msg /\
get_view msg&#39; = get_view msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkd"><span class="kr">exists</span> <span class="nv">msg&#39;</span>; <span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; = get_block msg /\
get_view msg&#39; = get_view msg</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> counting_messages_monotonic.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chke">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (out_messages (fst (tr i) n)) -&gt;
get_message_type msg = PrepareVote -&gt;
<span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf"><span class="nb">clear</span> IH_prot.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk10"><span class="nb">assert</span> (H_prot_copy := H_prot); 
        <span class="nb">destruct</span> H_prot <span class="kr">as</span> [_ H_prot].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
GState_transition (tr n) (tr (S n))</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk11">spec H_prot i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>GState_transition (tr i) (tr (S i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk12"><span class="nb">destruct</span> H_prot <span class="kr">as</span> [[n0 [H_in0 [p0 [msg0 [lm0 [H_step H_deliver]]]]]] | H_timeout].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk13" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk13"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Establishing that n must be in lm0 *)</span> 
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk14"><span class="nb">assert</span> (In msg lm0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg lm0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk15" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk15"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk16" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk16"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk17"><span class="nb">apply</span> (out_messages_change_means_sent H_prot_copy _ _ _ _ H_in0 H_deliver H_step _ H_part);
        <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk18" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk18"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk19"><span class="nb">assert</span> (n0 = n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n0 = n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1a"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1b"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c"><span class="nb">apply</span> (out_message_change_tells_sender H_prot_copy _ _ _ _ H_in0 H_deliver H_step n H_part).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg</span> : message,
  In msg (out_messages (fst (tr (S i)) n)) /\
  ~ In msg (out_messages (fst (tr i) n))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1d"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1e"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1f"><span class="kr">exists</span> <span class="nv">msg</span>; <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk20" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk20"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk21"><span class="nb">rewrite</span> H0 <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n) msg0
  (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk22"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Case analysis on transition made from i ~~&gt; S i *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk23"><span class="nb">destruct</span> p0;
        <span class="nb">assert</span> (H_step_copy := H_step);
        <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_update [H_broadcast H_rest]];
        <span class="nb">rewrite</span> H_broadcast <span class="kr">in</span> H;
        <span class="kp">try</span> <span class="nb">apply</span> in_inv <span class="kr">in</span> H;
        <span class="c">(* For cases that do not send messages *)</span>
        <span class="kp">try</span> <span class="bp">tauto</span>;
        <span class="kp">try</span> (<span class="nb">apply</span> make_PrepareBlocks_message_type <span class="kr">in</span> H; 
             <span class="nb">rewrite</span> H_type <span class="kr">in</span> H; <span class="bp">discriminate</span>); 
        <span class="kp">repeat</span> <span class="nb">destruct</span> H <span class="kr">as</span> [H | H]; 
        <span class="kp">try</span> (<span class="nb">subst</span>; <span class="nb">rewrite</span> H_type <span class="kr">in</span> H_rest;
             <span class="nb">assert</span> (PrepareVote = PrepareQC) <span class="bp">by</span> <span class="bp">tauto</span>;
             <span class="bp">discriminate</span>);
        <span class="kp">try</span> (<span class="nb">rewrite</span> &lt;- H <span class="kr">in</span> H_type; <span class="bp">discriminate</span>);
        <span class="kp">try</span> <span class="nb">inversion</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk24" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk24"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk25"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk26"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      <span class="c">(* In the three cases where voting actually occurs,</span>
<span class="c">       the existential witness is in H *)</span>  
      
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk27"><span class="nb">apply</span> in_map_iff <span class="kr">in</span> H;
      <span class="nb">destruct</span> H <span class="kr">as</span> [msg&#39; [H_eq&#39; H_about_msg&#39;]];
      <span class="kr">exists</span> <span class="nv">msg&#39;</span>; <span class="nb">rewrite</span> &lt;- H_eq&#39;;
      <span class="nb">apply</span> filter_In <span class="kr">in</span> H_about_msg&#39;;
      <span class="nb">destruct</span> H_about_msg&#39; <span class="kr">as</span> [H_in&#39; H_about_msg&#39;];
      <span class="nb">apply</span> andb_prop <span class="kr">in</span> H_about_msg&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_about_msg'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb
     (fst (tr i) n) (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;)
  (get_block msg0) = true /\
message_type_eqb
  (get_message_type msg&#39;) PrepareBlock =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk28" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk28"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk29" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk29"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk2a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk2a"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk2b"><span class="nb">destruct</span> H_about_msg&#39; <span class="kr">as</span> [H_view&#39; H_type&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk2c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk2c"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk2d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk2d"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk2e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk2e"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk2f"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true /\
parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk30" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk30"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk31" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk31"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk32" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk32"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk33"><span class="nb">destruct</span> H_view&#39; <span class="kr">as</span> [H_view&#39; _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk34"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk35" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk35"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk36" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk36"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk37"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true /\
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk38" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk38"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk39"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk3a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk3a"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk3b"><span class="nb">destruct</span> H_view&#39; <span class="kr">as</span> [H_view&#39; _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk3c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk3c"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk3d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk3d"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk3e"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk3f"><span class="nb">rewrite</span> message_type_eqb_correct <span class="kr">in</span> H_type&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk40" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk40"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk41" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk41"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk42" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk42"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk43"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk44" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk44"><hr></label><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk45" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk45"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk46" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk46"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk47" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk47"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk48"><span class="bp">now</span> <span class="nb">apply</span> counting_messages_monotonic.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk49" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk49"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk4a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk4a"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk4b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk4b"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk4c"><span class="nb">unfold</span> view_valid <span class="kr">in</span> H_rest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
node_view (fst (tr i) n) = get_view msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk4d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk4d"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk4e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk4e"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk4f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk4f"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk50"><span class="nb">rewrite</span> Nat.eqb_eq <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
node_view (fst (tr i) n) = get_view msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk51" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk51"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk52" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk52"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk53" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk53"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk54"><span class="nb">rewrite</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (make_PrepareQC (fst (tr i) n) msg0
      :: pending_PrepareVote 
           (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n) msg0
:: pending_PrepareVote (fst (tr i) n)
     msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n)) /\
received (fst (tr i) n) msg0 /\
get_message_type msg0 = PrepareVote /\
node_view (fst (tr i) n) = get_view msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_block 
  (fst (tr i) n) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg0 =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk55" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk55"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk56" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk56"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk57" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk57"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk58"><span class="nb">symmetry</span>; <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk59"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk5a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk5a"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk5b"><span class="nb">apply</span> in_map_iff <span class="kr">in</span> H;
      <span class="nb">destruct</span> H <span class="kr">as</span> [msg&#39; [H_eq&#39; H_about_msg&#39;]];
      <span class="kr">exists</span> <span class="nv">msg&#39;</span>; <span class="nb">rewrite</span> &lt;- H_eq&#39;;
      <span class="nb">apply</span> filter_In <span class="kr">in</span> H_about_msg&#39;;
      <span class="nb">destruct</span> H_about_msg&#39; <span class="kr">as</span> [H_in&#39; H_about_msg&#39;];
      <span class="nb">apply</span> andb_prop <span class="kr">in</span> H_about_msg&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_about_msg'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb
     (fst (tr i) n) (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;)
  (get_block msg0) = true /\
message_type_eqb
  (get_message_type msg&#39;) PrepareBlock =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk5c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk5c"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk5d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk5d"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk5e"><span class="nb">destruct</span> H_about_msg&#39; <span class="kr">as</span> [H_view&#39; H_type&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk5f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk5f"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk60" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk60"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk61"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true /\
parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk62" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk62"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk63" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk63"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk64"><span class="nb">destruct</span> H_view&#39; <span class="kr">as</span> [H_view&#39; _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk65" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk65"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk66" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk66"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk67"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true /\
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk68" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk68"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk69" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk69"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk6a"><span class="nb">destruct</span> H_view&#39; <span class="kr">as</span> [H_view&#39; _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk6b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk6b"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk6c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk6c"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk6d"><span class="nb">rewrite</span> message_type_eqb_correct <span class="kr">in</span> H_type&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk6e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk6e"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk6f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk6f"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk70"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk71" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk71"><hr></label><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk72" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk72"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk73" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk73"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk74"><span class="bp">now</span> <span class="nb">apply</span> counting_messages_monotonic.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
view_valid (fst (tr i) n) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk75"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk76" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk76"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk77"><span class="nb">unfold</span> view_valid <span class="kr">in</span> H_rest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
node_view (fst (tr i) n) = get_view msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk78" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk78"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk79" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk79"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk7a"><span class="nb">rewrite</span> Nat.eqb_eq <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
node_view (fst (tr i) n) = get_view msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk7b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk7b"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk7c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk7c"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk7d"><span class="nb">rewrite</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process
  (record_plural (fst (tr i) n)
     (pending_PrepareVote 
        (fst (tr i) n) msg0)) msg0</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareQC /\
node_view (fst (tr i) n) = get_view msg0 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~ last_block (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareQC_non_last_block_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg0 =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk7e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk7e"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk7f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk7f"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk80"><span class="nb">symmetry</span>; <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk81" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk81"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk82"><span class="nb">apply</span> in_map_iff <span class="kr">in</span> H;
      <span class="nb">destruct</span> H <span class="kr">as</span> [msg&#39; [H_eq&#39; H_about_msg&#39;]];
      <span class="kr">exists</span> <span class="nv">msg&#39;</span>; <span class="nb">rewrite</span> &lt;- H_eq&#39;;
      <span class="nb">apply</span> filter_In <span class="kr">in</span> H_about_msg&#39;;
      <span class="nb">destruct</span> H_about_msg&#39; <span class="kr">as</span> [H_in&#39; H_about_msg&#39;];
      <span class="nb">apply</span> andb_prop <span class="kr">in</span> H_about_msg&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_about_msg'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb
     (fst (tr i) n) (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;)
  (get_block msg0) = true /\
message_type_eqb
  (get_message_type msg&#39;) PrepareBlock =
true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk83" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk83"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk84"><span class="nb">destruct</span> H_about_msg&#39; <span class="kr">as</span> [H_view&#39; H_type&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) &amp;&amp;
parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk85" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk85"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk86"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true /\
parent_ofb (get_block msg&#39;) (get_block msg0) =
true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk87" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk87"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk88"><span class="nb">destruct</span> H_view&#39; <span class="kr">as</span> [H_view&#39; _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) &amp;&amp;
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk89" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk89"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk8a"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true /\
negb
  (exists_same_height_blockb 
     (fst (tr i) n) (get_block msg&#39;)) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk8b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk8b"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk8c"><span class="nb">destruct</span> H_view&#39; <span class="kr">as</span> [H_view&#39; _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg&#39;)
  PrepareBlock = true</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk8d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk8d"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk8e"><span class="nb">rewrite</span> message_type_eqb_correct <span class="kr">in</span> H_type&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
get_message_type msg&#39; = PrepareBlock /\
get_block msg&#39; =
get_block (make_PrepareVote (fst (tr i) n) msg0 msg&#39;) /\
get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk8f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk8f"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk90"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg&#39; (counting_messages (fst (tr (S i)) n))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk91" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk91"><hr></label><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk92" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk92"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk93"><span class="bp">now</span> <span class="nb">apply</span> counting_messages_monotonic.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
view_valid (fst (tr i) n) msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk94" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk94"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk95"><span class="nb">unfold</span> view_valid <span class="kr">in</span> H_rest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
node_view (fst (tr i) n) = get_view msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>(get_view msg&#39; =? get_view msg0) = true</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk96" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk96"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk97"><span class="nb">rewrite</span> Nat.eqb_eq <span class="kr">in</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
node_view (fst (tr i) n) = get_view msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg&#39; =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk98" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk98"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk99"><span class="nb">rewrite</span> H_view&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural (process (fst (tr i) n) msg0)
  (pending_PrepareVote (fst (tr i) n) msg0)</span></span></span><br><span><var>H_broadcast</var><span class="hyp-type"><b>: </b><span>lm0 =
pending_PrepareVote (fst (tr i) n) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n) msg0 /\
~ honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = PrepareBlock /\
node_view (fst (tr i) n) = get_view msg0 /\
exists_same_height_block 
  (fst (tr i) n) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>msg'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_eq'</var><span class="hyp-type"><b>: </b><span>make_PrepareVote (fst (tr i) n) msg0 msg&#39; =
msg</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg&#39; (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view'</var><span class="hyp-type"><b>: </b><span>get_view msg&#39; = get_view msg0</span></span></span><br><span><var>H_type'</var><span class="hyp-type"><b>: </b><span>get_message_type msg&#39; = PrepareBlock</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_malicious_vote_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg0 =
get_view (make_PrepareVote (fst (tr i) n) msg0 msg&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk9a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk9a"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk9b"><span class="nb">symmetry</span>; <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg (out_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      
      <span class="c">(* In the timeout case *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk9c"><span class="nb">rewrite</span> H_timeout <span class="kr">in</span> H_sent.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent</var><span class="hyp-type"><b>: </b><span>In msg
  (out_messages
     (fst
        (<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
         <span class="kr">if</span> is_member n participants
         <span class="kr">then</span> flip_timeout (fst (tr i) n)
         <span class="kr">else</span> fst (tr i) n, 
         snd (tr i)) n))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareVote</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39; (counting_messages (fst (tr (S i)) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg /\
  get_view msg&#39; = get_view msg</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> is_member_correct <span class="kr">in</span> H_part;
        <span class="nb">simpl</span> <span class="kr">in</span> H_sent;
        <span class="nb">rewrite</span> H_part <span class="kr">in</span> H_sent;
        <span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Thus, the following condition is sufficient to show local evidence of malice:
we say that a node is "pre-equivocating" if it has processed two PrepareBlock
messages for two different blocks of the same height in the same view. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pre_equivocating_in_state</span> (<span class="nv">s</span> : NState) : <span class="kt">Prop</span> :=
  <span class="kr">exists</span> (<span class="nv">msg1</span> <span class="nv">msg2</span> : message),
    In msg1 (counting_messages s) /\
    In msg2 (counting_messages s) /\
    get_view msg1 = get_view msg2 /\
    get_message_type msg1 = PrepareBlock /\
    get_message_type msg2 = PrepareBlock /\
    get_block msg1 &lt;&gt; get_block msg2 /\
    b_height (get_block msg1) = b_height (get_block msg2).</span></span></pre><div class="doc">
"Pre-equivocation" is a weaker notion than "equivocation". 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk9d"><span class="kn">Lemma</span> <span class="nf">pre_local_means_local_evidence_of_equivocation</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
      In n participants -&gt;
      equivocating_in_state (fst (tr i) n) -&gt;
      pre_equivocating_in_state (fst (tr i) n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
equivocating_in_state (fst (tr i) n) -&gt;
pre_equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk9e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
equivocating_in_state (fst (tr i) n) -&gt;
pre_equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk9f"><span class="nb">intros</span> tr H_prot n i H_part [msg1 [msg2 [H_sent1
   [H_sent2 [H_view [H_type1 [H_type2 [H_neq H_height_eq]]]]]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pre_equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka0"><span class="nb">assert</span> (H_received1 := @sent_PrepareVote_means_received_PrepareBlock
   tr H_prot n i msg1 H_part H_sent1 H_type1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_received1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39;
    (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg1 /\
  get_view msg&#39; = get_view msg1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pre_equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka1"><span class="nb">assert</span> (H_received2 := @sent_PrepareVote_means_received_PrepareBlock
   tr H_prot n i msg2 H_part H_sent2 H_type2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_received1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39;
    (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg1 /\
  get_view msg&#39; = get_view msg1</span></span></span><br><span><var>H_received2</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39;
    (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg2 /\
  get_view msg&#39; = get_view msg2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pre_equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">   
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka2"><span class="nb">destruct</span> H_received1 <span class="kr">as</span> [msg1&#39; [H_processed1&#39;
   [H_type1&#39; [H_block1&#39; H_view1&#39;]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>H_received2</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">msg&#39;</span> : message,
  In msg&#39;
    (counting_messages (fst (tr i) n)) /\
  get_message_type msg&#39; = PrepareBlock /\
  get_block msg&#39; = get_block msg2 /\
  get_view msg&#39; = get_view msg2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pre_equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka3"><span class="nb">destruct</span> H_received2 <span class="kr">as</span> [msg2&#39; [H_processed2&#39;
   [H_type2&#39; [H_block2&#39; H_view2&#39;]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>msg2'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed2'</var><span class="hyp-type"><b>: </b><span>In msg2&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type2'</var><span class="hyp-type"><b>: </b><span>get_message_type msg2&#39; = PrepareBlock</span></span></span><br><span><var>H_block2'</var><span class="hyp-type"><b>: </b><span>get_block msg2&#39; = get_block msg2</span></span></span><br><span><var>H_view2'</var><span class="hyp-type"><b>: </b><span>get_view msg2&#39; = get_view msg2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pre_equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka4"><span class="kr">exists</span> <span class="nv">msg1&#39;</span>, msg2&#39;; <span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>msg2'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed2'</var><span class="hyp-type"><b>: </b><span>In msg2&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type2'</var><span class="hyp-type"><b>: </b><span>get_message_type msg2&#39; = PrepareBlock</span></span></span><br><span><var>H_block2'</var><span class="hyp-type"><b>: </b><span>get_block msg2&#39; = get_block msg2</span></span></span><br><span><var>H_view2'</var><span class="hyp-type"><b>: </b><span>get_view msg2&#39; = get_view msg2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_view msg1&#39; = get_view msg2&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chka5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>msg2'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed2'</var><span class="hyp-type"><b>: </b><span>In msg2&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type2'</var><span class="hyp-type"><b>: </b><span>get_message_type msg2&#39; = PrepareBlock</span></span></span><br><span><var>H_block2'</var><span class="hyp-type"><b>: </b><span>get_block msg2&#39; = get_block msg2</span></span></span><br><span><var>H_view2'</var><span class="hyp-type"><b>: </b><span>get_view msg2&#39; = get_view msg2</span></span></span><br></div><label class="goal-separator" for="prepare-v-chka5"><hr></label><div class="goal-conclusion">get_block msg1&#39; &lt;&gt; get_block msg2&#39;</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chka6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>msg2'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed2'</var><span class="hyp-type"><b>: </b><span>In msg2&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type2'</var><span class="hyp-type"><b>: </b><span>get_message_type msg2&#39; = PrepareBlock</span></span></span><br><span><var>H_block2'</var><span class="hyp-type"><b>: </b><span>get_block msg2&#39; = get_block msg2</span></span></span><br><span><var>H_view2'</var><span class="hyp-type"><b>: </b><span>get_view msg2&#39; = get_view msg2</span></span></span><br></div><label class="goal-separator" for="prepare-v-chka6"><hr></label><div class="goal-conclusion">b_height (get_block msg1&#39;) =
b_height (get_block msg2&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka7"><span class="bp">now</span> <span class="nb">rewrite</span> H_view1&#39;, H_view2&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>msg2'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed2'</var><span class="hyp-type"><b>: </b><span>In msg2&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type2'</var><span class="hyp-type"><b>: </b><span>get_message_type msg2&#39; = PrepareBlock</span></span></span><br><span><var>H_block2'</var><span class="hyp-type"><b>: </b><span>get_block msg2&#39; = get_block msg2</span></span></span><br><span><var>H_view2'</var><span class="hyp-type"><b>: </b><span>get_view msg2&#39; = get_view msg2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_block msg1&#39; &lt;&gt; get_block msg2&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chka8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>msg2'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed2'</var><span class="hyp-type"><b>: </b><span>In msg2&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type2'</var><span class="hyp-type"><b>: </b><span>get_message_type msg2&#39; = PrepareBlock</span></span></span><br><span><var>H_block2'</var><span class="hyp-type"><b>: </b><span>get_block msg2&#39; = get_block msg2</span></span></span><br><span><var>H_view2'</var><span class="hyp-type"><b>: </b><span>get_view msg2&#39; = get_view msg2</span></span></span><br></div><label class="goal-separator" for="prepare-v-chka8"><hr></label><div class="goal-conclusion">b_height (get_block msg1&#39;) =
b_height (get_block msg2&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chka9"><span class="bp">now</span> <span class="nb">rewrite</span> H_block1&#39;, H_block2&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (out_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>msg1'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed1'</var><span class="hyp-type"><b>: </b><span>In msg1&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type1'</var><span class="hyp-type"><b>: </b><span>get_message_type msg1&#39; = PrepareBlock</span></span></span><br><span><var>H_block1'</var><span class="hyp-type"><b>: </b><span>get_block msg1&#39; = get_block msg1</span></span></span><br><span><var>H_view1'</var><span class="hyp-type"><b>: </b><span>get_view msg1&#39; = get_view msg1</span></span></span><br><span><var>msg2'</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed2'</var><span class="hyp-type"><b>: </b><span>In msg2&#39;
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_type2'</var><span class="hyp-type"><b>: </b><span>get_message_type msg2&#39; = PrepareBlock</span></span></span><br><span><var>H_block2'</var><span class="hyp-type"><b>: </b><span>get_block msg2&#39; = get_block msg2</span></span></span><br><span><var>H_view2'</var><span class="hyp-type"><b>: </b><span>get_view msg2&#39; = get_view msg2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b_height (get_block msg1&#39;) =
b_height (get_block msg2&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> H_block1&#39;, H_block2&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Therefore, if we can prove dishonesty from pre-equivocation, then we can
prove dishonesty from equivocation. In other words, we must show the following: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pre_local_evidence_of_equivocation_statement</span> := 
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
      In n participants -&gt;
      pre_equivocating_in_state (fst (tr i) n) -&gt;
      ~ honest_node n.</span></span></pre><div class="doc">
The proof of the above proceeds by induction, which requires the following two cases: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkaa"><span class="kn">Lemma</span> <span class="nf">pre_local_evidence_of_equivocation_middle_case</span> :
 <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace), protocol_trace tr -&gt;
 <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat), In n participants -&gt;
 <span class="kr">forall</span> (<span class="nv">msg1</span> <span class="nv">msg2</span> : message),
  In msg1 (counting_messages (fst (tr (S i)) n)) -&gt;
  In msg2 (counting_messages (fst (tr (S i)) n)) -&gt;
  get_view msg1 = get_view msg2 -&gt;
  get_message_type msg1 = PrepareBlock -&gt;
  get_message_type msg2 = PrepareBlock -&gt;
  get_block msg1 &lt;&gt; get_block msg2 -&gt;
  b_height (get_block msg1) = b_height (get_block msg2) -&gt;
  honest_node n -&gt;
  In msg2 (counting_messages (fst (tr i) n)) -&gt;
  ~ In msg1 (counting_messages (fst (tr i) n)) -&gt;
  <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
<span class="kr">forall</span> <span class="nv">msg1</span> <span class="nv">msg2</span> : message,
In msg1 (counting_messages (fst (tr (S i)) n)) -&gt;
In msg2 (counting_messages (fst (tr (S i)) n)) -&gt;
get_view msg1 = get_view msg2 -&gt;
get_message_type msg1 = PrepareBlock -&gt;
get_message_type msg2 = PrepareBlock -&gt;
get_block msg1 &lt;&gt; get_block msg2 -&gt;
b_height (get_block msg1) = b_height (get_block msg2) -&gt;
honest_node n -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
~ In msg1 (counting_messages (fst (tr i) n)) -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
<span class="kr">forall</span> <span class="nv">msg1</span> <span class="nv">msg2</span> : message,
In msg1 (counting_messages (fst (tr (S i)) n)) -&gt;
In msg2 (counting_messages (fst (tr (S i)) n)) -&gt;
get_view msg1 = get_view msg2 -&gt;
get_message_type msg1 = PrepareBlock -&gt;
get_message_type msg2 = PrepareBlock -&gt;
get_block msg1 &lt;&gt; get_block msg2 -&gt;
b_height (get_block msg1) = b_height (get_block msg2) -&gt;
honest_node n -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
~ In msg1 (counting_messages (fst (tr i) n)) -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkac"><span class="nb">intros</span> tr H_prot n i H_part msg1 msg2 H_sent1 H_sent2
    H_view H_type1 H_type2 H_neq H_height_eq H_false H_old2 H_new1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkad"><span class="nb">assert</span> (H_prot_copy := H_prot); 
    <span class="nb">destruct</span> H_prot <span class="kr">as</span> [_ H_prot];
    spec H_prot i;
    <span class="nb">destruct</span> H_prot <span class="kr">as</span> [[n0 [H_in0 [p0 [msg0 [lm0 [H_step H_deliver]]]]]] | H_timeout].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkae"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkaf"><span class="nb">assert</span> (n0 = n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n0 = n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkb0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkb0"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkb1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkb1"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkb2"><span class="nb">apply</span> counting_message_different_tells_receiver <span class="kr">with</span> tr i p0 msg0 lm0; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">counting_messages (fst (tr i) n) &lt;&gt;
counting_messages (fst (tr (S i)) n)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkb3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkb3"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkb4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkb4"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkb5"><span class="nb">intros</span> H_contra.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_contra</var><span class="hyp-type"><b>: </b><span>counting_messages (fst (tr i) n) =
counting_messages (fst (tr (S i)) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkb6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkb6"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkb7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkb7"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkb8"><span class="nb">rewrite</span> H_contra <span class="kr">in</span> H_new1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_contra</var><span class="hyp-type"><b>: </b><span>counting_messages (fst (tr i) n) =
counting_messages (fst (tr (S i)) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkb9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkb9"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkba"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkbb"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkbc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkbc"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkbd"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n) msg0
  (fst (tr (S i)) n) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkbe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkbe"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkbf"><span class="nb">assert</span> (H_step_copy := H_step);
  <span class="nb">destruct</span> p0;
  <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_update H_rest];
  <span class="nb">rewrite</span> H_update <span class="kr">in</span> H_sent1;
  <span class="c">(* In cases that do not process messages *)</span> 
  <span class="kp">try</span> <span class="bp">contradiction</span>;
  <span class="c">(* In cases where n is not honest *)</span> 
  <span class="kp">try</span> (<span class="nb">rewrite</span> (protocol_trace_state_sane H_prot_copy) <span class="kr">in</span> H_rest;
       <span class="bp">tauto</span>);
  <span class="kp">try</span> (<span class="nb">simpl</span> <span class="kr">in</span> H_sent1;
       <span class="nb">destruct</span> H_sent1 <span class="kr">as</span> [H_sent1 | H_sent1]);
  <span class="kp">try</span> <span class="bp">contradiction</span>;
  <span class="nb">subst</span>; 
  <span class="kp">try</span> (<span class="nb">rewrite</span> H_type1 <span class="kr">in</span> H_rest;
       <span class="bp">easy</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_pending_vote_type
  (fst (tr i) n) msg1 (fst (tr (S i)) n)
  lm0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg1 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg1 = PrepareBlock /\
view_valid (fst (tr i) n) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_PrepareBlock
  (fst (tr i) n) (get_block msg1) /\
~
prepare_stage (fst (tr i) n)
  (parent_of (get_block msg1))</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process (fst (tr i) n) msg1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_vote_type
  (fst (tr i) n) msg1 (fst (tr (S i)) n)
  lm0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg1 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg1 = PrepareBlock /\
view_valid (fst (tr i) n) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_PrepareBlock
  (fst (tr i) n) (get_block msg1) /\
~
prepare_stage (fst (tr i) n)
  (parent_of (get_block msg1))</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process (fst (tr i) n) msg1</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc0"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareBlock</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} = get_view msg2</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n)
                 msg0));
       get_piggyback_block :=
         GenesisBlock
     |}) = b_height (get_block msg2)</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} &lt;&gt; get_block msg2</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc1"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc2"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc3"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc4"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkc5">(<span class="nb">assert</span> (H_contra : ~ exists_same_height_PrepareBlock (fst (tr i) n) (get_block msg1)) <span class="bp">by</span> <span class="bp">tauto</span>;
       <span class="nb">apply</span> H_contra;
       <span class="kr">exists</span> <span class="nv">msg2</span>; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareBlock_vote_type
  (fst (tr i) n) msg1 (fst (tr (S i)) n)
  lm0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg1 /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg1 = PrepareBlock /\
view_valid (fst (tr i) n) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n) = false /\
~
exists_same_height_PrepareBlock
  (fst (tr i) n) (get_block msg1) /\
~
prepare_stage (fst (tr i) n)
  (parent_of (get_block msg1))</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
process (fst (tr i) n) msg1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareBlock</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} = get_view msg2</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n)
                 msg0));
       get_piggyback_block :=
         GenesisBlock
     |}) = b_height (get_block msg2)</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} &lt;&gt; get_block msg2</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc6"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc7"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc8"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkc9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkc9"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkca">(<span class="nb">assert</span> (H_contra : ~ exists_same_height_PrepareBlock (fst (tr i) n) (get_block msg1)) <span class="bp">by</span> <span class="bp">tauto</span>;
       <span class="nb">apply</span> H_contra;
       <span class="kr">exists</span> <span class="nv">msg2</span>; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareBlock</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} = get_view msg2</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n)
                 msg0));
       get_piggyback_block :=
         GenesisBlock
     |}) = b_height (get_block msg2)</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} &lt;&gt; get_block msg2</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkcb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkcb"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkcc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkcc"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkcd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkcd"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkce"><span class="nb">simpl</span> <span class="kr">in</span> H_type1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>PrepareQC = PrepareBlock</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} = get_view msg2</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n)
                 msg0));
       get_piggyback_block :=
         GenesisBlock
     |}) = b_height (get_block msg2)</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} &lt;&gt; get_block msg2</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkcf"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkd0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkd0"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkd1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkd1"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkd2"><span class="bp">discriminate</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkd3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkd3"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkd4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkd4"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkd5"><span class="nb">destruct</span> H_sent1 <span class="kr">as</span> [H_sent1 | H_sent1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkd6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkd6"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkd7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkd7"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkd8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkd8"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkd9"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg1 (fst (tr (S i)) n)
  lm0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg1));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg1))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg1)) /\
received (fst (tr i) n) msg1 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg1;
    get_sender := get_sender msg1;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg1));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg1 = ViewChange /\
view_valid (fst (tr i) n) msg1 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg1)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg1)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg1;
          get_sender := get_sender msg1;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg1));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg1));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg1))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg1)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkda" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkda"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkdb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkdb"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkdc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkdc"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkdd"><span class="nb">rewrite</span> H_type1 <span class="kr">in</span> H_rest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg1 (fst (tr (S i)) n)
  lm0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg1));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg1))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg1)) /\
received (fst (tr i) n) msg1 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg1;
    get_sender := get_sender msg1;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg1));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
PrepareBlock = ViewChange /\
view_valid (fst (tr i) n) msg1 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg1)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg1)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg1;
          get_sender := get_sender msg1;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg1));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg1));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg1))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg1)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkde" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkde"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkdf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkdf"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chke0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chke0"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chke1"><span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chke2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chke2"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chke3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chke3"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chke4"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chke5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chke5"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chke6"><span class="nb">destruct</span> H_sent1 <span class="kr">as</span> [H_sent1 | H_sent1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chke7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chke7"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chke8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chke8"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chke9"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} = PrepareBlock</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} = get_view msg2</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view :=
         node_view (fst (tr i) n);
       get_sender := get_sender msg0;
       get_block := get_block msg0;
       get_piggyback_block :=
         GenesisBlock
     |}) = b_height (get_block msg2)</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} &lt;&gt; get_block msg2</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkea" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkea"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkeb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkeb"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkec"><span class="nb">simpl</span> <span class="kr">in</span> H_type1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>PrepareQC = PrepareBlock</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} = get_view msg2</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view :=
         node_view (fst (tr i) n);
       get_sender := get_sender msg0;
       get_block := get_block msg0;
       get_piggyback_block :=
         GenesisBlock
     |}) = b_height (get_block msg2)</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} &lt;&gt; get_block msg2</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chked" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chked"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkee" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkee"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkef"><span class="bp">discriminate</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkf0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkf0"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf1"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf2"><span class="nb">rewrite</span> H_timeout <span class="kr">in</span> H_sent1; <span class="nb">simpl</span> <span class="kr">in</span> H_sent1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages
     (<span class="kr">if</span> is_member n participants
      <span class="kr">then</span> flip_timeout (fst (tr i) n)
      <span class="kr">else</span> fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf3"><span class="nb">apply</span> is_member_correct <span class="kr">in</span> H_part.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>is_member n participants = true</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages
     (<span class="kr">if</span> is_member n participants
      <span class="kr">then</span> flip_timeout (fst (tr i) n)
      <span class="kr">else</span> fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> H_part <span class="kr">in</span> H_sent1; <span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf4"><span class="kn">Lemma</span> <span class="nf">pre_local_evidence_of_equivocation_last_case</span> :
 <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace), protocol_trace tr -&gt;
 <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat), In n participants -&gt;
 <span class="kr">forall</span> (<span class="nv">msg1</span> <span class="nv">msg2</span> : message),
  In msg1 (counting_messages (fst (tr (S i)) n)) -&gt;
  In msg2 (counting_messages (fst (tr (S i)) n)) -&gt;
  get_view msg1 = get_view msg2 -&gt;
  get_message_type msg1 = PrepareBlock -&gt;
  get_message_type msg2 = PrepareBlock -&gt;
  get_block msg1 &lt;&gt; get_block msg2 -&gt;
  b_height (get_block msg1) = b_height (get_block msg2) -&gt;
  honest_node n -&gt;
  ~ In msg2 (counting_messages (fst (tr i) n)) -&gt;
  ~ In msg1 (counting_messages (fst (tr i) n)) -&gt;
  <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
<span class="kr">forall</span> <span class="nv">msg1</span> <span class="nv">msg2</span> : message,
In msg1 (counting_messages (fst (tr (S i)) n)) -&gt;
In msg2 (counting_messages (fst (tr (S i)) n)) -&gt;
get_view msg1 = get_view msg2 -&gt;
get_message_type msg1 = PrepareBlock -&gt;
get_message_type msg2 = PrepareBlock -&gt;
get_block msg1 &lt;&gt; get_block msg2 -&gt;
b_height (get_block msg1) = b_height (get_block msg2) -&gt;
honest_node n -&gt;
~ In msg2 (counting_messages (fst (tr i) n)) -&gt;
~ In msg1 (counting_messages (fst (tr i) n)) -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
<span class="kr">forall</span> <span class="nv">msg1</span> <span class="nv">msg2</span> : message,
In msg1 (counting_messages (fst (tr (S i)) n)) -&gt;
In msg2 (counting_messages (fst (tr (S i)) n)) -&gt;
get_view msg1 = get_view msg2 -&gt;
get_message_type msg1 = PrepareBlock -&gt;
get_message_type msg2 = PrepareBlock -&gt;
get_block msg1 &lt;&gt; get_block msg2 -&gt;
b_height (get_block msg1) = b_height (get_block msg2) -&gt;
honest_node n -&gt;
~ In msg2 (counting_messages (fst (tr i) n)) -&gt;
~ In msg1 (counting_messages (fst (tr i) n)) -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf6"><span class="nb">intros</span> tr H_prot n i H_part msg1 msg2 H_sent1 H_sent2 H_view
   H_type1 H_type2 H_neq H_height_eq H_false H_new2 H_new1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf7"><span class="nb">assert</span> (H_prot_copy := H_prot); 
    <span class="nb">destruct</span> H_prot <span class="kr">as</span> [_ H_prot];
    spec H_prot i;
    <span class="nb">destruct</span> H_prot <span class="kr">as</span> [[n0 [H_in0 [p0 [msg0 [lm0 [H_step H_deliver]]]]]] | H_timeout].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkf8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkf8"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkf9"><span class="nb">assert</span> (n0 = n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n0 = n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkfa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkfa"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkfb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkfb"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkfc"><span class="nb">apply</span> counting_message_different_tells_receiver <span class="kr">with</span> tr i p0 msg0 lm0; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">counting_messages (fst (tr i) n) &lt;&gt;
counting_messages (fst (tr (S i)) n)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkfd"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chkfe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chkfe"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chkff"><span class="nb">intros</span> H_contra.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_contra</var><span class="hyp-type"><b>: </b><span>counting_messages (fst (tr i) n) =
counting_messages (fst (tr (S i)) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk100" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk100"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk101" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk101"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk102"><span class="nb">rewrite</span> H_contra <span class="kr">in</span> H_new1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~
In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_contra</var><span class="hyp-type"><b>: </b><span>counting_messages (fst (tr i) n) =
counting_messages (fst (tr (S i)) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk103" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk103"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk104" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk104"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk105"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>n0 = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk106" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk106"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk107"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n) msg0
  (fst (tr (S i)) n) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk108" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk108"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk109"><span class="nb">assert</span> (H_step_copy := H_step);
    <span class="nb">destruct</span> p0;
    <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_update H_rest];
    <span class="nb">rewrite</span> H_update <span class="kr">in</span> H_sent1;
    <span class="nb">rewrite</span> H_update <span class="kr">in</span> H_sent2; 
    <span class="c">(* In cases that do not process messages *)</span> 
    <span class="kp">try</span> <span class="bp">contradiction</span>;
    <span class="c">(* In cases where n is not honest *)</span> 
    <span class="kp">try</span> (<span class="nb">rewrite</span> (protocol_trace_state_sane H_prot_copy) <span class="kr">in</span> H_rest;
         <span class="bp">tauto</span>);
    <span class="nb">simpl</span> <span class="kr">in</span> H_sent1, H_sent2; 
      <span class="nb">destruct</span> H_sent1 <span class="kr">as</span> [H_sent1 | H_sent1];
      <span class="nb">destruct</span> H_sent2 <span class="kr">as</span> [H_sent2 | H_sent2];
      <span class="kp">try</span> <span class="bp">contradiction</span>; 
      <span class="kp">try</span> (<span class="nb">rewrite</span> &lt;- H_sent1, &lt;- H_sent2 <span class="kr">in</span> H_neq; <span class="bp">easy</span>);
  <span class="kp">try</span> (<span class="nb">rewrite</span> &lt;- H_sent1 <span class="kr">in</span> H_type1; <span class="nb">simpl</span> <span class="kr">in</span> H_type1; <span class="bp">discriminate</span>);
  <span class="kp">try</span> (<span class="nb">rewrite</span> &lt;- H_sent2 <span class="kr">in</span> H_type2; <span class="nb">simpl</span> <span class="kr">in</span> H_type2; <span class="bp">discriminate</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk10a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk10a"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk10b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk10b"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk10c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk10c"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk10d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk10d"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk10e"><span class="nb">simpl</span> <span class="kr">in</span> H_sent1, H_sent2; 
      <span class="nb">destruct</span> H_sent1 <span class="kr">as</span> [H_sent1 | H_sent1];
      <span class="nb">destruct</span> H_sent2 <span class="kr">as</span> [H_sent2 | H_sent2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk10f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk10f"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk110" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk110"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk111" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk111"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk112" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk112"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk113" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk113"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk114" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk114"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk115" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk115"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk116"><span class="kp">try</span> (<span class="nb">rewrite</span> &lt;- H_sent1, &lt;- H_sent2 <span class="kr">in</span> H_neq; <span class="bp">easy</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk117" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk117"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk118" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk118"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk119" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk119"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk11a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk11a"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk11b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk11b"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk11c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk11c"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk11d"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk11e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk11e"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk11f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk11f"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk120" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk120"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk121" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk121"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk122" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk122"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk123"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
record_plural
  (increment_view
     (process (process (fst (tr i) n) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n);
     get_sender := node_id (fst (tr i) n);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n)
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n))
           (highest_ViewChange_message
              (process (fst (tr i) n) msg0)))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := node_id (fst (tr i) n);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n)
     (highest_ViewChange_message
        (process (fst (tr i) n) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n))
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0)) /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n) msg0)
  (node_view (fst (tr i) n)) /\
is_block_proposer (node_id (fst (tr i) n))
  (S (node_view (fst (tr i) n)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk124" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk124"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk125" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk125"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk126" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk126"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk127" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk127"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk128"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk129" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk129"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk12a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk12a"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk12b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk12b"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk12c"><span class="nb">destruct</span> H_sent2 <span class="kr">as</span> [H_sent2 | H_sent2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk12d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk12d"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk12e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk12e"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk12f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk12f"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk130" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk130"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk131"><span class="nb">rewrite</span> &lt;- H_sent2 <span class="kr">in</span> H_type2; <span class="nb">simpl</span> <span class="kr">in</span> H_type2; <span class="bp">discriminate</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk132" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk132"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk133" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk133"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk134" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk134"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk135"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk136" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk136"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk137" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk137"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk138"><span class="nb">destruct</span> H_sent1 <span class="kr">as</span> [H_sent1 | H_sent1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk139" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk139"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk13a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk13a"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk13b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk13b"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk13c">(<span class="nb">rewrite</span> &lt;- H_sent1 <span class="kr">in</span> H_type1; <span class="nb">simpl</span> <span class="kr">in</span> H_type1; <span class="bp">discriminate</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>msg0 = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk13d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk13d"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk13e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk13e"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk13f"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2 \/
In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk140" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk140"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk141"><span class="nb">destruct</span> H_sent2 <span class="kr">as</span> [H_sent2 | H_sent2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg2</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk142" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk142"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk143" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk143"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk144"><span class="kp">try</span> (<span class="nb">rewrite</span> &lt;- H_sent2 <span class="kr">in</span> H_type2; <span class="nb">simpl</span> <span class="kr">in</span> H_type2; <span class="bp">discriminate</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2, msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n);
  get_sender := get_sender msg0;
  get_block := get_block msg0;
  get_piggyback_block := GenesisBlock
|} = msg1 \/
In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n) (fst (tr (S i)) n) lm0</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n =
increment_view
  (process
     (process (fst (tr i) n)
        {|
          get_message_type := PrepareQC;
          get_view :=
            node_view (fst (tr i) n);
          get_sender := get_sender msg0;
          get_block := get_block msg0;
          get_piggyback_block :=
            GenesisBlock
        |}) msg0)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>lm0 = [] /\
received (fst (tr i) n) msg0 /\
received (fst (tr i) n)
  {|
    get_message_type := PrepareQC;
    get_view := node_view (fst (tr i) n);
    get_sender := get_sender msg0;
    get_block := get_block msg0;
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n)) /\
get_message_type msg0 = ViewChangeQC /\
view_valid (fst (tr i) n) msg0</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChangeQC_single_type
  (fst (tr i) n) msg0 (fst (tr (S i)) n)
  lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk145" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk145"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk146"><span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk147"><span class="nb">rewrite</span> H_timeout <span class="kr">in</span> H_sent1; <span class="nb">simpl</span> <span class="kr">in</span> H_sent1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages
     (<span class="kr">if</span> is_member n participants
      <span class="kr">then</span> flip_timeout (fst (tr i) n)
      <span class="kr">else</span> fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk148"><span class="nb">apply</span> is_member_correct <span class="kr">in</span> H_part.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>is_member n participants = true</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages
     (<span class="kr">if</span> is_member n participants
      <span class="kr">then</span> flip_timeout (fst (tr i) n)
      <span class="kr">else</span> fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> H_part <span class="kr">in</span> H_sent1; <span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Finally, we can show that evidence of "pre-equivocation" is sufficient
to show that a node is dishonest: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk149"><span class="kn">Lemma</span> <span class="nf">pre_local_evidence_of_equivocation</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
      In n participants -&gt;
      pre_equivocating_in_state (fst (tr i) n) -&gt;
      ~ honest_node n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
pre_equivocating_in_state (fst (tr i) n) -&gt;
~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk14a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
pre_equivocating_in_state (fst (tr i) n) -&gt;
~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk14b"><span class="nb">intros</span> tr H_prot n i H_part [msg1 [msg2 [H_sent1 [H_sent2
   [H_view [H_type1 [H_type2 [H_neq H_height_eq]]]]]]]] H_false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk14c"><span class="nb">induction</span> i <span class="kr">as</span> [|i IH_prot].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk14d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br></div><label class="goal-separator" for="prepare-v-chk14d"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk14e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk14f"><span class="nb">destruct</span> H_prot <span class="kr">as</span> [H_init _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_init</var><span class="hyp-type"><b>: </b><span>tr <span class="mi">0</span> = GState_init</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk150"><span class="nb">rewrite</span> H_init <span class="kr">in</span> H_sent1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_init</var><span class="hyp-type"><b>: </b><span>tr <span class="mi">0</span> = GState_init</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst GState_init n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr <span class="mi">0</span>) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> H_sent1.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk151">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk152"><span class="nb">destruct</span> (In_dec message_eq_dec msg2 (counting_messages (fst (tr i) n))) <span class="kr">as</span> [H_old2 | H_new2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk153" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk153"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk154">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk155"><span class="nb">destruct</span> (In_dec message_eq_dec msg1 (counting_messages (fst (tr i) n))) <span class="kr">as</span> [H_old1 | H_new1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_old1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk156" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk156"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk157">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_old1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> IH_prot.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk158">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk159"><span class="nb">clear</span> IH_prot.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_old2</var><span class="hyp-type"><b>: </b><span>In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> pre_local_evidence_of_equivocation_middle_case <span class="kr">with</span> tr n i msg1 msg2.</span><span class="alectryon-wsp">  
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk15a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk15b"><span class="nb">destruct</span> (In_dec message_eq_dec msg1 (counting_messages (fst (tr i) n))) <span class="kr">as</span> [H_old1 | H_new1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_old1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk15c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk15c"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk15d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_old1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk15e"><span class="nb">apply</span> pre_local_evidence_of_equivocation_middle_case <span class="kr">with</span> tr n i msg2 msg1; <span class="kp">try</span> <span class="bp">assumption</span>; <span class="kp">try</span> <span class="bp">easy</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_old1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_block msg2 &lt;&gt; get_block msg1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk15f"><span class="nb">intro</span> H_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_old1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_eq</var><span class="hyp-type"><b>: </b><span>get_block msg2 = get_block msg1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk160"><span class="nb">symmetry in</span> H_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_old1</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_eq</var><span class="hyp-type"><b>: </b><span>get_block msg1 = get_block msg2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk161">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n)) -&gt;
In msg2 (counting_messages (fst (tr i) n)) -&gt;
<span class="kt">False</span></span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk162"><span class="nb">clear</span> IH_prot.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (counting_messages (fst (tr (S i)) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg1 = get_view msg2</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareBlock</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareBlock</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>get_block msg1 &lt;&gt; get_block msg2</span></span></span><br><span><var>H_height_eq</var><span class="hyp-type"><b>: </b><span>b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br><span><var>H_false</var><span class="hyp-type"><b>: </b><span>honest_node n</span></span></span><br><span><var>H_new2</var><span class="hyp-type"><b>: </b><span>~ In msg2 (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_new1</var><span class="hyp-type"><b>: </b><span>~ In msg1 (counting_messages (fst (tr i) n))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> pre_local_evidence_of_equivocation_last_case <span class="kr">with</span> tr n i msg1 msg2.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
And therefore, we can prove dishonesty from equivocation by weakning the premise: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk163"><span class="kn">Lemma</span> <span class="nf">local_evidence_of_equivocation</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
    In n participants -&gt;
    equivocating_in_state (fst (tr i) n) -&gt;
    ~ honest_node n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
equivocating_in_state (fst (tr i) n) -&gt;
~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk164"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
equivocating_in_state (fst (tr i) n) -&gt;
~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk165"><span class="nb">intros</span> tr H_prot n i H_part H_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_equiv</var><span class="hyp-type"><b>: </b><span>equivocating_in_state (fst (tr i) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk166"><span class="nb">apply</span> pre_local_means_local_evidence_of_equivocation <span class="kr">in</span> H_equiv; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_equiv</var><span class="hyp-type"><b>: </b><span>pre_equivocating_in_state (fst (tr i) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> pre_local_evidence_of_equivocation <span class="kr">with</span> tr i.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Continuing to identify conditions from the bottom up, we have established that
in order to show that more than 1/3 participating nodes are dishonest, we must show
that more than 1/3 participating nodes show local evidence of malice. In order to
show local evidence of malice, it suffices to show global evidence of malice. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Global evidence of malice. 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equivocating_in_global_state</span> (<span class="nv">s</span> : GState) (<span class="nv">n</span> : node) := 
  <span class="kr">exists</span> <span class="nv">msg1</span> <span class="nv">msg2</span> : message,
    In msg1 (snd s) /\
    In msg2 (snd s) /\
    get_sender msg1 = n /\
    get_sender msg2 = n /\ 
    get_view msg1 = get_view msg2 /\
    get_message_type msg1 = PrepareVote /\
    get_message_type msg2 = PrepareVote /\
    get_block msg1 &lt;&gt; get_block msg2 /\
    b_height (get_block msg1) = b_height (get_block msg2).</span></span></pre><div class="doc">
Proving that global evidence of malice is indeed a sufficient condition
for local evidence of malice: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk167"><span class="kn">Lemma</span> <span class="nf">global_equivocating_local</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
      In n participants -&gt;
      equivocating_in_global_state (tr i) n -&gt;
      equivocating_in_state (fst (tr i) n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
equivocating_in_global_state (tr i) n -&gt;
equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk168"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">n</span> : node) (<span class="nv">i</span> : nat),
In n participants -&gt;
equivocating_in_global_state (tr i) n -&gt;
equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">   
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk169"><span class="nb">intros</span> tr H_prot n i H_part H_global.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk16a"><span class="nb">destruct</span> H_global <span class="kr">as</span> [msg1 [msg2 H_global]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg1, msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i)) /\
In msg2 (snd (tr i)) /\
get_sender msg1 = n /\
get_sender msg2 = n /\
get_view msg1 = get_view msg2 /\
get_message_type msg1 = PrepareVote /\
get_message_type msg2 = PrepareVote /\
get_block msg1 &lt;&gt; get_block msg2 /\
b_height (get_block msg1) =
b_height (get_block msg2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">msg1</span>, msg2; <span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>;
    <span class="kp">try</span> 
      (<span class="nb">apply</span> global_local_out_if; <span class="kp">try</span> <span class="bp">assumption</span>;
       <span class="nb">apply</span> filter_In; <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>;
       <span class="nb">apply</span> node_eqb_correct; <span class="bp">tauto</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
We identify yet another sufficient condition for global evidence of malice:
there exist two vote quorums for b1 and b2 in the global broadcast message buffer.
We show that this is indeed a sufficient condition by completing the following
chain of reasoning:
<ul class="doclist">
<li> we have two global vote quorums, which implies

</li>
<li> more than one third global evidence of malice, which implies

</li>
<li> more than one third local evidence of malice, which implies

</li>
<li> more than one third of nodes are dishonest. 

</li>
</ul>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk16b"><span class="kn">Lemma</span> <span class="nf">vote_quorum_same_view_global_injective</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">b1</span> <span class="nv">b2</span> : block) (<span class="nv">p</span> : nat),
      b1 &lt;&gt; b2 -&gt;
      vote_quorum_in_view_global tr i b1 p -&gt; 
      vote_quorum_in_view_global tr i b2 p -&gt;      
      b_height b1 = b_height b2 -&gt;
      <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">b1</span> <span class="nv">b2</span> : block) (<span class="nv">p</span> : nat),
b1 &lt;&gt; b2 -&gt;
vote_quorum_in_view_global tr i b1 p -&gt;
vote_quorum_in_view_global tr i b2 p -&gt;
b_height b1 = b_height b2 -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk16c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">b1</span> <span class="nv">b2</span> : block) (<span class="nv">p</span> : nat),
b1 &lt;&gt; b2 -&gt;
vote_quorum_in_view_global tr i b1 p -&gt;
vote_quorum_in_view_global tr i b2 p -&gt;
b_height b1 = b_height b2 -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk16d"><span class="nb">intros</span> tr H_prot i b1 b2 p H_neq H_prepare1 H_prepare2 H_height.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b2 p</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk16e"><span class="nb">red</span> <span class="kr">in</span> H_prepare1, H_prepare2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>quorum
  (PrepareVote_about_block_in_view_global
     tr i b1 p)</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>quorum
  (PrepareVote_about_block_in_view_global
     tr i b2 p)</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">  
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk16f"><span class="nb">assert</span> (H_useful := intersection_property).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>quorum
  (PrepareVote_about_block_in_view_global
     tr i b1 p)</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>quorum
  (PrepareVote_about_block_in_view_global
     tr i b2 p)</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : list node,
has_at_least_two_thirds l1 -&gt;
has_at_least_two_thirds l2 -&gt;
<span class="kr">exists</span> <span class="nv">l</span> : list node,
  has_at_least_one_third l /\
  (<span class="kr">forall</span> <span class="nv">n</span> : node,
   In n l -&gt; In n l1 /\ In n l2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk170"><span class="nb">unfold</span> quorum <span class="kr">in</span> H_prepare1, H_prepare2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">l1</span> <span class="nv">l2</span> : list node,
has_at_least_two_thirds l1 -&gt;
has_at_least_two_thirds l2 -&gt;
<span class="kr">exists</span> <span class="nv">l</span> : list node,
  has_at_least_one_third l /\
  (<span class="kr">forall</span> <span class="nv">n</span> : node,
   In n l -&gt; In n l1 /\ In n l2)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk171">spec H_useful (map get_sender (PrepareVote_about_block_in_view_global tr i b1 p))
    (map get_sender (PrepareVote_about_block_in_view_global tr i b2 p)) H_prepare1 H_prepare2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">l</span> : list node,
  has_at_least_one_third l /\
  (<span class="kr">forall</span> <span class="nv">n</span> : node,
   In n l -&gt;
   In n
     (map get_sender
        (PrepareVote_about_block_in_view_global
           tr i b1 p)) /\
   In n
     (map get_sender
        (PrepareVote_about_block_in_view_global
           tr i b2 p)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk172"><span class="nb">destruct</span> H_useful <span class="kr">as</span> [l_inter [H_inter H_subset]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* All overlapping nodes are participants *)</span> 
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk173"><span class="nb">assert</span> (H_part : <span class="kr">forall</span> <span class="nv">n</span>, In n l_inter -&gt; In n participants).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node, In n l_inter -&gt; In n participants</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk174" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk174"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk175">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node, In n l_inter -&gt; In n participants</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk176"><span class="nb">intros</span> n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk177">spec H_subset n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk178"><span class="nb">destruct</span> H_subset <span class="kr">as</span> [H _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global tr i
        b1 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk179"><span class="nb">apply</span> in_map_iff <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">x</span> : message,
  get_sender x = n /\
  In x
    (PrepareVote_about_block_in_view_global tr i
       b1 p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk17a"><span class="nb">destruct</span> H <span class="kr">as</span> [msg [H_sender H_global]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender</var><span class="hyp-type"><b>: </b><span>get_sender msg = n</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>In msg
  (PrepareVote_about_block_in_view_global
     tr i b1 p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk17b"><span class="nb">apply</span> filter_In <span class="kr">in</span> H_global.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender</var><span class="hyp-type"><b>: </b><span>get_sender msg = n</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk17c"><span class="nb">rewrite</span> &lt;- H_sender.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender</var><span class="hyp-type"><b>: </b><span>get_sender msg = n</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In (get_sender msg) participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> participation_rights_global <span class="kr">with</span> tr i; <span class="kp">try</span> <span class="bp">tauto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk17d">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* All overlapping nodes are equivocating in global state *)</span> 
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk17e"><span class="nb">assert</span> (H_step1 : <span class="kr">forall</span> <span class="nv">n</span>, In n l_inter -&gt; equivocating_in_global_state (tr i) n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; equivocating_in_global_state (tr i) n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk17f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk17f"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk180">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk181"><span class="nb">intros</span> n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk182">spec H_subset n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk183"><span class="nb">destruct</span> H_subset <span class="kr">as</span> [H_in1 H_in2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_in1</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_in2</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk184"><span class="nb">apply</span> in_map_iff <span class="kr">in</span> H_in1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_in1</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">x</span> : message,
  get_sender x = n /\
  In x
    (PrepareVote_about_block_in_view_global tr
       i b1 p)</span></span></span><br><span><var>H_in2</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk185"><span class="nb">destruct</span> H_in1 <span class="kr">as</span> [msg1 [H_sender1  H_sent1]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (PrepareVote_about_block_in_view_global tr
     i b1 p)</span></span></span><br><span><var>H_in2</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk186"><span class="nb">apply</span> in_map_iff <span class="kr">in</span> H_in2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (PrepareVote_about_block_in_view_global tr
     i b1 p)</span></span></span><br><span><var>H_in2</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">x</span> : message,
  get_sender x = n /\
  In x
    (PrepareVote_about_block_in_view_global tr
       i b2 p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk187"><span class="nb">destruct</span> H_in2 <span class="kr">as</span> [msg2 [H_sender2 H_sent2]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1
  (PrepareVote_about_block_in_view_global tr
     i b1 p)</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2
  (PrepareVote_about_block_in_view_global tr
     i b2 p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk188"><span class="nb">apply</span> filter_In <span class="kr">in</span> H_sent1;  
      <span class="nb">apply</span> filter_In <span class="kr">in</span> H_sent2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i)) /\
message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) b1 &amp;&amp;
(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i)) /\
message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 &amp;&amp;
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk189"><span class="nb">destruct</span> H_sent1 <span class="kr">as</span> [H_sent1 H_rest1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_rest1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) b1 &amp;&amp;
(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i)) /\
message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 &amp;&amp;
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk18a"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_rest1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_rest1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) b1 = true /\
(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i)) /\
message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 &amp;&amp;
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk18b"><span class="nb">destruct</span> H_rest1 <span class="kr">as</span> [H_type1 H_view1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i)) /\
message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 &amp;&amp;
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk18c"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_type1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true /\
block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i)) /\
message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 &amp;&amp;
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk18d"><span class="nb">destruct</span> H_type1 <span class="kr">as</span> [H_type1 H_block1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i)) /\
message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 &amp;&amp;
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk18e"><span class="nb">destruct</span> H_sent2 <span class="kr">as</span> [H_sent2 H_rest2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_rest2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 &amp;&amp;
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk18f"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_rest2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_rest2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 = true /\
(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk190"><span class="nb">destruct</span> H_rest2 <span class="kr">as</span> [H_type2 H_view2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote &amp;&amp;
block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk191"><span class="nb">apply</span> andb_prop <span class="kr">in</span> H_type2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote = true /\
block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk192"><span class="nb">destruct</span> H_type2 <span class="kr">as</span> [H_type2 H_block2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>(get_view msg1 =? p) = true</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote = true</span></span></span><br><span><var>H_block2</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk193"><span class="nb">apply</span> Nat.eqb_eq <span class="kr">in</span> H_view1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>get_view msg1 = p</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote = true</span></span></span><br><span><var>H_block2</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>(get_view msg2 =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk194"><span class="nb">apply</span> Nat.eqb_eq <span class="kr">in</span> H_view2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote = true</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>get_view msg1 = p</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote = true</span></span></span><br><span><var>H_block2</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>get_view msg2 = p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk195"><span class="nb">apply</span> message_type_eqb_correct <span class="kr">in</span> H_type1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>get_view msg1 = p</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg2)
  PrepareVote = true</span></span></span><br><span><var>H_block2</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>get_view msg2 = p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk196"><span class="nb">apply</span> message_type_eqb_correct <span class="kr">in</span> H_type2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg1) b1 = true</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>get_view msg1 = p</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_block2</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>get_view msg2 = p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk197"><span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> H_block1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>get_block msg1 = b1</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>get_view msg1 = p</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_block2</var><span class="hyp-type"><b>: </b><span>block_eqb (get_block msg2) b2 = true</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>get_view msg2 = p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk198"><span class="nb">apply</span> block_eqb_correct <span class="kr">in</span> H_block2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender1</var><span class="hyp-type"><b>: </b><span>get_sender msg1 = n</span></span></span><br><span><var>H_sent1</var><span class="hyp-type"><b>: </b><span>In msg1 (snd (tr i))</span></span></span><br><span><var>H_type1</var><span class="hyp-type"><b>: </b><span>get_message_type msg1 = PrepareVote</span></span></span><br><span><var>H_block1</var><span class="hyp-type"><b>: </b><span>get_block msg1 = b1</span></span></span><br><span><var>H_view1</var><span class="hyp-type"><b>: </b><span>get_view msg1 = p</span></span></span><br><span><var>msg2</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender2</var><span class="hyp-type"><b>: </b><span>get_sender msg2 = n</span></span></span><br><span><var>H_sent2</var><span class="hyp-type"><b>: </b><span>In msg2 (snd (tr i))</span></span></span><br><span><var>H_type2</var><span class="hyp-type"><b>: </b><span>get_message_type msg2 = PrepareVote</span></span></span><br><span><var>H_block2</var><span class="hyp-type"><b>: </b><span>get_block msg2 = b2</span></span></span><br><span><var>H_view2</var><span class="hyp-type"><b>: </b><span>get_view msg2 = p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_global_state (tr i) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">msg1</span>, msg2; <span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">tauto</span>; <span class="kp">try</span> (<span class="nb">subst</span>; <span class="bp">easy</span>).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk199">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* All overlapping nodes are equivocating in their local state *)</span> 
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk19a"><span class="nb">assert</span> (H_step2 : <span class="kr">forall</span> <span class="nv">n</span>, In n l_inter -&gt; equivocating_in_state (fst (tr i) n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; equivocating_in_state (fst (tr i) n)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk19b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk19b"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk19c">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk19d"><span class="nb">intros</span> n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk19e">spec H_step1 n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">equivocating_in_state (fst (tr i) n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk19f"><span class="nb">apply</span> global_equivocating_local; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a0">spec H_subset n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a1"><span class="nb">destruct</span> H_subset <span class="kr">as</span> [H _].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In n
  (map get_sender
     (PrepareVote_about_block_in_view_global tr i
        b1 p))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a2"><span class="nb">apply</span> in_map_iff <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">x</span> : message,
  get_sender x = n /\
  In x
    (PrepareVote_about_block_in_view_global tr i
       b1 p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a3"><span class="nb">destruct</span> H <span class="kr">as</span> [msg [H_sender H_global]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender</var><span class="hyp-type"><b>: </b><span>get_sender msg = n</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>In msg
  (PrepareVote_about_block_in_view_global
     tr i b1 p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a4"><span class="nb">apply</span> filter_In <span class="kr">in</span> H_global.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender</var><span class="hyp-type"><b>: </b><span>get_sender msg = n</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a5"><span class="nb">rewrite</span> &lt;- H_sender.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span>equivocating_in_global_state (tr i) n</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_sender</var><span class="hyp-type"><b>: </b><span>get_sender msg = n</span></span></span><br><span><var>H_global</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In (get_sender msg) participants</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> participation_rights_global <span class="kr">with</span> tr i; <span class="kp">try</span> <span class="bp">tauto</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a6">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* All nodes equivocating in their local state are malicious *)</span> 
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a7"><span class="nb">assert</span> (H_step3 : <span class="kr">forall</span> <span class="nv">n</span>, In n l_inter -&gt; ~ honest_node n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node, In n l_inter -&gt; ~ honest_node n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1a8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1a8"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1a9">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node, In n l_inter -&gt; ~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1aa"><span class="nb">intros</span> n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ab">spec H_part n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ac">spec H_step2 n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span>equivocating_in_state (fst (tr i) n)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ honest_node n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> local_evidence_of_equivocation <span class="kr">with</span> tr i.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ad">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ae"><span class="nb">apply</span> evil_participants.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">has_at_least_one_third
  (filter (<span class="kr">fun</span> <span class="nv">n</span> : node =&gt; negb (honest_nodeb n))
     participants)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1af"><span class="nb">apply</span> minority_subset <span class="kr">with</span> l_inter; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (filter (<span class="kr">fun</span> <span class="nv">n0</span> : node =&gt; negb (honest_nodeb n0))
     participants)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b0"><span class="nb">intros</span> n H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n
  (filter (<span class="kr">fun</span> <span class="nv">n</span> : node =&gt; negb (honest_nodeb n))
     participants)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b1"><span class="nb">apply</span> filter_In.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants /\ negb (honest_nodeb n) = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b2"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In n participants</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1b3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1b3"><hr></label><div class="goal-conclusion">negb (honest_nodeb n) = true</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b4"><span class="bp">now</span> <span class="nb">apply</span> H_part.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">negb (honest_nodeb n) = true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b5"><span class="nb">apply</span> negb_true_iff.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In n l_inter</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">honest_nodeb n = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b6"><span class="nb">apply</span> H_step3 <span class="kr">in</span> H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>~ honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">honest_nodeb n = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b7"><span class="nb">case_eq</span> (honest_nodeb n); <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>~ honest_node n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">honest_nodeb n = true -&gt; true = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b8"><span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p))</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>has_at_least_two_thirds
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br><span><var>l_inter</var><span class="hyp-type"><b>: </b><span>list node</span></span></span><br><span><var>H_inter</var><span class="hyp-type"><b>: </b><span>has_at_least_one_third l_inter</span></span></span><br><span><var>H_subset</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b1 p)) /\
In n
  (map get_sender
     (PrepareVote_about_block_in_view_global
        tr i b2 p))</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; In n participants</span></span></span><br><span><var>H_step1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_global_state (tr i) n</span></span></span><br><span><var>H_step2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt;
equivocating_in_state (fst (tr i) n)</span></span></span><br><span><var>H_step3</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : node,
In n l_inter -&gt; ~ honest_node n</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>~ honest_node n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>honest_nodeb n = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> honest_nodeb_correct <span class="kr">in</span> H; <span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
Finally, we close the gap from the top down direction by showing that from
our node-local <code>prepare_stage_in_view</code> assumption, we can prove the existence
of vote quorum in the global broadcast message buffer. There are two cases 
of <code>prepare_stage_in_view</code>, either a vote quorum in the local processed
message buffer, or a PrepareQC message in the local processed message buffer.
We show the first case: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1b9"><span class="kn">Lemma</span> <span class="nf">vote_quorum_local_means_vote_quorum_global</span> :
  <span class="kr">forall</span> <span class="nv">tr</span>,
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">n</span> : node) (<span class="nv">b1</span> : block) (<span class="nv">p</span> : nat),
      In n participants -&gt;
      vote_quorum_in_view (fst (tr i) n) p b1 -&gt;
      vote_quorum_in_view_global tr i b1 p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">n</span> : node) (<span class="nv">b1</span> : block) (<span class="nv">p</span> : nat),
In n participants -&gt;
vote_quorum_in_view (fst (tr i) n) p b1 -&gt;
vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ba"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">n</span> : node) (<span class="nv">b1</span> : block) (<span class="nv">p</span> : nat),
In n participants -&gt;
vote_quorum_in_view (fst (tr i) n) p b1 -&gt;
vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1bb"><span class="nb">intros</span> tr H_prot i n b1 p H_part H_local.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) n) p b1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1bc"><span class="nb">red</span> <span class="kr">in</span> H_local.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1bd"><span class="nb">apply</span> quorum_subset <span class="kr">with</span>
      (processed_PrepareVote_in_view_about_block (fst (tr i) n) p b1);
    <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1) -&gt;
In msg
  (PrepareVote_about_block_in_view_global tr i b1 p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1be"><span class="nb">intros</span> msg H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg
  (PrepareVote_about_block_in_view_global tr i b1 p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1bf"><span class="nb">apply</span> filter_In; 
  <span class="nb">apply</span> filter_In <span class="kr">in</span> H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages (fst (tr i) n)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c0"><span class="nb">destruct</span> H_in <span class="kr">as</span> [H_in H_typeblockview].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_typeblockview</var><span class="hyp-type"><b>: </b><span>message_type_eqb
  (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c1"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_typeblockview</var><span class="hyp-type"><b>: </b><span>message_type_eqb
  (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (snd (tr i))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1c2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_typeblockview</var><span class="hyp-type"><b>: </b><span>message_type_eqb
  (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1c2"><hr></label><div class="goal-conclusion">message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c3"><span class="nb">apply</span> processed_means_sent_global <span class="kr">with</span> n; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (fst (tr i) n) p b1)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_typeblockview</var><span class="hyp-type"><b>: </b><span>message_type_eqb
  (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b1 &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c4"><span class="kn">Lemma</span> <span class="nf">vote_quorum_in_view_step_global</span> :
  <span class="kr">forall</span> <span class="nv">tr</span> <span class="nv">i</span> <span class="nv">b</span> <span class="nv">p</span>,
    protocol_trace tr -&gt;
    vote_quorum_in_view_global tr i b p -&gt; 
    vote_quorum_in_view_global tr (S i) b p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">tr</span> : GTrace) (<span class="nv">i</span> : nat) (<span class="nv">b</span> : block) (<span class="nv">p</span> : nat),
protocol_trace tr -&gt;
vote_quorum_in_view_global tr i b p -&gt;
vote_quorum_in_view_global tr (S i) b p</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">tr</span> : GTrace) (<span class="nv">i</span> : nat) (<span class="nv">b</span> : block) (<span class="nv">p</span> : nat),
protocol_trace tr -&gt;
vote_quorum_in_view_global tr i b p -&gt;
vote_quorum_in_view_global tr (S i) b p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c6"><span class="nb">intros</span> tr i b p H_prot H_prepare.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr (S i) b p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c7"><span class="nb">red</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">quorum
  (PrepareVote_about_block_in_view_global tr (S i) b p)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1c8"><span class="nb">apply</span> quorum_subset <span class="kr">with</span> (PrepareVote_about_block_in_view_global tr i b p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">quorum
  (PrepareVote_about_block_in_view_global tr i b p)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1c9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1c9"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (PrepareVote_about_block_in_view_global tr i b p) -&gt;
In msg
  (PrepareVote_about_block_in_view_global tr (S i) b p)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ca"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (PrepareVote_about_block_in_view_global tr i b p) -&gt;
In msg
  (PrepareVote_about_block_in_view_global tr (S i) b p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1cb"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg
  (PrepareVote_about_block_in_view_global tr i b p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg
  (PrepareVote_about_block_in_view_global tr (S i) b p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1cc"><span class="nb">apply</span> filter_In <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg
  (PrepareVote_about_block_in_view_global tr (S i) b p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1cd"><span class="nb">apply</span> filter_In.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (snd (tr (S i))) /\
message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ce"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (snd (tr (S i)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1cf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1cf"><hr></label><div class="goal-conclusion">message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d0"><span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (snd (tr (S i)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1d1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1d1"><hr></label><div class="goal-conclusion">message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d2"><span class="bp">now</span> <span class="nb">apply</span> global_messages_monotonic_step.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_prepare</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b p</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) /\
message_type_eqb (get_message_type msg)
  PrepareVote &amp;&amp; block_eqb (get_block msg) b &amp;&amp;
(get_view msg =? p) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">message_type_eqb (get_message_type msg) PrepareVote &amp;&amp;
block_eqb (get_block msg) b &amp;&amp; 
(get_view msg =? p) = true</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">tauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d3"><span class="kn">Lemma</span> <span class="nf">witnessed_quorum_global</span> :
  <span class="kr">forall</span> (<span class="nv">tr</span> : GTrace),
    protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
      In msg (snd (tr i)) -&gt;
      get_message_type msg = PrepareQC -&gt;
      vote_quorum_in_view_global tr i (get_block msg) (get_view msg).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i (get_block msg)
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i (get_block msg)
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">         
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d5"><span class="nb">intros</span> tr H_prot i; 
    <span class="nb">induction</span> i <span class="kr">as</span> [|i IH_prot];
    <span class="nb">intros</span> msg H_in H_type.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr <span class="mi">0</span>))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr <span class="mi">0</span> (get_block msg)
  (get_view msg)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1d6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1d6"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr <span class="mi">0</span>))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr <span class="mi">0</span> 
  (get_block msg) (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> H_prot <span class="kr">as</span> [H_init _];
      <span class="nb">rewrite</span> H_init <span class="kr">in</span> H_in;
      <span class="nb">inversion</span> H_in.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1d9"><span class="nb">destruct</span> (In_dec message_eq_dec msg (snd (tr i))) <span class="kr">as</span> [H_old | H_new].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1da" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1da"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1db">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1dc"><span class="nb">apply</span> vote_quorum_in_view_global_step;
         <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_old</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i 
  (get_block msg) (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> IH_prot.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">     </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1dd">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1de"><span class="nb">assert</span> (H_prot_copy := H_prot); 
         <span class="nb">destruct</span> H_prot <span class="kr">as</span> [_ H_prot];
         spec H_prot i;
         <span class="nb">destruct</span> H_prot <span class="kr">as</span> [[n0 [H_in0 [p0 [msg0 [lm0 [H_step H_deliver]]]]]] | H_timeout].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1df" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1df"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1e0">* <span class="c">(* In the normal transition case *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1e1"><span class="nb">assert</span> (H_in_copy := H_in); 
           <span class="nb">rewrite</span> H_deliver <span class="kr">in</span> H_in; 
           <span class="nb">simpl</span> <span class="kr">in</span> H_in;
           <span class="nb">rewrite</span> in_app_iff <span class="kr">in</span> H_in;
           <span class="nb">destruct</span> H_in <span class="kr">as</span> [H_in | H_in];
           <span class="kp">try</span> <span class="bp">contradiction</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg lm0</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>p0</var><span class="hyp-type"><b>: </b><span>NState_transition_type</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_step</var><span class="hyp-type"><b>: </b><span>get_transition p0 (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1e2"><span class="nb">assert</span> (H_step_copy := H_step);
           <span class="nb">destruct</span> p0;
           <span class="nb">destruct</span> H_step <span class="kr">as</span> [H_update [H_out H_rest]];
           <span class="nb">rewrite</span> H_out <span class="kr">in</span> H_in; 
           <span class="c">(* For all cases that do not send messages *)</span> 
           <span class="kp">try</span> (<span class="nb">simpl</span> <span class="kr">in</span> H_in;
                <span class="bp">contradiction</span>);
           <span class="c">(* For all cases that send messages of the wrong type *)</span> 
           <span class="kp">try</span> (<span class="nb">apply</span> make_PrepareBlocks_message_type <span class="kr">in</span> H_in;
                <span class="nb">rewrite</span> H_in <span class="kr">in</span> H_type; <span class="bp">discriminate</span>);
           <span class="nb">simpl</span> <span class="kr">in</span> H_in;
           <span class="kp">repeat</span> <span class="nb">destruct</span> H_in <span class="kr">as</span> [H_in | H_in];
           <span class="kp">try</span> <span class="bp">contradiction</span>;
           <span class="kp">try</span> (<span class="nb">apply</span> pending_PrepareVote_correct <span class="kr">in</span> H_in;
                <span class="nb">rewrite</span> H_type <span class="kr">in</span> H_in;
                <span class="bp">easy</span>);
           <span class="kp">try</span> (<span class="nb">rewrite</span> &lt;- H_in <span class="kr">in</span> H_type;
                <span class="nb">simpl</span> <span class="kr">in</span> H_type;
                <span class="bp">discriminate</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1e3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1e3"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         <span class="c">(* In the three cases that actually do send PrepareQC messages *)</span> 
</span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1e4">**  <span class="c">(* In the PrepareVote vote case *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1e5"><span class="nb">assert</span> (H_if : vote_quorum_in_view (fst (tr (S i)) n0) (get_view msg0) (get_block msg0)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1e6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1e6"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1e7"><span class="nb">assert</span> (H_extract : vote_quorum_in_view (process (fst (tr i) n0) msg0)
             (get_view msg0) (get_block msg0)) <span class="bp">by</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1e8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1e8"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1e9"><span class="nb">rewrite</span> H_update.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view
  (process
     (record_plural (fst (tr i) n0)
        (make_PrepareQC (fst (tr i) n0) msg0
         :: pending_PrepareVote (fst (tr i) n0) msg0))
     msg0) (get_view msg0) 
  (get_block msg0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1ea" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1ea"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1eb"><span class="nb">red</span> <span class="kr">in</span> H_extract.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view
  (process
     (record_plural (fst (tr i) n0)
        (make_PrepareQC (fst (tr i) n0) msg0
         :: pending_PrepareVote (fst (tr i) n0) msg0))
     msg0) (get_view msg0) 
  (get_block msg0)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1ec" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1ec"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1ed"><span class="nb">apply</span> quorum_subset <span class="kr">with</span>
            (processed_PrepareVote_in_view_about_block (process (fst (tr i) n0) msg0)
            (get_view msg0) (get_block msg0)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0) 
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1ee" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1ee"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0) 
     (get_view msg0) (get_block msg0)) -&gt;
In msg
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1ef" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1ef"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1f0"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0) 
     (get_view msg0) (get_block msg0)) -&gt;
In msg
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1f1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1f1"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1f2"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg1
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1f3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1f3"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1f4"><span class="nb">apply</span> filter_In <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages
     (process (fst (tr i) n0) msg0)) /\
message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1f5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1f5"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1f6"><span class="nb">destruct</span> H <span class="kr">as</span> [H_in&#39; H_rest&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1
  (counting_messages
     (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1f7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1f7"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1f8"><span class="nb">simpl</span> <span class="kr">in</span> H_in&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1f9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1f9"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1fa"><span class="nb">destruct</span> H_in&#39; <span class="kr">as</span> [H_in&#39; | H_in&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>msg0 = msg1</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1fb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1fb"><hr></label><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1fc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1fc"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk1fd"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type
  (make_PrepareQC (fst (tr i) n0) msg1) =
PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~
In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg1)
     (get_view msg1) (get_block msg1))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg1
  (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr (S i)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote 
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg1 /\
get_message_type msg1 = PrepareVote /\
view_valid (fst (tr i) n0) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg1) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg1)
  (get_view msg1) (get_block msg1)</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg1
      :: pending_PrepareVote
           (fst (tr i) n0) msg1)) msg1</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg1
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg1)) msg1)
     (get_view msg1) (get_block msg1))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1fe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1fe"><hr></label><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk1ff" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk1ff"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk200"><span class="nb">apply</span> filter_In.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type
  (make_PrepareQC (fst (tr i) n0) msg1) =
PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~
In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg1)
     (get_view msg1) (get_block msg1))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg1
  (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr (S i)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote 
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg1 /\
get_message_type msg1 = PrepareVote /\
view_valid (fst (tr i) n0) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg1) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg1)
  (get_view msg1) (get_block msg1)</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg1
      :: pending_PrepareVote
           (fst (tr i) n0) msg1)) msg1</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (counting_messages
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg1
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg1)) msg1)) /\
message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk201" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk201"><hr></label><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk202" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk202"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk203"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type
  (make_PrepareQC (fst (tr i) n0) msg1) =
PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~
In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg1)
     (get_view msg1) (get_block msg1))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg1
  (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr (S i)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote 
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg1 /\
get_message_type msg1 = PrepareVote /\
view_valid (fst (tr i) n0) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg1) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg1)
  (get_view msg1) (get_block msg1)</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg1
      :: pending_PrepareVote
           (fst (tr i) n0) msg1)) msg1</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(msg1 = msg1 \/
 In msg1 (counting_messages (fst (tr i) n0))) /\
message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk204" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk204"><hr></label><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk205" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk205"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk206"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type
  (make_PrepareQC (fst (tr i) n0) msg1) =
PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~
In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg1)
     (get_view msg1) (get_block msg1))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg1
  (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr (S i)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote 
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg1 /\
get_message_type msg1 = PrepareVote /\
view_valid (fst (tr i) n0) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg1) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg1)
  (get_view msg1) (get_block msg1)</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg1
      :: pending_PrepareVote
           (fst (tr i) n0) msg1)) msg1</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg1 = msg1 \/
In msg1 (counting_messages (fst (tr i) n0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk207" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type
  (make_PrepareQC (fst (tr i) n0) msg1) =
PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~
In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg1)
     (get_view msg1) (get_block msg1))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg1
  (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr (S i)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote 
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg1 /\
get_message_type msg1 = PrepareVote /\
view_valid (fst (tr i) n0) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg1) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg1)
  (get_view msg1) (get_block msg1)</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg1
      :: pending_PrepareVote
           (fst (tr i) n0) msg1)) msg1</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk207"><hr></label><div class="goal-conclusion">message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk208" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk208"><hr></label><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk209" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk209"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk20a"><span class="nb">left</span>; <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type
  (make_PrepareQC (fst (tr i) n0) msg1) =
PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~
In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg1)
     (get_view msg1) (get_block msg1))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg1
  (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In (make_PrepareQC (fst (tr i) n0) msg1)
  (snd (tr (S i)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0)
  (make_PrepareQC (fst (tr i) n0) msg1
   :: pending_PrepareVote 
        (fst (tr i) n0) msg1)</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg1 /\
get_message_type msg1 = PrepareVote /\
view_valid (fst (tr i) n0) msg1 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg1) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg1)
  (get_view msg1) (get_block msg1)</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg1
      :: pending_PrepareVote
           (fst (tr i) n0) msg1)) msg1</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg1) &amp;&amp;
(get_view msg1 =? get_view msg1) = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk20b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk20b"><hr></label><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk20c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk20c"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk20d"><span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (processed_PrepareVote_in_view_about_block
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)
     (get_view msg0) (get_block msg0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk20e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk20e"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk20f"><span class="nb">apply</span> filter_In.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1
  (counting_messages
     (process
        (record_plural (fst (tr i) n0)
           (make_PrepareQC (fst (tr i) n0) msg0
            :: pending_PrepareVote 
                 (fst (tr i) n0) msg0)) msg0)) /\
message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk210" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk210"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk211" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk211"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(msg0 = msg1 \/
 In msg1 (counting_messages (fst (tr i) n0))) /\
message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk212" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk212"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk213"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">msg0 = msg1 \/
In msg1 (counting_messages (fst (tr i) n0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk214" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk214"><hr></label><div class="goal-conclusion">message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk215" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk215"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk216"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg1 (counting_messages (fst (tr i) n0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk217" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk217"><hr></label><div class="goal-conclusion">message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk218" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk218"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk219"><span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_extract</var><span class="hyp-type"><b>: </b><span>quorum
  (processed_PrepareVote_in_view_about_block
     (process (fst (tr i) n0) msg0)
     (get_view msg0) (get_block msg0))</span></span></span><br><span><var>msg1</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in'</var><span class="hyp-type"><b>: </b><span>In msg1 (counting_messages (fst (tr i) n0))</span></span></span><br><span><var>H_rest'</var><span class="hyp-type"><b>: </b><span>message_type_eqb (get_message_type msg1)
  PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">message_type_eqb (get_message_type msg1) PrepareVote &amp;&amp;
block_eqb (get_block msg1) (get_block msg0) &amp;&amp;
(get_view msg1 =? get_view msg0) = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk21a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk21a"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk21b"><span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr (S i)) n0)
  (get_view msg0) (get_block msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk21c"><span class="nb">apply</span> vote_quorum_local_means_vote_quorum_global <span class="kr">in</span> H_if; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (get_view msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk21d"><span class="nb">rewrite</span> &lt;- H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (get_view msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i)
  (get_block (make_PrepareQC (fst (tr i) n0) msg0))
  (get_view (make_PrepareQC (fst (tr i) n0) msg0))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk21e"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (get_view msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (node_view (fst (tr i) n0))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk21f"><span class="nb">assert</span> (H_view_eq : view_valid (fst (tr i) n0) msg0) <span class="bp">by</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (get_view msg0)</span></span></span><br><span><var>H_view_eq</var><span class="hyp-type"><b>: </b><span>view_valid (fst (tr i) n0) msg0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (node_view (fst (tr i) n0))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk220"><span class="nb">unfold</span> view_valid <span class="kr">in</span> H_view_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (get_view msg0)</span></span></span><br><span><var>H_view_eq</var><span class="hyp-type"><b>: </b><span>node_view (fst (tr i) n0) = get_view msg0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (node_view (fst (tr i) n0))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk221"><span class="nb">rewrite</span> H_view_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>make_PrepareQC (fst (tr i) n0) msg0 = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
process
  (record_plural (fst (tr i) n0)
     (make_PrepareQC (fst (tr i) n0) msg0
      :: pending_PrepareVote
           (fst (tr i) n0) msg0)) msg0</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
make_PrepareQC (fst (tr i) n0) msg0
:: pending_PrepareVote (fst (tr i) n0) msg0</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>honest_node (node_id (fst (tr i) n0)) /\
received (fst (tr i) n0) msg0 /\
get_message_type msg0 = PrepareVote /\
view_valid (fst (tr i) n0) msg0 /\
<span class="kp">timeout</span> (fst (tr i) n0) = false /\
~
exists_same_height_block 
  (fst (tr i) n0) (get_block msg0) /\
vote_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (get_view msg0) (get_block msg0)</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_PrepareVote_vote_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_if</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (get_view msg0)</span></span></span><br><span><var>H_view_eq</var><span class="hyp-type"><b>: </b><span>node_view (fst (tr i) n0) = get_view msg0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg0) 
  (get_view msg0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">         </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk222">** <span class="c">(* In the ViewChange case *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           <span class="c">(* We want to show that the block contained in the highest ViewChange message</span>
<span class="c">              has reached vote_quorum globally *)</span>
</span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk223">spec IH_prot {|
            get_message_type := PrepareQC;
            get_view := get_view msg0;
            get_sender := get_sender msg0;
            get_block := get_block (highest_ViewChange_message (process (fst (tr i) n0) msg0));
            get_piggyback_block := GenesisBlock |}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} (snd (tr i)) -&gt;
get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk224" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk224">spec IH_prot.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} (snd (tr i)) -&gt;
get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} (snd (tr i))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk225" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk225"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk226"><span class="nb">apply</span> delivered_means_sent_global <span class="kr">with</span> n0; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} (snd (tr i)) -&gt;
get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} (in_messages (fst (tr i) n0))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk227" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk227"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk228"><span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk229">spec IH_prot.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">get_message_type
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} = PrepareQC</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk22a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk22a"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk22b"><span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk22c"><span class="nb">apply</span> vote_quorum_in_view_global_step; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := get_view msg0;
       get_sender := get_sender msg0;
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i 
  (get_block msg) (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk22d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk22d"><span class="nb">simpl</span> <span class="kr">in</span> IH_prot.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (get_view msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i 
  (get_block msg) (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk22e"><span class="nb">rewrite</span> &lt;- H_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (get_view msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i
  (get_block
     {|
       get_message_type := PrepareQC;
       get_view := node_view (fst (tr i) n0);
       get_sender := node_id (fst (tr i) n0);
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})
  (get_view
     {|
       get_message_type := PrepareQC;
       get_view := node_view (fst (tr i) n0);
       get_sender := node_id (fst (tr i) n0);
       get_block :=
         get_block
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0));
       get_piggyback_block := GenesisBlock
     |})</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk22f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk22f"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (get_view msg0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (node_view (fst (tr i) n0))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk230"><span class="nb">assert</span> (H_view_eq : view_valid (fst (tr i) n0) msg0) <span class="bp">by</span> <span class="bp">tauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (get_view msg0)</span></span></span><br><span><var>H_view_eq</var><span class="hyp-type"><b>: </b><span>view_valid (fst (tr i) n0) msg0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (node_view (fst (tr i) n0))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">           </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk231"><span class="nb">rewrite</span> H_view_eq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>lm0</var><span class="hyp-type"><b>: </b><span>list message</span></span></span><br><span><var>msg0</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|} = msg</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_in0</var><span class="hyp-type"><b>: </b><span>In n0 participants</span></span></span><br><span><var>H_update</var><span class="hyp-type"><b>: </b><span>fst (tr (S i)) n0 =
record_plural
  (increment_view
     (process
        (process (fst (tr i) n0) msg0)
        {|
          get_message_type := PrepareQC;
          get_view := get_view msg0;
          get_sender := get_sender msg0;
          get_block :=
            get_block
              (highest_ViewChange_message
                 (process 
                    (fst (tr i) n0) msg0));
          get_piggyback_block :=
            GenesisBlock
        |}))
  ({|
     get_message_type := PrepareQC;
     get_view := node_view (fst (tr i) n0);
     get_sender := node_id (fst (tr i) n0);
     get_block :=
       get_block
         (highest_ViewChange_message
            (process (fst (tr i) n0) msg0));
     get_piggyback_block := GenesisBlock
   |}
   :: make_ViewChangeQC 
        (fst (tr i) n0)
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))
      :: make_PrepareBlocks
           (increment_view (fst (tr i) n0))
           (highest_ViewChange_message
              (process (fst (tr i) n0) msg0)))</span></span></span><br><span><var>H_out</var><span class="hyp-type"><b>: </b><span>lm0 =
{|
  get_message_type := PrepareQC;
  get_view := node_view (fst (tr i) n0);
  get_sender := node_id (fst (tr i) n0);
  get_block :=
    get_block
      (highest_ViewChange_message
         (process (fst (tr i) n0) msg0));
  get_piggyback_block := GenesisBlock
|}
:: make_ViewChangeQC (fst (tr i) n0)
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0))
   :: make_PrepareBlocks
        (increment_view (fst (tr i) n0))
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0))</span></span></span><br><span><var>H_rest</var><span class="hyp-type"><b>: </b><span>received (fst (tr i) n0) msg0 /\
received (fst (tr i) n0)
  {|
    get_message_type := PrepareQC;
    get_view := get_view msg0;
    get_sender := get_sender msg0;
    get_block :=
      get_block
        (highest_ViewChange_message
           (process (fst (tr i) n0) msg0));
    get_piggyback_block := GenesisBlock
  |} /\
honest_node (node_id (fst (tr i) n0)) /\
get_message_type msg0 = ViewChange /\
view_valid (fst (tr i) n0) msg0 /\
view_change_quorum_in_view
  (process (fst (tr i) n0) msg0)
  (node_view (fst (tr i) n0)) /\
is_block_proposer (node_id (fst (tr i) n0))
  (S (node_view (fst (tr i) n0)))</span></span></span><br><span><var>H_deliver</var><span class="hyp-type"><b>: </b><span>tr (S i) =
broadcast_messages (tr i) 
  (fst (tr i) n0) (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>H_in_copy</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_step_copy</var><span class="hyp-type"><b>: </b><span>get_transition
  process_ViewChange_quorum_new_proposer_type
  (fst (tr i) n0) msg0
  (fst (tr (S i)) n0) lm0</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (get_view msg0)</span></span></span><br><span><var>H_view_eq</var><span class="hyp-type"><b>: </b><span>view_valid (fst (tr i) n0) msg0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i
  (get_block
     (highest_ViewChange_message
        (process (fst (tr i) n0) msg0)))
  (get_view msg0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk232">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH_prot</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">msg</span> : message,
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr (S i)))</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_new</var><span class="hyp-type"><b>: </b><span>~ In msg (snd (tr i))</span></span></span><br><span><var>H_prot_copy</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>H_timeout</var><span class="hyp-type"><b>: </b><span>tr (S i) =
(<span class="kr">fun</span> <span class="nv">n</span> : node =&gt;
 <span class="kr">if</span> is_member n participants
 <span class="kr">then</span> flip_timeout (fst (tr i) n)
 <span class="kr">else</span> fst (tr i) n, snd (tr i))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr 
  (S i) (get_block msg) 
  (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> H_timeout <span class="kr">in</span> H_in; <span class="nb">simpl</span> <span class="kr">in</span> H_in; <span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
And the second case, with some help from the two lemmas above: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk233" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk233"><span class="kn">Lemma</span> <span class="nf">PrepareQC_local_means_vote_quorum_global</span> :
  <span class="kr">forall</span> <span class="nv">tr</span>, protocol_trace tr -&gt;
    <span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">n</span> : node) (<span class="nv">b1</span> : block) (<span class="nv">p</span> : nat),
      In n participants -&gt;
      PrepareQC_in_view (fst (tr i) n) p b1 -&gt; 
      vote_quorum_in_view_global tr i b1 p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">n</span> : node) (<span class="nv">b1</span> : block) (<span class="nv">p</span> : nat),
In n participants -&gt;
PrepareQC_in_view (fst (tr i) n) p b1 -&gt;
vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk234"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">n</span> : node) (<span class="nv">b1</span> : block) (<span class="nv">p</span> : nat),
In n participants -&gt;
PrepareQC_in_view (fst (tr i) n) p b1 -&gt;
vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk235"><span class="nb">intros</span> tr H_prot i n b1 p H_part H_local.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) n) p b1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk236"><span class="nb">assert</span> (H_useful := witnessed_quorum_global).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_local</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk237"><span class="nb">destruct</span> H_local <span class="kr">as</span> [msg [H_processed [H_view [H_block H_type]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">tr</span> : GTrace,
protocol_trace tr -&gt;
<span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">msg</span> : message),
In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk238" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk238">spec H_useful tr H_prot i msg.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk239" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk239">spec H_useful.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span>In msg (snd (tr i)) -&gt;
get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">In msg (snd (tr i))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk23a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk23a"><hr></label><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk23b"><span class="nb">apply</span> processed_means_sent_global <span class="kr">with</span> n; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC -&gt;
vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk23c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk23c">spec H_useful H_type.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i b1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk23d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk23d"><span class="nb">rewrite</span> &lt;- H_block.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i (get_block msg) p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk23e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk23e"><span class="nb">rewrite</span> &lt;- H_view.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>msg</var><span class="hyp-type"><b>: </b><span>message</span></span></span><br><span><var>H_processed</var><span class="hyp-type"><b>: </b><span>In msg
  (counting_messages (fst (tr i) n))</span></span></span><br><span><var>H_view</var><span class="hyp-type"><b>: </b><span>get_view msg = p</span></span></span><br><span><var>H_block</var><span class="hyp-type"><b>: </b><span>get_block msg = b1</span></span></span><br><span><var>H_type</var><span class="hyp-type"><b>: </b><span>get_message_type msg = PrepareQC</span></span></span><br><span><var>H_useful</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i
  (get_block msg) (get_view msg)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">vote_quorum_in_view_global tr i 
  (get_block msg) (get_view msg)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre><div class="doc">
<a id="lab4"></a><h2 class="section">Proof of prepare stage height injectivity</h2>
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --></pre><div class="doc">
Finally, we are ready to string everything together to prove the statement
of the first safety theorem: 
</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk23f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk23f"><span class="kn">Theorem</span> <span class="nf">prepare_stage_same_view_height_injective</span> :
  prepare_stage_same_view_height_injective_statement.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage_same_view_height_injective_statement</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk240" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk240"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">prepare_stage_same_view_height_injective_statement</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk241" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk241"><span class="nb">intros</span> tr H_prot i n m b1 b2 p H_part1 H_part2 H_neq H_prepare1 H_prepare2 H_height.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk242" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk242"><span class="nb">unfold</span> prepare_stage <span class="kr">in</span> H_prepare1, H_prepare2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_prepare1</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_prepare2</var><span class="hyp-type"><b>: </b><span>prepare_stage_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk243" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk243"><span class="nb">destruct</span> H_prepare1 <span class="kr">as</span> [H_vote1 | H_QC1];
    <span class="nb">destruct</span> H_prepare2 <span class="kr">as</span> [H_vote2 | H_QC2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="prepare-v-chk244" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk244"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk245" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk245"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="prepare-v-chk246" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><label class="goal-separator" for="prepare-v-chk246"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk247" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk247">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk248" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk248"><span class="nb">apply</span> vote_quorum_local_means_vote_quorum_global <span class="kr">in</span> H_vote1; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk249" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk249"><span class="nb">apply</span> vote_quorum_local_means_vote_quorum_global <span class="kr">in</span> H_vote2; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b2 p</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> vote_quorum_same_view_global_injective <span class="kr">with</span> tr i b1 b2 p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk24a" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk24a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk24b" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk24b"><span class="nb">apply</span> vote_quorum_local_means_vote_quorum_global <span class="kr">in</span> H_vote1; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk24c" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk24c"><span class="nb">apply</span> PrepareQC_local_means_vote_quorum_global <span class="kr">in</span> H_QC2; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_vote1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b2 p</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> vote_quorum_same_view_global_injective <span class="kr">with</span> tr i b1 b2 p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk24d" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk24d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk24e" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk24e"><span class="nb">apply</span> vote_quorum_local_means_vote_quorum_global <span class="kr">in</span> H_vote2; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b2 p</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk24f" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk24f"><span class="nb">apply</span> PrepareQC_local_means_vote_quorum_global <span class="kr">in</span> H_QC1; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_vote2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b2 p</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> vote_quorum_same_view_global_injective <span class="kr">with</span> tr i b1 b2 p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk250" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk250">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) n) p b1</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk251" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk251"><span class="nb">apply</span> PrepareQC_local_means_vote_quorum_global <span class="kr">in</span> H_QC1; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>PrepareQC_in_view (fst (tr i) m) p b2</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="prepare-v-chk252" style="display: none" type="checkbox"><label class="alectryon-input" for="prepare-v-chk252"><span class="nb">apply</span> PrepareQC_local_means_vote_quorum_global <span class="kr">in</span> H_QC2; <span class="kp">try</span> <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>tr</var><span class="hyp-type"><b>: </b><span>GTrace</span></span></span><br><span><var>H_prot</var><span class="hyp-type"><b>: </b><span>protocol_trace tr</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>node</span></span></span><br><span><var>b1, b2</var><span class="hyp-type"><b>: </b><span>block</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_part1</var><span class="hyp-type"><b>: </b><span>In n participants</span></span></span><br><span><var>H_part2</var><span class="hyp-type"><b>: </b><span>In m participants</span></span></span><br><span><var>H_neq</var><span class="hyp-type"><b>: </b><span>b1 &lt;&gt; b2</span></span></span><br><span><var>H_QC1</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b1 p</span></span></span><br><span><var>H_QC2</var><span class="hyp-type"><b>: </b><span>vote_quorum_in_view_global tr i b2 p</span></span></span><br><span><var>H_height</var><span class="hyp-type"><b>: </b><span>b_height b1 = b_height b2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">apply</span> vote_quorum_same_view_global_injective <span class="kr">with</span> tr i b1 b2 p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre></article></body></html>